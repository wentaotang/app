+function(t){"use strict";function e(){this.datas=new Array}var a={JSPATH:"BJUI/",PLUGINPATH:"BJUI/plugins/",IS_DEBUG:!1,KeyPressed:{ctrl:!1,shift:!1},keyCode:{ENTER:13,ESC:27,END:35,HOME:36,SHIFT:16,CTRL:17,TAB:9,LEFT:37,RIGHT:39,UP:38,DOWN:40,DELETE:46,BACKSPACE:8},eventType:{initUI:"bjui.initUI",beforeInitUI:"bjui.beforeInitUI",afterInitUI:"bjui.afterInitUI",ajaxStatus:"bjui.ajaxStatus",resizeGrid:"bjui.resizeGrid",beforeAjaxLoad:"bjui.beforeAjaxLoad",beforeLoadNavtab:"bjui.beforeLoadNavtab",beforeLoadDialog:"bjui.beforeLoadDialog",afterLoadNavtab:"bjui.afterLoadNavtab",afterLoadDialog:"bjui.afterLoadDialog",beforeCloseNavtab:"bjui.beforeCloseNavtab",beforeCloseDialog:"bjui.beforeCloseDialog",afterCloseNavtab:"bjui.afterCloseNavtab",afterCloseDialog:"bjui.afterCloseDialog"},formColWidth:{L:900,M:680,S:360,SS:240},pageInfo:{pageCurrent:"pageCurrent",pageSize:"pageSize",orderField:"orderField",orderDirection:"orderDirection"},alertMsg:{displayPosition:"topcenter",alertTimeout:6e3},ajaxTimeout:3e4,statusCode:{ok:200,error:300,timeout:301},keys:{statusCode:"statusCode",message:"message"},ui:{windowWidth:0,showSideWidth:990,sidenavWidth:260,offsetWidth:15,displayFirst:!0,showSlidebar:!0,clientPaging:!0,overwriteHomeTab:!1},debug:function(t){this.IS_DEBUG&&("undefined"!=typeof console?console.log(t):alert(t))},loginInfo:{url:"login.html",title:"Login",width:420,height:260,mask:!0},loadLogin:function(){var t=this.loginInfo;a.dialog({id:"bjui-login",url:t.url,title:t.title,width:t.width,height:t.height,mask:t.mask})},init:function(e){var i=t.extend({},e);t.extend(a.keys,i.keys),t.extend(a.statusCode,i.statusCode),t.extend(a.pageInfo,i.pageInfo),t.extend(a.formColWidth,i.formColWidth),t.extend(a.alertMsg,i.alertMsg),t.extend(a.loginInfo,i.loginInfo),t.extend(a.ui,i.ui),i.JSPATH&&(this.JSPATH=i.JSPATH),i.PLUGINPATH&&(this.PLUGINPATH=i.PLUGINPATH),i.ajaxTimeout&&(this.ajaxTimeout=i.ajaxTimeout),this.IS_DEBUG=i.debug||!1,this.initEnv(),t.cookie&&t.cookie("bjui_theme")||!i.theme||t(this).theme("setTheme",i.theme)},initEnv:function(){t(window).resize(function(){a.initLayout(),setTimeout(function(){t(this).trigger(a.eventType.resizeGrid)},30)}),setTimeout(function(){t(document).initui();var e=t("#bjui-navbar-collapse"),i=e.prev().width();e.css("left",i).data("position.left",i),a.initLayout(),t("#bjui-top-collapse").on("click.theme",".dropdown-toggle",function(){var e=t(this).next(),a=t("#bjui-top-collapse");a.hasClass("navbar-show")||a.attr("style",e.is(":visible")?"":"overflow:visible !important;")}),t('[data-toggle="collapsenavbar"]').click(function(){var e=t(this),a=t(e.data("target")),i=e.closest(".navbar-header");a.length&&(a.toggleClass("navbar-show"),i.toggleClass("navbar-show"),t(document).on("click",function(t){a.has(t.target).length||i.has(t.target).length||(a.removeClass("navbar-show"),i.removeClass("navbar-show"))}))})},10)},initLayout:function(){var e=t(window).width(),i=t(window).height(),n=t("#bjui-top"),o=t("#bjui-navbar"),s=t("#bjui-top-collapse, #bjui-navbar-collapse"),r=n.height(),l=parseInt(o.css("min-height"),10),d="click.bjui.sidenav.hide",c={},u=t("#bjui-navtab"),p=t("#bjui-sidenav"),h=t("#bjui-sidenav-col"),g=t("#bjui-sidenav-arrow"),f=t("#bjui-sidenav-btn"),m=(t("#bjui-sidenav-box"),f.outerHeight()-2);t("#bjui-navtab .tabsPageContent").height(i-r-l-m),p.height(i-r-l-1),h.width(a.ui.sidenavWidth),s.scrollTop(5).eq(0).removeAttr("style"),s.each(function(){var a=t(this),i=a.prev().find(".navbar-toggle"),n=5==a.scrollTop()||a.hasClass("navbar-show");n&&a.scrollTop(0),a.toggleClass("position",n),i.toggleClass("position",n),a.data("position.left")&&e/2<a.data("position.left")?(a.prev().find("> .navbar-brand").hide(),a.css("left",0)):(a.prev().find("> .navbar-brand").show(),a.css("left",a.data("position.left")))}),e<a.ui.showSideWidth?(h.css("left",-(a.ui.sidenavWidth+a.ui.offsetWidth)).addClass("autohide"),u.css("margin-left",0),f.show()):(h.css("left",0).removeClass("autohide"),u.css("margin-left",a.ui.sidenavWidth+a.ui.offsetWidth),f.hide()),g.off(d).on(d,function(){h.stop().animate({left:-(a.ui.sidenavWidth+a.ui.offsetWidth)},"fast",function(){f.show(),t(window).trigger(a.eventType.resizeGrid)}),u.stop().animate({"margin-left":0},"fast")}),f.off(d).on(d,function(){f.hide(),h.stop().animate({left:0},"fast",function(){t(window).trigger(a.eventType.resizeGrid)}),c["margin-left"]=a.ui.sidenavWidth+a.ui.offsetWidth,e<a.ui.showSideWidth&&(c["margin-left"]=0),u.stop().animate(c,"fast")})},regional:{},setRegional:function(t,e){a.regional[t]=e},getRegional:function(t){if(String(t).indexOf(".")>=0){for(var e,i=String(t).split("."),n=0;n<i.length;n++)e=e?e[i[n]]:a.regional[i[n]];return e}return a.regional[t]},doRegional:function(e,a){return t.each(a,function(t,a){e=e.replaceAll("#"+t+"#",a)}),e},isIE:function(t){var e=document.createElement("b");return e.innerHTML="<!--[if IE "+t+"]><i></i><![endif]-->",1===e.getElementsByTagName("i").length},StrBuilder:function(){return new e}};e.prototype.add=function(t){return"undefined"!=typeof t&&this.datas.push(t),this},e.prototype.toString=function(t){var e=this.datas.join(t||"");return this.clear(),e},e.prototype.isEmpty=function(){return 0==this.datas.length},e.prototype.clear=function(){this.datas=[],this.datas.length=0},window.BJUI=a}(jQuery),+function(t){"use strict";t(function(){BJUI.setRegional("alertmsg",{title:{error:"错误提示",info:"信息提示",warn:"警告信息",correct:"成功信息",confirm:"确认信息",prompt:"确认信息"},btnMsg:{ok:"确定",yes:"是",no:"否",cancel:"取消"}}),BJUI.setRegional("dialog",{close:"关闭",maximize:"最大化",restore:"还原",minimize:"最小化",title:"弹出窗口"}),BJUI.setRegional("orderby",{asc:"升序",desc:"降序"}),BJUI.setRegional("pagination",{total:"总记录数/总页数",first:"首页",last:"末页",prev:"上一页",next:"下一页",jumpto:"输入跳转页码，回车确认",jump:"跳转",page:"页",refresh:"刷新"}),BJUI.setRegional("datagrid",{asc:"升序",desc:"降序",showhide:"显示/隐藏 列",filter:"过滤",clear:"清除",lock:"锁定列",unlock:"解除锁定",add:"添加",edit:"编辑",save:"保存",update:"更新",cancel:"取消",del:"删除",prev:"上一条",next:"下一条",refresh:"刷新",query:"查询","import":"导入","export":"导出",exportf:"导出筛选",all:"全部","true":"是","false":"否",noData:"没有数据！",fAndS:"过滤和排序！",expandMsg:"点我展开行！",shrinkMsg:"点我收缩行！",selectMsg:"未选中任何行！",editMsg:"请先保存编辑行！",saveMsg:"没有需要保存的行！",delMsg:"确定要删除该行吗？",delMsgM:"确定要删除选中行？",errorData:"未获取到正确的数据！",failData:"请求datagrid数据失败！"}),BJUI.setRegional("findgrid",{choose:"选择选中项",append:"追加选择",empty:"清空现有值"}),BJUI.setRegional("progressmsg","正在努力加载数据，请稍等..."),BJUI.setRegional("datepicker",{close:"关闭",prev:"上月",next:"下月",clear:"清空",ok:"确定",dayNames:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]}),BJUI.setRegional("navtabCM",{refresh:"刷新本标签",close:"关闭本标签",closeother:"关闭其他标签",closeall:"关闭所有标签"}),BJUI.setRegional("dialogCM",{refresh:"刷新本窗口",close:"关闭本窗口",closeother:"关闭其他窗口",closeall:"关闭所有窗口"}),BJUI.setRegional("statusCode_503","服务器当前负载过大或者正在维护！"),BJUI.setRegional("ajaxnosend","与服务器的通信中断，请检查URL链接或服务器状态！"),BJUI.setRegional("sessiontimeout","会话超时，请重新登陆！"),BJUI.setRegional("plhmsg","占位符对应的选择器无有效值！"),BJUI.setRegional("nocheckgroup",'未定义选中项的组名[复选框的"data-group"]！'),BJUI.setRegional("notchecked","未选中任何一项！"),BJUI.setRegional("selectmsg","请选择一个选项！"),BJUI.setRegional("validatemsg","提交的表单中 [{0}] 个字段有错误，请更正后再提交！"),BJUI.setRegional("idChecked","不规范，ID需以字母开头，组成部分包括（0-9，字母，中横线，下划线）"),BJUI.setRegional("uititle","B-JUI"),BJUI.setRegional("maintab","我的主页"),t.validator&&t.validator.config({rules:{digits:[/^\d+$/,"请输入整数"],number:[/^[\-\+]?((([0-9]{1,3})([,][0-9]{3})*)|([0-9]+))?([\.]([0-9]+))?$/,"请输入有效的数字"],letters:[/^[a-z]+$/i,"{0}只能输入字母"],upletterandnumber:[/^[A-Z0-9]+$/,"只能输入大写字母和数字"],tel:[/^(?:(?:0\d{2,3}[\- ]?[1-9]\d{6,7})|(?:[48]00[\- ]?[1-9]\d{6}))$/,"请填写有效的电话号码"],mobile:[/^1[3-9]\d{9}$/,"手机号格式不正确"],email:[/^[\w\+\-]+(\.[\w\+\-]+)*@[a-z\d\-]+(\.[a-z\d\-]+)*\.([a-z]{2,4})$/i,"请填写有效的邮箱"],qq:[/^[1-9]\d{4,}$/,"QQ号格式不正确"],date:[/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/,"请输入正确的日期，例：yyyy-MM-dd"],time:[/^(2[0123]|(1|0?)[0-9]){1}:([0-5][0-9]){1}:([0-5][0-9]){1}$/,"请输入正确的时间，例：HH:mm:ss"],datetime:[/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])\s+(2[0123]|(1|0?)[0-9]){1}:([0-5][0-9]){1}:([0-5][0-9]){1}$/,"请输入正确的日期时间，例：yyyy-MM-dd HH:mm:ss"],IDcard:[/^\d{6}(19|2\d)?\d{2}(0[1-9]|1[012])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)?$/,"请填写正确的身份证号码"],url:[/^(https?|s?ftp):\/\/\S+$/i,"请填写有效的网址"],zipcode:[/^\d{6}$/,"请检查邮政编码格式"],chinese:[/^[\u0391-\uFFE5]+$/,"请输入中文"],username:[/^\w{3,12}$/,"请输入3-12位数字、字母、下划线"],password:[/^[\S]{6,16}$/,"请填写6-16位字符，不能包含空格"],pattern:function(t,e){if(!e)return!0;var a=t.value.parseDate(e);return a?!0:this.renderMsg("错误的日期时间格式！",e)},accept:function(e,a){if(!a)return!0;var i=a[0],n=t(e).val();return"*"===i||new RegExp(".(?:"+i+")$","i").test(n)||this.renderMsg("只接受{1}后缀的文件",i.replace(/\|/g,","))}},messages:{0:"此处",fallback:"{0}格式不正确",loading:"正在验证...",error:"网络异常",timeout:"请求超时",required:"{0}不能为空",remote:"{0}已被使用",integer:{"*":"请填写整数","+":"请填写正整数","+0":"请填写正整数或0","-":"请填写负整数","-0":"请填写负整数或0"},match:{eq:"{0}与{1}不一致",neq:"{0}与{1}不能相同",lt:"{0}必须小于{1}",gt:"{0}必须大于{1}",lte:"{0}不能大于{1}",gte:"{0}不能小于{1}"},range:{rg:"请填写{1}到{2}的数",gte:"请填写不小于{1}的数",lte:"请填写最大{1}的数",gtlt:"请填写{1}到{2}之间的数",gt:"请填写大于{1}的数",lt:"请填写小于{1}的数"},checked:{eq:"请选择{1}项",rg:"请选择{1}到{2}项",gte:"请至少选择{1}项",lte:"请最多选择{1}项"},length:{eq:"请填写{1}个字符",rg:"请填写{1}到{2}个字符",gte:"请至少填写{1}个字符",lte:"请最多填写{1}个字符",eq_2:"",rg_2:"",gte_2:"",lte_2:""}}})})}(jQuery),+function(t){"use strict";BJUI.setRegional("alertmsg",{title:{error:"Error",info:"Info",warn:"Warning",correct:"Correct",confirm:"Confirm",prompt:"Prompt"},btnMsg:{ok:"OK",yes:"YES",no:"NO",cancel:"Cancel"}}),BJUI.setRegional("dialog",{close:"Close",maximize:"Maximize",restore:"Restore",minimize:"Minimize",title:"Popup window"}),BJUI.setRegional("orderby",{asc:"Asc",desc:"Desc"}),BJUI.setRegional("pagination",{first:"First page",last:"Last page",prev:"Prev page",next:"Next page",jumpto:"Jump page number",jump:"Jump"}),BJUI.setRegional("datagrid",{asc:"ASC",desc:"DESC",showhide:"Show/Hide columns",filter:"Filter",clear:"Clear",lock:"Lock",unlock:"Unlock",add:"Add",edit:"Edit",save:"Save",update:"Update",cancel:"Cancel",del:"Delete",prev:"Prev",next:"Next",refresh:"Refresh",query:"Query","import":"Import","export":"Export",exportf:"Export filter",all:"All","true":"True","false":"False",noData:"No data!",fAndS:"Filter && Sort!",expandMsg:"Click here to expand the tr!",shrinkMsg:"Click here to shrink the tr!",selectMsg:"Not selected any rows!",saveMsg:"No rows need to save!",editMsg:"Please save the edited row!",delMsg:"Sure you want to delete this row?",delMsgM:"Sure you want to delete selected rows?",errorData:"Did not get the correct data!",failData:"Request data failed!"}),BJUI.setRegional("findgrid",{choose:"Choose the selected item",append:"Append choose the selected item",empty:"Empty existing values"}),BJUI.setRegional("progressmsg","Data loading, please waiting..."),BJUI.setRegional("datepicker",{close:"Close",prev:"Prev month",next:"Next month",clear:"Clear",ok:"OK",dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),BJUI.setRegional("navtabCM",{refresh:"Refresh navtab",close:"Close navtab",closeother:"Close other navtab",closeall:"Close all navtab"}),BJUI.setRegional("dialogCM",{refresh:"Refresh dialog",close:"Close dialog",closeother:"Close other dialog",closeall:"Close all dialog"}),BJUI.setRegional("statusCode_503","HTTP status 503, the current server load is too large or is down for maintenance!"),BJUI.setRegional("ajaxnosend","Communication with the server is interrupted, please check the URL link or server status!"),BJUI.setRegional("sessiontimout","Session timeout, please login!"),BJUI.setRegional("plhmsg","Placeholder corresponding selector None Valid!"),BJUI.setRegional("nocheckgroup",'Undefined group name selected item [check box "data-group"]!'),BJUI.setRegional("notchecked","Unchecked any one!"),BJUI.setRegional("selectmsg","Please select one option!"),BJUI.setRegional("validatemsg","Submitted form data has [{0}] field an error, please after modified submitting!"),BJUI.setRegional("idChecked","is not standardized, ID need to start with a letter, components include (0-9, letters, hyphens, underscore)"),BJUI.setRegional("uititle","B-JUI"),BJUI.setRegional("maintab","My home"),window.FRAG={dialog:'<div class="bjui-dialog bjui-dialog-container" style="top:150px; left:300px;">    <div class="dialogHeader" onselectstart="return false;" oncopy="return false;" onpaste="return false;" oncut="return false;">        <a class="close" href="javascript:;" title="#close#"><i class="fa fa-times"></i></a>        <a class="maximize" href="javascript:;" title="#maximize#"><i class="fa fa-square-o"></i></a>        <a class="restore" href="javascript:;" title="#restore#"><i class="fa fa-clone fa-rotate-90"></i></a>        <a class="minimize" href="javascript:;" title="#minimize#"><i class="fa fa-minus"></i></a>        <h1><span><i class="fa fa-th-large"></i></span> <span class="title">#title#</span></h1>    </div>    <div class="dialogContent unitBox"></div>    <div class="resizable_h_l" tar="nw"></div>    <div class="resizable_h_r" tar="ne"></div>    <div class="resizable_h_c" tar="n"></div>    <div class="resizable_c_l" tar="w" style="height:100%;"></div>    <div class="resizable_c_r" tar="e" style="height:100%;"></div>    <div class="resizable_f_l" tar="sw"></div>    <div class="resizable_f_r" tar="se"></div>    <div class="resizable_f_c" tar="s"></div></div>',taskbar:'<div id="bjui-taskbar" style="left:0px; display:none;">    <div class="taskbarContent">        <ul></ul>    </div>    <div class="taskbarLeft taskbarLeftDisabled"><i class="fa fa-angle-double-left"></i></div>    <div class="taskbarRight"><i class="fa fa-angle-double-right"></i></div></div>',splitBar:'<div id="bjui-splitBar"></div>',splitBarProxy:'<div id="bjui-splitBarProxy"></div>',resizable:'<div id="bjui-resizable" class="bjui-resizable"></div>',alertBackground:'<div class="bjui-alertBackground"></div>',maskBackground:'<div class="bjui-maskBackground bjui-ajax-mask"></div>',maskProgress:'<div class="bjui-maskProgress bjui-ajax-mask"><i class="fa fa-cog fa-spin"></i>&nbsp;&nbsp;#progressmsg#<div class="progressBg"><div class="progress"></div></div></div>',progressBar_custom:'<div id="bjui-progressBar-custom" class="progressBar"><i class="fa fa-cog fa-spin"></i> <span></span></div>',dialogMask:'<div class="bjui-dialogBackground"></div>',orderby:'<a href="javascript:;" class="order asc" data-order-direction="asc" title="#asc#"><i class="fa fa-angle-up"></i></a><a href="javascript:;" class="order desc" data-order-direction="desc" title="#desc#"><i class="fa fa-angle-down"></i></a>',slidePanel:'<div class="panel panel-default">    <div class="panel-heading">        <h4 class="panel-title"><a data-toggle="collapse" data-parent="#bjui-accordionmenu" href="##id#" class="#class#">#icon#&nbsp;#title#<b>#righticon#</b></a></h4>    </div>    <div id="#id#" class="panel-collapse collapse#bodyclass#">        <div class="panel-body">        </div>    </div></div>',gridPaging:'<ul class="pagination">    <li class="page-total">        <span title="#total#">#count#</span>    </li>    <li class="page-jumpto"><span class="page-input"><input class="form-control input-sm-pages" type="text" size="3.2" value="#pageCurrent#" title="#jumpto#"></span></li>    <li class="page-first btn-nav">        <a href="javascript:;" title="#first#"><i class="fa fa-step-backward"></i></a>    </li>    <li class="page-prev btn-nav">        <a href="javascript:;" title="#prev#"><i class="fa fa-backward"></i></a>    </li>    #pageNumFrag#    <li class="page-next btn-nav">        <a href="javascript:;" title="#next#"><i class="fa fa-forward"></i></a>    </li>    <li class="page-last btn-nav">        <a href="javascript:;" title="#last#"><i class="fa fa-step-forward"></i></a>    </li></ul>',gridPageNum:'<li class="page-num#active#"><a href="javascript:;">#num#</a></li>',gridMenu:'<div class="datagrid-menu-box">    <ul>        <li class="datagrid-li-asc"><a href="javascript:;"><span class="icon"><i class="fa fa-sort-amount-asc"></i></span><span class="title">#asc#</span></a></li>        <li class="datagrid-li-desc"><a href="javascript:;"><span class="icon"><i class="fa fa-sort-amount-desc"></i></span><span class="title">#desc#</span></a></li>        <li class="datagrid-li-filter"><a href="javascript:;"><span class="icon"><i class="fa fa-filter"></i></span><span class="title">#filter#</span><span class="arrow"></span></a></li>        <li class="datagrid-li-showhide"><a href="javascript:;"><span class="icon"><i class="fa fa-check-square-o"></i></span><span class="title">#showhide#</span><span class="arrow"></span></a></li>        <li class="datagrid-li-lock"><a href="javascript:;"><span class="icon"><i class="fa fa-lock"></i></span><span class="title">#lock#</span></a></li>        <li class="datagrid-li-unlock disable"><a href="javascript:;"><span class="icon"><i class="fa fa-unlock"></i></span><span class="title">#unlock#</span></a></li>    </ul></div>',gridFilter:'<div class="datagrid-filter-box"><fieldset><legend>#label#</legend><span class="filter-a"></span><span class="filter-and"><select data-toggle="selectpicker" data-container="true" data-width="100%"><option value="and">AND</option><option value="or">OR</option></select></span><span class="filter-b"></span><span class="filter-ok"><button type="button" class="btn-green ok" data-icon="check">#filter#</button><button type="button" class="btn-orange clear" data-icon="remove">#clear#</button></span></fieldset></div>',gridShowhide:'<li data-index="#index#" class="datagrid-col-check"><a href="javascript:;"><i class="fa fa-check-square-o"></i>#label#</a></li>',gridEditBtn:'<button type="button" class="btn btn-green bjui-datagrid-btn edit"><i class="fa fa-edit"></i> #edit#</button><button type="button" class="btn btn-green bjui-datagrid-btn update"><i class="fa fa-edit"></i> #update#</button><button type="button" class="btn btn-green bjui-datagrid-btn save"><i class="fa fa-check"></i> #save#</button><button type="button" class="btn btn-orange bjui-datagrid-btn cancel"><i class="fa fa-undo"></i> #cancel#</button><button type="button" class="btn btn-red bjui-datagrid-btn delete"><i class="fa fa-remove"></i> #del#</button>',gridDialogEditBtns:'<ul>    <li class="pull-left"><button type="button" class="btn btn-orange prev" data-icon="arrow-up">#prev#</button></li>    <li class="pull-left"><button type="button" class="btn btn-orange next" data-icon="arrow-down">#next#</button></li>    <li><button type="button" class="btn btn-red cancel" data-icon="remove">#cancel#</button></li>    <li><button type="button" class="btn btn-default save" data-icon="save">#save#</button></li></ul>',gridExpandBtn:'<span title="#expandMsg#"><i class="fa fa-plus"></i></span>',gridShrinkBtn:'<span title="#shrinkMsg#"><i class="fa fa-minus"></i></span>',alertBoxFrag:'<div id="bjui-alertMsgBox" class="bjui-alert"><div class="alertContent"><div class="#type#"><div class="alertInner"><h1><i class="fa #fa#"></i>#title#</h1><div class="msg">#message##prompt#</div></div><div class="toolBar clearfix"><ul>#btnFragment#</ul></div></div></div></div>',alertBtnFrag:'<li><button class="btn btn-#class#" rel="#callback#" type="button">#btnMsg#</button></li>',calendarFrag:'<div id="bjui-calendar">    <div class="main">        <a class="close" href="javascript:;" title="#close#"><i class="fa fa-times-circle"></i></a>        <div class="head">            <table width="100%" border="0" cellpadding="0" cellspacing="2">                <tr>                    <td width="20"><a class="prev" href="javascript:;" title="#prev#"><i class="fa fa-arrow-left"></i></a></td>                    <td><select name="year"></select></td>                    <td><select name="month"></select></td>                    <td width="20"><a class="next" href="javascript:;" title="#next#"><i class="fa fa-arrow-right"></i></a></td>                </tr>            </table>        </div>        <div class="body">            <dl class="dayNames"><dt>7</dt><dt>1</dt><dt>2</dt><dt>3</dt><dt>4</dt><dt>5</dt><dt>6</dt></dl>            <dl class="days"><!-- date list --></dl>            <div style="clear:both;height:0;line-height:0"></div>        </div>        <div class="foot">            <table class="time">                <tr>                    <td>                        <input type="text" class="hh" maxlength="2" data-type="hh" data-start="0" data-end="23">:<input                         type="text" class="mm" maxlength="2" data-type="mm" data-start="0" data-end="59">:<input                         type="text" class="ss" maxlength="2" data-type="ss" data-start="0" data-end="59">                    </td>                    <td><ul><li class="up" data-add="1">&and;</li><li class="down">&or;</li></ul></td>                </tr>            </table>            <button type="button" class="clearBtn btn btn-orange">#clear#</button>            <button type="button" class="okBtn btn btn-default">#ok#</button>        </div>        <div class="tm">            <ul class="hh">                <li>0</li>                <li>1</li>                <li>2</li>                <li>3</li>                <li>4</li>                <li>5</li>                <li>6</li>                <li>7</li>                <li>8</li>                <li>9</li>                <li>10</li>                <li>11</li>                <li>12</li>                <li>13</li>                <li>14</li>                <li>15</li>                <li>16</li>                <li>17</li>                <li>18</li>                <li>19</li>                <li>20</li>                <li>21</li>                <li>22</li>                <li>23</li>            </ul>            <ul class="mm">                <li>0</li>                <li>5</li>                <li>10</li>                <li>15</li>                <li>20</li>                <li>25</li>                <li>30</li>                <li>35</li>                <li>40</li>                <li>45</li>                <li>50</li>                <li>55</li>            </ul>            <ul class="ss">                <li>0</li>                <li>10</li>                <li>20</li>                <li>30</li>                <li>40</li>                <li>50</li>            </ul>        </div>    </div></div>',spinnerBtn:'<ul class="bjui-spinner"><li class="up" data-add="1">&and;</li><li class="down">&or;</li></ul>',findgridBtn:'<a class="bjui-lookup" href="javascript:;" data-toggle="findgridbtn"><i class="fa fa-search"></i></a>',dateBtn:'<a class="bjui-lookup" href="javascript:;" data-toggle="datepickerbtn"><i class="fa fa-calendar"></i></a>',navtabCM:'<ul id="bjui-navtabCM">    <li rel="reload"><span class="icon"><i class="fa fa-refresh"></i></span><span class="title">#refresh#</span></li>    <li rel="closeCurrent"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#close#</li>    <li rel="closeOther"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeother#</li>    <li rel="closeAll"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeall#</li></ul>',dialogCM:'<ul id="bjui-dialogCM">    <li rel="reload"><span class="icon"><i class="fa fa-refresh"></i></span><span class="title">#refresh#</span></li>    <li rel="closeCurrent"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#close#</span></li>    <li rel="closeOther"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeother#</span></li>    <li rel="closeAll"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeall#</span></li></ul>',externalFrag:'<iframe src="{url}" style="width:100%;height:{height};" frameborder="no" border="0" marginwidth="0" marginheight="0"></iframe>'}}(jQuery),+function(t){"use strict";t.fn.extend({ajaxUrl:function(e){var a=t(this),i=a;i.length||(i=a),a.trigger(BJUI.eventType.beforeAjaxLoad),e.loadingmask&&i.trigger(BJUI.eventType.ajaxStatus),t.ajax({type:e.type||"GET",url:e.url,data:e.data||{},cache:!1,dataType:"html",timeout:BJUI.ajaxTimeout,success:function(n){var o=n.toJson(),s=i.find("> .bjui-ajax-mask");o[BJUI.keys.statusCode]?(o[BJUI.keys.statusCode]==BJUI.statusCode.error?(o[BJUI.keys.message]&&a.alertmsg("error",o[BJUI.keys.message]),a.closest(".bjui-layout").length||(a.closest(".navtab-panel").length?a.navtab("closeCurrentTab"):a.dialog("closeCurrent"))):o[BJUI.keys.statusCode]==BJUI.statusCode.timeout&&(a.closest(".bjui-dialog").length&&a.dialog("closeCurrent"),a.closest(".navtab-panel").length&&a.navtab("closeCurrentTab"),BJUI.alertmsg("info",o[BJUI.keys.message]||BJUI.regional.sessiontimeout),BJUI.loadLogin()),s.fadeOut("normal",function(){t(this).remove()})):a.empty().html(n).initui(),t.isFunction(e.callback)&&e.callback(n)},error:function(t,e,i){a.bjuiajax("ajaxError",t,e,i),a.closest(".bjui-layout").length||(a.closest(".navtab-panel").length?a.navtab("closeCurrentTab"):a.dialog("closeCurrent")),a.trigger("bjui.ajaxError")},statusCode:{0:function(t,e,a){BJUI.alertmsg("error",BJUI.regional.ajaxnosend)},503:function(t,e,a){BJUI.alertmsg("error",BJUI.regional.statusCode_503)}}})},loadUrl:function(e,a,i){t(this).ajaxUrl({url:e,data:a,callback:i})},doAjax:function(e){var a,i,n=t(this);return n.data("holdSubmit",!0),e.url?e.callback?(e.callback=e.callback.toFunc(),e.loadingmask&&(a=n.isTag("form")?n.closest(".bjui-pageContent"):n,a.length||(a=n),a.trigger(BJUI.eventType.ajaxStatus),i=a.find("> .bjui-ajax-mask")),e.type||(e.type="POST"),e.dataType||(e.dataType="json"),e.cache||(e.cache=!1),e.timeout=e.ajaxTimeout||BJUI.ajaxTimeout,e.success=function(o){i?e.callback?t.when(e.callback(o)).done(function(){a.trigger("bjui.ajaxStop")}):a.trigger("bjui.ajaxStop"):e.callback(o),n.data("holdSubmit",!1)},e.error=function(t,e,o){i&&a.trigger("bjui.ajaxError"),n.bjuiajax("ajaxError",t,e,o),n.data("holdSubmit",!1)},e.statusCode={0:function(t,e,a){BJUI.alertmsg("error",BJUI.regional.ajaxnosend),n.data("holdSubmit",!1)},503:function(t,e,a){BJUI.alertmsg("error",BJUI.regional.statusCode_503),n.data("holdSubmit",!1)}},void t.ajax(e)):void BJUI.debug("The ajax callback is undefined!"):void BJUI.debug("The ajax url is undefined!")},getPageTarget:function(){var e;return e=this.closest(".bjui-layout").length?this.closest(".bjui-layout"):this.closest(".navtab-panel").length?t.CurrentNavtab:t.CurrentDialog},resizePageH:function(){return this.each(function(){if(!t(this).closest(".tab-content").length){var e=t(this),a=e.find("> .bjui-pageHeader"),i=e.find("> .bjui-pageContent"),n=e.find("> .bjui-pageFooter"),o=a.outerHeight()||0,s=n.outerHeight()||0;n.css("bottom")&&(s+=parseInt(n.css("bottom"))||0),i.css({top:o,bottom:s}),e.hasClass("dialogContent")&&!i.length&&e.css({padding:10,overflow:"auto"})}})},getMaxIndexObj:function(e){var a=0,i=0;return e.each(function(e){var n=parseInt(t(this).css("zIndex"))||1;n>a&&(a=n,i=e)}),e.eq(i)},serializeJson:function(){var e={},a=this.serializeArray();return t.each(a,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},isTag:function(e){return e&&t(this).prop("tagName")&&t(this)[0].tagName.toLowerCase()==e?!0:!1},isBind:function(e){var a=t(this).data("events");return a&&e&&a[e]},log:function(t){return this.each(function(){console&&console.log("%s: %o",t,this)})}}),t.extend(String.prototype,{isPositiveInteger:function(){return new RegExp(/^[1-9]\d*$/).test(this)},isInteger:function(){return new RegExp(/^\d+$/).test(this)},isNumber:function(){return new RegExp(/^([-]{0,1}(\d+)[\.]+(\d+))|([-]{0,1}(\d+))$/).test(this)},isNormalID:function(){return new RegExp(/^[a-zA-Z][0-9a-zA-Z_-]*$/).test(this)},includeChinese:function(){return new RegExp(/[\u4E00-\u9FA5]/).test(this)},trim:function(){return t.trim(this)},startsWith:function(t){return 0===this.indexOf(t)},endsWith:function(t){var e=this.length-t.length;return e>=0&&this.lastIndexOf(t)===e},replaceSuffix:function(t){return this.replace(/\[[0-9]+\]/,"["+t+"]").replace("#index#",t)},replaceSuffix2:function(t){return this.replace(/\-(i)([0-9]+)$/,"-i"+t).replace("#index#",t)},trans:function(){return this.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},encodeTXT:function(){return this.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll(" ","&nbsp;")},replaceAll:function(t,e){return this.replace(new RegExp(t,"gm"),e)},replacePlh:function(e){return e=e||t(document),this.replace(/{\/?[^}]*}/g,function(t){var a=e.find(t.replace(/[{}]+/g,""));return a&&a.val()?a.val():t})},replaceMsg:function(t){return this.replace(new RegExp("({.*})","g"),t)},replaceTm:function(t){return t?this.replace(RegExp("({[A-Za-z_]+[A-Za-z0-9_-]*})","g"),function(e){return t[e.replace(/[{}]+/g,"")]}):this},replaceTmById:function(e){var a=e||t(document);return this.replace(RegExp("({[A-Za-z_]+[A-Za-z0-9_-]*})","g"),function(t){var e=a.find("#"+t.replace(/[{}]+/g,""));return e.val()?e.val():t})},isFinishedTm:function(){return!new RegExp("{/?[^}]*}").test(this)},skipChar:function(t){return this&&0!==this.length?this.charAt(0)===t?this.substring(1).skipChar(t):this:""},isValidPwd:function(){return new RegExp(/^([_]|[a-zA-Z0-9]){6,32}$/).test(this)},isValidMail:function(){return new RegExp(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/).test(this.trim())},isSpaces:function(){for(var t=0;t<this.length;t+=1){var e=this.charAt(t);if(" "!=e&&"\n"!=e&&"	"!=e&&"\r"!=e)return!1}return!0},isPhone:function(){return new RegExp(/(^([0-9]{3,4}[-])?\d{3,8}(-\d{1,6})?$)|(^\([0-9]{3,4}\)\d{3,8}(\(\d{1,6}\))?$)|(^\d{3,8}$)/).test(this)},isUrl:function(){return new RegExp(/^[a-zA-z]+:\/\/([a-zA-Z0-9\-\.]+)([-\w .\/?%&=:]*)$/).test(this)},isExternalUrl:function(){return this.isUrl()&&-1==this.indexOf("://"+document.domain)},toBool:function(){return"true"===this.toLowerCase()?!0:!1},toJson:function(){var t=this;try{return"object"==typeof t&&(t=t.toString()),t.trim().match("^{(.+:.+,*){1,}}$")?JSON.parse(this):this}catch(e){return this}},toObj:function(){var t=null;try{t=new Function("return "+this)()}catch(e){t=this,BJUI.debug('String toObj：Parse "String" to "Object" error! Your str is: '+this)}return t},toFunc:function(){if(this&&this.length){if(this.startsWith("function"))return new Function("return "+this)();try{for(var t=this.split("."),e=window,a=0;a<t.length;a++)e=e[t[a]];if("function"==typeof e)return e}catch(i){return}}}}),t.extend(Function.prototype,{toFunc:function(){return this}}),t.extend(Array.prototype,{remove:function(t){return 0>t?this:this.slice(0,t).concat(this.slice(t+1,this.length))},swap:function(t,e){var a=this,i=a[t];return a[t]=a[e],a[e]=i,this},move:function(t,e){if(0>t||0>e)return this;if(e>=this.length)for(var a=e-this.length;a--+1;)this.push(void 0);return this.splice(e,0,this.splice(t,1)[0]),this},moveItems:function(t,e,a){if(!a||e==t)return this;var i=this.slice(t,t+a);return t>e&&this.splice(t,a),this.splice.apply(this,[e,0].concat(i)),e>t&&this.splice(t,a),this},unique:function(){var t=new Array;this.sort();for(var e=0;e<this.length;e++)this[e]!=this[e+1]&&(t[t.length]=this[e]);return t},myIndexOf:function(t){if(!this||!this.length)return-1;for(var e,a=0;e=this[a];a++)if(e==t)return a;return-1},toJson:function(){var e={},a=this;return t.each(a,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e}}),t.isJson=function(e){var a=!0;try{a=t.parseJSON(e)}catch(i){return!1}return a?!0:!1}}(jQuery),+function(t){"use strict";function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),s=t.extend({},o.data(),"object"==typeof e&&e),r=o.data("bjui.basedrag");r||o.data("bjui.basedrag",r=new a(this,s)),"string"==typeof n&&t.isFunction(r[n])?([].shift.apply(i),i?r[n].apply(r,i):r[n]()):r.init();
})}var a=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS()};a.prototype.TOOLS=function(){var e={isOver:function(t,e,a){var i=t.offset(),n=i.left,o=i.top,s=t.outerWidth(),r=t.outerHeight();return e>n&&n+s>e&&a>o&&o+r>a},mouseDirection:function(e,a){var i=t(e),n=["top","right","bottom","left"],o=function(t){var e=i.outerWidth(),a=i.outerHeight(),n=i.offset(),o=(t.pageX-n.left-e/2)*(e>a?a/e:1),s=(t.pageY-n.top-a/2)*(a>e?e/a:1);return Math.round((Math.atan2(s,o)*(180/Math.PI)+180)/90+3)%4};a=t.extend({},{move:t.noop},a||{});var s=o(a.e);a.move(i,n[s])}};return e},a.prototype.init=function(){var t=this;t.$drag=this.$element,t.options.$obj=this.$element,t.options.obj&&(this.options.$obj=this.options.obj),t.options.event?(t.hasEvent=!0,t.start(this.options.event)):(t.options.selector&&(t.$drag=t.$element.find(t.options.selector)),t.$drag.length&&t.$drag.on("mousedown",function(e){t.start.apply(t,[e]),t.options.event=e}))},a.prototype.start=function(e){t(document).on("selectstart",!1);var a=this,i=a.options;if(i.exclude){var n=a.$element.find(i.exclude);if(n.length&&-1!=t.inArray(e.target,n.add(n.find("*"))))return!1}"static"===this.$element.css("position")&&(this.$element.css("position","absolute"),!i.oleft&&(i.oleft=this.$element.position().left),!i.otop&&(i.otop=this.$element.position().top),this.$element.css("position","")),i.oleft||(i.oleft=parseInt(this.$element.css("left"))||0),i.otop||(i.otop=parseInt(this.$element.css("top"))||0),t(document).on("mouseup.bjui.basedrag",function(t){a.stop.apply(a,[t])}).on("mousemove.bjui.basedrag",function(t){a.drag.apply(a,[t])})},a.prototype.drop=function(e){var a=this,i=a.options,n=i.drop;!n instanceof jQuery&&(n=t(n)),n.length&&(a.$drops=n,n.each(function(){return a.tools.isOver(t(this),e.pageX,e.pageY)?(t(this).trigger("dropover.bjui.basedrag",[e.pageX,e.pageY,a.$element]),a.isDrop=!0,a.$drop=t(this),!1):(t(this).trigger("dropout.bjui.basedrag",[e.pageX,e.pageY,a.$element]),void(a.isDrop=!1))}).css("-moz-user-select","none"))},a.prototype.drag=function(e){e||(e=window.event),BJUI["bjui.basedrag"]=this.$element;var a=this,i=this.options,n=i.beforeDrag,o=i.treeData,s=this.$element.index(),r=i.oleft+(e.pageX-i.event.pageX),l=i.otop+(e.pageY-i.event.pageY);if(n&&"string"==typeof n&&(n=n.toFunc()),n&&"function"==typeof n&&(this.$element.next().hasClass("datagrid-child-tr")&&(s/=2),!n.apply(this,[this.$element,o?o[s]:""])))return!1;if(i.drop&&(i.move=""),"horizontal"===i.move)i.minW&&r>=parseInt(this.options.$obj.css("left"))+i.minW&&i.maxW&&r<=parseInt(this.options.$obj.css("left"))+i.maxW?this.$element.css("left",r):i.scop&&i.relObj&&(r-parseInt(i.relObj.css("left"))>i.cellMinW?this.$element.css("left",r):this.$element.css("left",r));else if("vertical"===i.move)this.$element.css("top",l);else{i.selector?this.options.$obj.find(i.selector):this.options.$obj;if(i.drop){var d=t("#bjui-drag-placeholder");d.length||(d=t('<div style="position:absolute; z-index:999;" id="bjui-drag-placeholder"></div>').appendTo(t("body"))),d.css({left:e.pageX,top:e.pageY,opacity:1}).show().empty().append(this.$element.clone()),this.$placeholder=d}else this.$element.css({left:r,top:l})}if(i.drag&&i.drag.apply(this.$element,[this.$element,e,r,l]),i.drop&&a.drop(e),i.container){!i.container instanceof jQuery&&(i.container=t(i.container));var c=i.container.scrollTop();c||i.container.scrollTop(1),i.container.scrollTop()&&a.tools.mouseDirection(i.container,{e:e,move:function(t,a){("top"===a||"bottom"===a)&&i.container.scrollTop(i.container.scrollTop()+(e.clientY-i.event.clientY)/13)}})}return this.preventEvent(e)},a.prototype.stop=function(e){var a=this;if(t(document).off("mousemove.bjui.basedrag").off("mouseup.bjui.basedrag").off("mouseover.bjui.basedrag"),a.options.drop&&a.options.drop.off("mouseenter.bjui.basedrag"),this.options.stop&&this.options.stop.apply(this.$element,[this.$element,e]),this.hasEvent?this.destroy():a.$drag.off("mousedown").on("mousedown",t.proxy(function(t){a.options.event=t,a.options.oleft=0,a.options.otop=0,a.start(t)},a)),a.options.drop&&!a.isDrop){var i=a.$element.offset();a.$placeholder&&a.$placeholder.animate({top:i.top,left:i.left,opacity:.2},"normal",function(){a.$placeholder.hide()})}return a.isDrop&&(a.$placeholder&&a.$placeholder.hide(),a.$drop&&a.$drop.trigger("drop.bjui.basedrag",[a.$element])),a.$drops&&a.$drops.css("-moz-user-select",""),t(document).off("selectstart"),this.preventEvent(e)},a.prototype.preventEvent=function(t){return t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),!1},a.prototype.destroy=function(){this.$element.removeData("bjui.basedrag"),this.options.nounbind||this.$element.off("mousedown")};var i=t.fn.basedrag;t.fn.basedrag=e,t.fn.basedrag.Constructor=a,t.fn.basedrag.noConflict=function(){return t.fn.basedrag=i,this}}(jQuery),+function(t){"use strict";function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),s=t.extend({},o.data(),"object"==typeof e&&e),r=o.data("bjui.sidenav");r||o.data("bjui.sidenav",r=new a(this,s)),"string"==typeof n&&t.isFunction(r[n])&&([].shift.apply(i),i?r[n].apply(r,i):r[n]())})}var a=function(e,a){this.$element=t(e),this.options=a};a.prototype.ajaxHnav=function(){var e=this,a=e.options,i=a.childKey||"children",n=e.$element.parent(),o=t("#bjui-sidenav-box"),s=BJUI.StrBuilder(),r=t("#bjui-sidenav-btn"),l=function(t){var e=BJUI.StrBuilder(),a=t.target||"navtab";return e.add('<a href="'+(t.url||"javascript:;")+'" '),!t.url||"dialog"!==a&&"navtab"!==a?t.url&&e.add('target="'+a+'"'):(e.add('data-toggle="'+a+'" data-options="{id:\''+t.id+"', title:'"+(t.title||t.name)+"'"),t.width&&e.add(", width:"+t.width),t.height&&e.add(", height:"+t.height),t.fresh&&e.add(", fresh:"+t.fresh),t.mask&&e.add(", mask:"+t.mask),e.add('}"')),t[i]&&e.add(' class="right-arrow"'),e.add('><i class="fa fa-'+(t.icon||"caret-right")+'"></i>&nbsp;'+t.name),t[i]&&e.add('<b><i class="fa fa-angle-right"></i></b>'),e.add("</a>").add(d(t)),e.toString()},d=function(e){var a=BJUI.StrBuilder();return e[i]&&(a.add('<ul class="nav">'),t.each(e[i],function(t,e){var i=e.target||"navtab",n=e.id&&String(e.id).isNormalID&&e.id;a.add("<li"),"navtab"===i&&n&&e.url&&a.add(' class="'+i+"-"+n+'"'),a.add(">").add(l(e)).add("</li>")}),a.add("</ul>")),a.toString()},c=function(e){t.isArray(e)||(e=[e]),s.add('<ul class="nav">'),t.each(e,function(t,e){var a=e.target||"navtab",i=e.id&&String(e.id).isNormalID&&e.id;s.add("<li"),"navtab"===a&&i&&e.url&&s.add(' class="'+a+"-"+i+'"'),s.add(">").add(l(e)).add("</li>")}),s.add("</ul>"),o.html(s.toString()).off("click").on("click",".nav > li > a",function(e){var a=t(this),i=a.next(".nav"),n=a.closest("li"),o=n.siblings();i.length&&(i.stop().slideToggle(function(){n.toggleClass("open",i.is(":visible"))}),n.hasClass("open")||o.find("> .nav").stop().slideUp(function(){t(this).closest("li").removeClass("open")}))}),n.data("bjui.sidenav.hnav.panels",o.find("> ul")),t(document).on("switch.bjui.navtab",function(e){var a=t("body").data("bjui.navtab");a&&a.current&&o.find("li").removeClass("active").filter(".navtab-"+a.current).addClass("active")}),BJUI.ui.displayFirst&&o.find("> .nav > li:first > a").trigger("click"),!t("body").data("bjui.sidenav.init")&&r.is(":visible")&&r.trigger("click")},u=function(e){var i,n="undefined"==typeof a.single||n;BJUI.StrBuilder();o.empty(),n?(i=t('<ul class="ztree" data-toggle="ztree" id="bjui-sidenav-ztree-0"></ul>').data("options",a.treeOptions).data("nodes",e),o.append(i).initui()):(t.isArray(e)||(e=[e]),t.each(e,function(n,s){i=t('<ul class="ztree" data-toggle="ztree" id="bjui-sidenav-ztree-'+n+'"></ul>').data("options",a.treeOptions).data("nodes",e),o.append(i)}),o.initui()),!t("body").data("bjui.sidenav.init")&&r.is(":visible")&&r.trigger("click")};BJUI.ajax("doajax",{url:a.url,loadingmask:!1,target:o,okCallback:a.tree?u:c})},a.prototype.initHnav=function(){var e,a=this,i=a.options,n=i.childKey||"children",o=i.targetKey||"target",s=i.idKey||"id",r=a.$element.parent(),l=t("#bjui-sidenav-box"),d=t("#bjui-sidenav-btn"),c=BJUI.StrBuilder(),u=function(t){t||(t={});var e=BJUI.StrBuilder(),a=t[o]||"navtab";return e.add('<a href="'+(t.url||"javascript:;")+'" '),!t.url||"dialog"!==a&&"navtab"!==a?t.url&&e.add('target="'+a+'"'):(e.add('data-toggle="'+a+'" data-options="{id:\''+t[s]+"', title:'"+(t.title||t.name)+"'"),t.width&&e.add(", width:"+t.width),t.height&&e.add(", height:"+t.height),t.fresh&&e.add(", fresh:"+t.fresh),t.mask&&e.add(", mask:"+t.mask),e.add('}"')),t[n]&&e.add(' class="right-arrow"'),e.add('><i class="fa fa-'+(t.icon||"caret-right")+'"></i>&nbsp;'+t.name),t[n]&&e.add('<b><i class="fa fa-angle-right"></i></b>'),e.add("</a>").add(p(t)),e.toString()},p=function(e){var a=BJUI.StrBuilder();return e[n]&&(a.add('<ul class="nav">'),t.each(e[n],function(t,e){var i=e.target||"navtab",n=e[s]&&String(e[s]).isNormalID&&e[s];a.add("<li"),"navtab"===i&&n&&e.url&&a.add(' class="'+i+"-"+n+'"'),a.add(">").add(u(e)).add("</li>")}),a.add("</ul>")),a.toString()},h=function(e){t.isArray(e)||(e=[e]),c.add('<ul class="nav">'),t.each(e,function(t,e){var a=e.target||"navtab",i=e[s]&&String(e[s]).isNormalID&&e[s];c.add("<li"),"navtab"===a&&i&&e.url&&c.add(' class="'+a+"-"+i+'"'),c.add(">").add(u(e)).add("</li>")}),c.add("</ul>"),l.html(c.toString()).off("click").on("click",".nav > li > a",function(e){var a=t(this),i=a.next(".nav"),n=a.closest("li"),o=n.siblings();i.length&&(i.stop().slideToggle(function(){n.toggleClass("open",i.is(":visible"))}),n.hasClass("open")||o.find("> .nav").stop().slideUp(function(){t(this).closest("li").removeClass("open")}))}),r.data("bjui.sidenav.hnav.panels",l.find("> ul")),t(document).on("switch.bjui.navtab",function(e){var a=t("body").data("bjui.navtab");a&&a.current&&l.find("li").removeClass("active").filter(".navtab-"+a.current).addClass("active")}),BJUI.ui.displayFirst&&l.find("> .nav > li:first > a").trigger("click"),!t("body").data("bjui.sidenav.init")&&d.is(":visible")&&d.trigger("click")},g=function(e){var a,n="undefined"==typeof i.single||n;BJUI.StrBuilder();l.empty(),n?(a=t('<ul class="ztree" data-toggle="ztree" id="bjui-sidenav-ztree-0"></ul>').data("options",i.treeOptions).data("nodes",e),l.append(a).initui()):(t.isArray(e)||(e=[e]),t.each(e,function(n,o){a=t('<ul class="ztree" data-toggle="ztree" id="bjui-sidenav-ztree-'+n+'"></ul>').data("options",i.treeOptions).data("nodes",e),l.append(a)}),l.initui()),!t("body").data("bjui.sidenav.init")&&d.is(":visible")&&d.trigger("click")};e=a.$element.next(".items").html(),e&&(e=t.parseJSON(e),i.tree?g(e):h(e))};var i=t.fn.sidenav;t.fn.sidenav=e,t.fn.sidenav.Constructor=a,t.fn.basedrag.noConflict=function(){return t.fn.sidenav=i,this},t(function(){t("#bjui-sidenav-col").on("click.bjui.sidenav",".nav > li > a",function(){var e=t("#bjui-sidenav-col");return t(this).hasClass("right-arrow")?!1:void(e.hasClass("autohide")&&t("#bjui-sidenav-arrow").trigger("click"))})}),t(document).on("click.bjui.sidenav.data-api",'[data-toggle="sidenav"]',function(a){a.preventDefault();var i=t("body"),n=t(this),o=n.data("url")||n.attr("href"),s=n.data("cache"),r=t(this).parent(),l=t("#bjui-sidenav-box"),d=r.data("bjui.sidenav.hnav.panels");"undefined"==typeof i.data("bjui.sidenav.init")?i.data("bjui.sidenav.init",!0):i.data("bjui.sidenav.init",!1),r.addClass("active").siblings().removeClass("active"),!o||o.startsWith("#")||o.startsWith("javascript")?(l.find("> .nav").detach(),d&&d.length?l.append(d):e.call(n,"initHnav")):s&&d&&d.length?l.append(d):(n.data("url",o),e.call(n,"ajaxHnav"))})}(jQuery),+function(t){"use strict";function e(e){var a=arguments,i=e;return this.each(function(){var n=t(this),s=t.extend({},o.DEFAULTS,n.data(),"object"==typeof e&&e),r=n.data("bjui.contextmenu");r||n.data("bjui.contextmenu",r=new o(this,s)),"string"==typeof i&&t.isFunction(r[i])?([].shift.apply(a),a?r[i].apply(r,a):r[i]()):r.init()})}var a,i,n;t(function(){var e=function(){a=t('<div id="bjui-contextmenu"></div>').hide(),i=t('<div id="bjui-contextmenuShadow"></div>').hide(),n=[],t("body").append("<!-- contextmenu -->").append(a).append(i)};e()});var o=function(e,a){this.$element=t(e),this.options=a};o.DEFAULTS={id:void 0,shadow:!0,bindings:{},ctrSub:null},o.prototype.init=function(){var t=this,e=this.options;if(e.id){n.push({id:e.id,shadow:e.shadow,bindings:e.bindings||{},ctrSub:e.ctrSub});var a=n.length-1;this.$element.on("contextmenu",function(i){return t.display(a,this,i,e),!1})}},o.prototype.display=function(e,o,s,r){var l=this,d=n[e],c=BJUI.regional[d.id],u=FRAG[d.id];t.each(c,function(t,e){u=u.replace("#"+t+"#",c[t])}),a.html(u),t.each(d.bindings,function(e,i){t('[rel="'+e+'"]',a).on("click",function(e){l.hide(),i(t(o),t("#bjui-"+d.id))})});var p=s.pageX,h=s.pageY;t(window).width()<p+a.width()&&(p-=a.width()),t(window).height()<h+a.height()&&(h-=a.height()),a.css({left:p,top:h}).show(),d.shadow&&i.css({width:a.width(),height:a.height(),left:p+3,top:h+3}).show(),t(document).one("click",l.hide),t.isFunction(d.ctrSub)&&d.ctrSub(t(o),t("#bjui-"+d.id))},o.prototype.hide=function(){a.hide(),i.hide()},o.prototype.show=function(e){var a=this;e.items&&e.items.length&&a.$element.on("contextmenu",function(i){var n=!0;return e.exclude&&a.$element.find(e.exclude).each(function(){return this==i.target||t(this).find(i.target).length?void(n=!1):void 0}),n?(a.custom(e.items,i),!1):(i.stopPropagation(),!n)})},o.prototype.custom=function(e,n){a.empty().html("<ul></ul>");var o,s=this,r=s.options,l=a.find("> ul");t.each(e,function(e,a){var i="";a.icon&&(i='<i class="fa fa-'+a.icon+'"></i>'),"diver"==a.title?o=t('<li class="diver"></li>'):(o=t('<li><span class="icon">'+i+'</span><span class="title">'+a.title+"</span></li>"),a.func&&"string"==typeof a.func&&(a.func=a.func.toFunc()),a.func&&o.on("click",function(t){s.hide(),a.func(s.$element,o)})),o.appendTo(l)});var d=n.pageX,c=n.pageY;t(window).width()<d+a.width()&&(d-=a.width()),t(window).height()<c+a.height()&&(c-=a.height()),a.css({left:d,top:c}).show(),r.shadow&&i.css({width:a.width(),height:a.height(),left:d+3,top:c+3}).show(),t(document).one("click",s.hide)};var s=t.fn.contextmenu;t.fn.contextmenu=e,t.fn.contextmenu.Constructor=o,t.fn.contextmenu.noConflict=function(){return t.fn.contextmenu=s,this}}(jQuery),+function(t){"use strict";function e(e){var a=arguments,i=e,n="bjui.navtab",o=t("body"),s=o.data(n)||{};return this.each(function(){var r=(t(this),t.extend({},f.DEFAULTS,"object"==typeof e&&e)),l=r&&r.id,d=s&&s[s.current];if("string"==typeof i&&t.isFunction(d[i])){if(!d)return;[].shift.apply(a),a?d[i].apply(d,a):d[i]()}else{if(l){if(!l.isNormalID())return void BJUI.debug("BJUI.Navtab: ID ["+l+"] "+BJUI.regional.idChecked)}else l=s?s.current:"main",BJUI.ui.overwriteHomeTab||"main"!==l||(l="navtab");r.id=l,s[l]?(d=s[l],"object"==typeof e&&e&&t.extend(d.options,e)):s[l]=d=new f(r),o.data(n,s),d.openTab()}})}var a,i,n,o,s,r,l,d,c,u,p,h,g;t(function(){var e=function(){a=0,o=t("#bjui-navtab"),s=o.find("> .tabsPageHeader > .tabsPageHeaderContent > .navtab-tab"),r=o.find("> .navtab-panel"),l=o.find("> .tabsPageHeader > .tabsLeft"),d=o.find("> .tabsPageHeader > .tabsRight"),c=o.find("> .tabsPageHeader > .tabsMore"),u=o.find("> .tabsMoreList"),p=s.find("li:first"),h=u.find("li:first"),l.click(function(){t(this).navtab("scrollPrev")}),d.click(function(){t(this).navtab("scrollNext")}),c.click(function(){u.show();var e=t(window).height(),a=u.height(),i=t("#bjui-top").height()+t("#bjui-navbar").height(),n=e-i-26;a>n?u.height(n-10):u.height("")}),t(document).on("click.bjui.navtab.switchtab",function(e){var a="I"==e.target.tagName?t(e.target).parent():t(e.target);c[0]!=a[0]&&u.hide()});var e,i=t.extend({},f.DEFAULTS,p.data(),{id:"main",title:e}),n=new f(i);t("body").data("bjui.navtab",{main:n,current:"main"}),p.attr("data-url")&&t(document).one(BJUI.eventType.initUI,function(t){p.removeAttr("data-url").navtab("reload",i)}),p.data("options",t.extend({},i)).navtab("contextmenu",p).click(function(){t(this).hasClass("active")||BJUI.navtab("switchTab","main")}).find("> a > span").html(function(t,a){return e=a.replace("#maintab#",BJUI.regional.maintab)}),p.attr("data-url")&&t(document).one(BJUI.eventType.initUI,function(t){p.removeAttr("data-url").navtab("reload",i)}),setTimeout(function(){p.trigger("click")},100),h.click(function(){t(this).hasClass("active")?u.hide():BJUI.navtab("switchTab","main")}).find("> a").html(function(t,e){return e.replace("#maintab#",BJUI.regional.maintab)}),t.CurrentNavtab=r.find("> .navtabPage").eq(0)};e()});var f=function(t){this.options=t,this.tools=this.TOOLS()};f.DEFAULTS={id:null,title:"New tab",url:null,type:"GET",data:{},loadingmask:!0,fresh:!1,autorefresh:!1,onLoad:null,beforeClose:null,onClose:null},f.prototype.TOOLS=function(){var e=this,c={getDefaults:function(){return f.DEFAULTS},getTabs:function(){return s.find("> li")},getPanels:function(){return r.find("> div")},getMoreLi:function(){return u.find("> li")},getTab:function(t){var e=this.indexTabId(t);return e>=0?this.getTabs().eq(e):void 0},getPanel:function(t){var e=this.indexTabId(t);return e>=0?this.getPanels().eq(e):void 0},getTabsW:function(t,e){return this.tabsW(this.getTabs().slice(t,e))},tabsW:function(e){var a=0;return e.each(function(){a+=t(this).outerWidth(!0)}),a},indexTabId:function(e){var a=-1;return e?(this.getTabs().each(function(i){return t(this).data("options").id===e?(a=i,!1):void 0}),a):a},getLeft:function(){return s.position().left},getScrollBarW:function(){return o.width()-55},visibleStart:function(){var e=this.getTabs(),a=this.getLeft(),i=0,n=0;return e.each(function(e){return i+a>=0?(n=e,!1):void(i+=t(this).outerWidth(!0))}),n},visibleEnd:function(){var e=this,a=this.getTabs(),i=this.getLeft(),n=0,o=a.length;return a.each(function(a){return n+=t(this).outerWidth(!0),n+i>e.getScrollBarW()?(o=a,!1):void 0}),o},scrollPrev:function(){var t=this.visibleStart();t>0&&this.scrollTab(-this.getTabsW(0,t-1))},scrollNext:function(){var t=this.visibleEnd();t<this.getTabs().size()&&this.scrollTab(-this.getTabsW(0,t+1)+this.getScrollBarW())},scrollTab:function(t,a){s.animate({left:t},150,function(){e.tools.ctrlScrollBtn()})},scrollCurrent:function(){var t=this.tabsW(this.getTabs()),e=this.getScrollBarW();e>=t?this.scrollTab(0):this.getLeft()<e-t?this.scrollTab(e-t):a<this.visibleStart()?this.scrollTab(-this.getTabsW(0,a)):a>=this.visibleEnd()&&this.scrollTab(e-this.getTabs().eq(a).outerWidth(!0)-this.getTabsW(0,a))},ctrlScrollBtn:function(){var t=this.tabsW(this.getTabs());this.getScrollBarW()>t?(l.hide(),d.hide(),s.parent().removeClass("tabsPageHeaderMargin")):(l.show().removeClass("tabsLeftDisabled"),d.show().removeClass("tabsRightDisabled"),s.parent().addClass("tabsPageHeaderMargin"),this.getLeft()>=0?l.addClass("tabsLeftDisabled"):this.getLeft()<=this.getScrollBarW()-t&&d.addClass("tabsRightDisabled"))},switchTab:function(o){var s=this.getTabs().removeClass("active").eq(o).addClass("active"),r=this.getPanels(),l=r.eq(o),d=e.options.onSwitch?e.options.onSwitch.toFunc():null,c=t(FRAG.maskBackground);r.css({top:"-10000000px"}),s.data("reloadFlag")?(l.animate({top:0}),e.refresh(s.data("options").id)):l.find(".bjui-ajax-mask").length?l.css({top:0}):(l.css({top:0}).append(c),c.fadeOut("normal",function(){t(this).remove()})),this.getMoreLi().removeClass("active").eq(o).addClass("active"),a=o,this.scrollCurrent(),i=s,t.CurrentNavtab=n=l,d&&d.apply(e);var u=t("body").data("bjui.navtab"),p=s.data("options").id;p!==e.options.id?u.current=p:u.current=e.options.id,l.trigger("switch.bjui.navtab")},closeTab:function(i,n){var o=this.getTabs().eq(i),s=this.getMoreLi().eq(i),r=this.getPanels().eq(i),l=o.data("options"),d=l.beforeClose?l.beforeClose.toFunc():null,c=l.onClose?l.onClose.toFunc():null,u=!0;if(d&&(u=d.apply(e,[r])),!u)return void e.tools.switchTab(i);if(o.remove(),s.remove(),r.trigger(BJUI.eventType.beforeCloseNavtab).remove(),g&&clearInterval(g),c&&c.apply(e),a>=i&&a--,n){var p=this.indexTabId(n);p>0&&(a=p)}var h=t("body").data("bjui.navtab");h[l.id]&&delete h[l.id],this.scrollCurrent(),this.switchTab(a)},closeOtherTab:function(e){e=e||a,this.getTabs().each(function(a){a>0&&e!=a&&t(this).find("> .close").trigger("click")})},loadUrlCallback:function(t){t.find(":button.btn-close").click(function(){e.closeCurrentTab()})},updateTit:function(t,e){this.getTabs().eq(t).find("> a").attr("title",e).find("> span").html(e),this.getMoreLi().eq(t).find("> a").attr("title",e).html(e)},reload:function(t,a){a=a||t.data("reloadFlag");var i=t.data("options");if(a){t.data("reloadFlag",!1);var n=e.tools.getPanel(i.id);t.hasClass("external")?e.openExternal(i.url,n,i.data):e.tools.reloadTab(n,i)}},reloadTab:function(t,a){var i=a.onLoad?a.onLoad.toFunc():null,n=a.autorefresh&&(isNaN(String(a.autorefresh))?15:a.autorefresh);t.trigger(BJUI.eventType.beforeLoadNavtab).ajaxUrl({type:a.type||"GET",url:a.url,data:a.data||{},loadingmask:a.loadingmask,callback:function(a){e.tools.loadUrlCallback(t),i&&i.apply(e,[t]),g&&clearInterval(g),n&&(g=setInterval(function(){t.navtab("refresh")},1e3*n)),BJUI.ui.clientPaging&&t.data("bjui.clientPaging")&&t.pagination("setPagingAndOrderby",t)}})}};return c},f.prototype.contextmenu=function(t){var e=this;t.contextmenu({id:"navtabCM",bindings:{reload:function(t,a){t.data("options").url&&e.refresh(t.data("options").id)},closeCurrent:function(t,a){var i=t.data("options").id;i?e.closeTab(i):e.closeCurrentTab()},closeOther:function(t,i){if(t.index()){var n=e.tools.indexTabId(t.data("options").id);e.tools.closeOtherTab(n>0?n:a)}else e.closeAllTab()},closeAll:function(t,a){e.closeAllTab()}},ctrSub:function(t,a){var i=a.find('[rel="reload"]'),n=a.find('[rel="closeCurrent"]');a.find('[rel="closeOther"]'),a.find('[rel="closeAll"]'),e.tools.getTabs();t.index()||(n.addClass("disabled"),t.data("options").url||i.addClass("disabled"))}})},f.prototype.openTab=function(){var e,i=this,n=this.options,o=this.tools;if(!n.url&&n.href&&(n.url=n.href),!n.url)return void BJUI.debug("BJUI.Navtab: Error trying to open a navtab, url is undefined!");if(n.url=decodeURI(n.url).replacePlh(),!n.url.isFinishedTm())return t("body").alertmsg("error",n.warn||BJUI.regional.plhmsg),void BJUI.debug("BJUI.Navtab: The new navtab's url is incorrect, url: "+n.url);if(n.url=encodeURI(n.url),e=n.id?o.indexTabId(n.id):a,e>=0){var l=o.getTabs().eq(e),d=o.getPanels().eq(e),c=l.data("options");n.fresh||n.url!=c.url?i.reload(n):n.title!=c.title&&(c.title=n.title,o.updateTit(e,n.title)),a=e,"main"==n.id&&this.contextmenu(l)}else{var p='<li><a href="javascript:" title="#title#"><span>#title#</span></a><span class="close">&times;</span></li>',l=t(p.replaceAll("#title#",n.title)),d=t('<div class="navtabPage unitBox"></div>'),h=t('<li><a href="javascript:" title="#title#">#title#</a></li>'.replaceAll("#title#",n.title));l.appendTo(s),d.appendTo(r),h.appendTo(u),l.data("options",t.extend({},n)),n.external||n.url&&n.url.isExternalUrl()?(l.addClass("external"),this.openExternal(n.url,d,n.data)):(l.removeClass("external"),o.reloadTab(d,n)),a=o.getTabs().length-1,this.contextmenu(l),l.on("click",function(e){t(this).hasClass("active")||i.switchTab(n.id)}).on("click.bjui.navtab.close",".close",function(t){i.closeTab(n.id)}).on("mousedown.bjui.navtab.drag","a",function(e){l.data("bjui.navtab.drag",!0),setTimeout(t.proxy(function(){l.data("bjui.navtab.drag")&&i.drag(e,l,d,h)},i),150),e.preventDefault()}).on("mouseup.bjui.navtab.drag","a",function(t){l.data("bjui.navtab.drag",!1)}),h.on("click",function(){i.switchTab(n.id)})}o.switchTab(a),o.scrollCurrent()},f.prototype.closeTab=function(t){var e=this.tools.indexTabId(t);e>0&&this.tools.closeTab(e)},f.prototype.closeCurrentTab=function(t){a>0&&this.tools.closeTab(a,t)},f.prototype.closeAllTab=function(){this.tools.getTabs().find("> .close").trigger("click")},f.prototype.reloadFlag=function(t){for(var e=t.split(","),i=0;i<e.length;i++){var n=this.tools.getTab(e[i].trim());n&&(this.tools.indexTabId(e[i])==a?this.tools.reload(n,!0):n.data("reloadFlag",!0))}},f.prototype.switchTab=function(t){var e=this.tools.indexTabId(t);this.tools.switchTab(e)},f.prototype.scrollPrev=function(){this.tools.scrollPrev()},f.prototype.scrollNext=function(){this.tools.scrollNext()},f.prototype.refresh=function(t){var e,a;e=t?"string"==typeof t?this.tools.getTab(t):t:i,e&&e.length&&(a=this.tools.getPanel(e.data("options").id),a.removeData("bjui.clientPaging"),this.reload(e.data("options")))},f.prototype.reload=function(e){var i=this,n=t.extend({},"object"==typeof e&&e),o=n.id?this.tools.getTab(n.id):this.tools.getTabs().eq(a);if(o){var s=o.data("options"),r=function(){n.title&&n.title!=s.title&&i.tools.updateTit(o.index(),n.title),o.data("options",t.extend({},s,n)),i.tools.reload(o,!0)};s.reloadWarn?t("body").alertmsg("confirm",s.reloadWarn,{okCall:function(){r()}}):r()}},f.prototype.reloadForm=function(e,a){var o=t.extend({},"object"==typeof a&&a),s=o.id?this.tools.getTab(o.id):i,r=o.id?this.tools.getPanel(o.id):n;if(s&&r){var l=(s.data("options"),{}),d={},c=o.form;if(c&&c.length)if(o.type=o.type||c.attr("method")||"POST",o.url=o.url||c.attr("action"),d=c.serializeJson(),e){var u=BJUI.pageInfo;for(var p in u)l[u[p]]=d[u[p]]}else l=d;o.data=t.extend({},o.data||{},l),s.hasClass("external")?this.openExternal(o.url,r,o.data):this.tools.reloadTab(r,o)}},f.prototype.getCurrentPanel=function(){return this.tools.getPanels().eq(a)},f.prototype.checkTimeout=function(){var t=JSON.parse(n.html());t&&t[BJUI.keys.statusCode]==BJUI.statusCode.timeout&&this.closeCurrentTab()},f.prototype.openExternal=function(e,a,i){var n=a.closest(".navtab-panel").height();i&&!t.isEmptyObject(i)&&(e.indexOf("?")?e+="&":"?",e+=t.param(i)),a.html(FRAG.externalFrag.replaceAll("{url}",e).replaceAll("{height}",n+"px"))},f.prototype.drag=function(e,a,i,n){var o,r=this,l=r.tools.getTabs(),d=r.tools.getPanels(),c=r.tools.getMoreLi(),u=s.next(".bjui-navtab-drag"),p=(a.prev(),a.next(),a.index()),h=(a.width(),a.position().left),g=[],f=[];l.length<=2||(u.length||(u=t('<div class="bjui-navtab-drag" style="position:absolute; top:0; left:1px; width:2px; height:25px; background:#ff6600; display:none;"></div>'),u.insertAfter(s)),u.css("left",h-2),s.find("> li").each(function(){g.push(t(this).position().left)}),a.find("> a").basedrag({move:"horizontal",oleft:h,drag:function(e,i,n,s){a.addClass("navtab-drag"),f=[n],t.merge(f,g),f.sort(function(t,e){return t-e}),o=t.inArray(n,f),o||(o=1),o==l.length?u.css("left",g[o-1]-2+l.last().width()):u.css("left",g[o]-2),u.show()},stop:function(){a.removeClass("navtab-drag"),u.hide(),p!=o&&(o==l.length?p!=l.length-1&&(a.insertAfter(l.eq(o-1)),i.insertAfter(d.eq(o-1)),n.insertAfter(c.eq(o-1))):(a.insertBefore(l.eq(o)),i.insertBefore(d.eq(o)),n.insertBefore(c.eq(o))))},event:e,nounbind:!0}))};var m=t.fn.navtab;t.fn.navtab=e,t.fn.navtab.Constructor=f,t.fn.navtab.noConflict=function(){return t.fn.navtab=m,this},BJUI.navtab=function(){e.apply(t("body"),arguments)},t(document).on("click.bjui.navtab.data-api",'[data-toggle="navtab"]',function(a){a.preventDefault();var i=t(this),n=i.attr("href"),o=i.data(),s=o.options;s&&("string"==typeof s&&(s=s.toObj()),"object"==typeof s&&t.extend(o,s)),o.title||(o.title=i.text()),n&&!o.url&&(o.url=n),e.call(i,o)})}(jQuery),+function(t){"use strict";function e(e){var a=arguments,i=e,n="bjui.dialog",o=t("body"),r=o.data(n)||{};return this.each(function(){var l,d=(t(this),t.extend({},s.DEFAULTS,"object"==typeof e&&e)),c=d&&d.id;if(c){if(!c.isNormalID())return void BJUI.debug("BJUI.Dialog: ID ["+c+"] "+BJUI.regional.idChecked)}else c=r.current?r.current:"dialog";d.id=c,l=r&&r[c],l?"object"==typeof e&&e&&t.extend(l.options,e):r[c]=l=new s(d),o.data(n,r),"string"==typeof i&&t.isFunction(l[i])?([].shift.apply(a),a?l[i].apply(l,a):l[i]()):l.open()})}var a,i,n,o;t(function(){var e=function(){a=t("#bjui-resizable"),n="dialogShadow",o=s.ZINDEX,t("body").append("<!-- dialog resizable -->").append(FRAG.resizable)};e()});var s=function(e){this.$element=t("body"),this.options=e,this.tools=this.TOOLS()};s.DEFAULTS={id:null,title:"New Dialog",url:null,type:"GET",data:{},loadingmask:!0,width:500,height:300,minW:65,minH:40,max:!1,mask:!1,resizable:!0,drawable:!0,maxable:!0,minable:!0,fresh:!1,onLoad:null,beforeClose:null,onClose:null},s.ZINDEX=30,s.prototype.TOOLS=function(){var e=this,a={getDefaults:function(){return s.DEFAULTS},init:function(a){var i=e.options.width>e.options.minW?e.options.width:e.options.minW,o=e.options.height>e.options.minH?e.options.height:e.options.minH,s=t(window).width(),r=t(window).height(),l=e.options.max?0:(r-o)/3;i>s&&(i=s),o>r&&(o=r),a.height(o).width(i).show().css({left:(s-i)/2,top:0,opacity:.1}).animate({top:l>0?l:0,opacity:1}).addClass(n).find("> .dialogContent").height(o-t("> .dialogHeader",a).outerHeight()),t("body").find("> .bjui-dialog-container").not(a).removeClass(n)},reload:function(a,i){var n,o,s=this,r=a.find("> .dialogContent"),l=i&&i.data;i=i||a.data("options"),n=i.onLoad?i.onLoad.toFunc():null,a.trigger(BJUI.eventType.beforeLoadDialog),i.url?(l&&("string"==typeof l&&(l=l.trim().startsWith("{")?l.toObj():l.toFunc()),"function"==typeof l&&(l=l.apply())),r.ajaxUrl({type:i.type||"GET",url:i.url,data:l||{},loadingmask:i.loadingmask,callback:function(t){n&&n.apply(e,[a]),BJUI.ui.clientPaging&&a.data("bjui.clientPaging")&&a.pagination("setPagingAndOrderby",a),s.resizeBjuiRow(a)}})):(i.image?o='<img src="'+decodeURIComponent(i.image)+'" style="max-width:100%;">':i.html?(o=i.html,"string"==typeof o&&t.isFunction(o.toFunc())&&(o=o.toFunc())):i.target&&(o=t(i.target).html()||a.data("bjui.dialog.target"),t(i.target).empty(),a.data("bjui.dialog.target",o)),r.trigger(BJUI.eventType.beforeAjaxLoad).html(o).initui(),n&&n.apply(e,[a]),this.resizeBjuiRow(a))},resizeContent:function(e){var a=e.find("> .dialogContent");a.css({height:e.height()-e.find("> .dialogHeader").outerHeight()}),t(window).trigger(BJUI.eventType.resizeGrid)},resizeBjuiRow:function(e){var a=e.width(),i=BJUI.formColWidth;e.find(".bjui-row").each(function(){var e=t(this);-1===e.attr("class").indexOf("col-")&&e.addClass("col-none"),e.filter(".col-4").toggleClass("col-3",a<i.L&&a>i.M).end().filter(".col-3, .col-4").toggleClass("col-2",a<i.M&&a>i.S).end().filter(".col-2, .col-3, .col-4").toggleClass("col-1",a<i.S&&a>i.SS).end().filter(".col-none, .col-1, .col-2, .col-3, .col-4").toggleClass("col-0",a<i.SS)})}};return a},s.prototype.open=function(){var e=this,a=e.options,n=t("body"),s=n.data("bjui.dialog"),r=s[a.id],l=r&&r.dialog;if(a.target||t(a.target).length||a.html||a.image)a.url=void 0;else{if(!a.url&&a.href&&(a.url=a.href),!a.url)return void BJUI.debug("BJUI.Dialog: Error trying to open a dialog, url is undefined!");if(a.url=decodeURI(a.url).replacePlh(),!a.url.isFinishedTm())return BJUI.alertmsg("error",a.warn||BJUI.regional.plhmsg),void BJUI.debug("BJUI.Dialog: The new dialog's url is incorrect, url: "+a.url);a.url=encodeURI(a.url)}if(l){var d=l.data("options");this.switchDialog(l),l.is(":hidden")&&l.show(),(a.fresh||a.url!=d.url)&&e.reload(a)}else{var c=BJUI.regional.dialog,u=FRAG.dialog.replace("#close#",c.close).replace("#maximize#",c.maximize).replace("#restore#",c.restore).replace("#minimize#",c.minimize).replace("#title#",c.title);l=t(u).data("options",t.extend({},a)).css("z-index",++o).hide().appendTo(n),l.find("> .dialogHeader > h1 > span.title").html(a.title),this.tools.init(l),a.maxable?l.find("a.maximize").show():l.find("a.maximize").hide(),a.minable?l.find("a.minimize").show():l.find("a.minimize").hide(),a.max&&e.maxsize(l),a.mask?this.addMask(l):a.minable&&t.fn.taskbar&&this.$element.taskbar({id:a.id,title:a.title}),l.on("click",function(a){t(a.target).data("bjui.dialog")||i&&i[0]!=l[0]&&e.switchDialog(l)}).on("click",".btn-close",function(t){e.close(l),t.preventDefault()}).on("click",".dialogHeader > a",function(a){var i=t(this);i.hasClass("close")&&e.close(l),i.hasClass("minimize")&&e.minimize(l),i.hasClass("maximize")&&(e.switchDialog(l),e.maxsize(l)),i.hasClass("restore")&&e.restore(l),a.preventDefault(),a.stopPropagation()}).on("dblclick",".dialogHeader > h1",function(t){a.maxable&&(l.find("> .dialogHeader > a.restore").is(":hidden")?l.find("a.maximize").trigger("click"):l.find("> .dialogHeader > a.restore").trigger("click"));
}).on("mousedown.bjui.dialog.drag",".dialogHeader > h1",function(i){e.switchDialog(l),a.drawable&&!l.data("max")&&(l.data("bjui.dialog.task",!0),setTimeout(t.proxy(function(){l.data("bjui.dialog.task")&&e.drag(i,l)},e),150),i.preventDefault())}).on("mouseup.bjui.dialog.drag",".dialogHeader > h1",function(t){l.data("bjui.dialog.task",!1)}).on("mousedown.bjui.dialog.resize",'div[class^="resizable"]',function(i){if(!a.drawable||l.data("max"))return!1;if(!a.resizable)return!1;var n=t(this);e.switchDialog(l),e.resizeInit(i,t("#bjui-resizable"),l,n),n.show(),i.preventDefault()}).on("mouseup.bjui.dialog.resize",'div[class^="resizable"]',function(t){t.preventDefault()}),r.dialog=l,this.tools.reload(l,a)}t.CurrentDialog=i=l,s.current=a.id},s.prototype.addMask=function(e){var a=e.data("bjui.dialog.mask");e.wrap('<div style="z-index:'+o+'" class="bjui-dialog-wrap"></div>'),e.find("> .dialogHeader > a.minimize").hide(),a&&a.length||(a=t(FRAG.dialogMask),a.css("z-index",1).show().insertBefore(e),e.data("bjui.dialog.mask",a))},s.prototype.refresh=function(e){if(e&&"string"==typeof e)for(var a=e.split(","),n=t("body").data("bjui.dialog"),o=0;o<a.length;o++){var s=n&&n[a[o].trim()]&&n[a[o].trim()].dialog;s&&(s.removeData("bjui.clientPaging"),this.tools.reload(s))}else i&&(i.removeData("bjui.clientPaging"),this.tools.reload(i))},s.prototype.resize=function(e,a,n){var o,s,r=t(window).width(),l=t(window).height();if(e||(e=i),o=e.data("options"),s=e.find("> .dialogContent"),a!=o.width&&(a>r&&(a=r),o.max?e.animate({width:a,left:(r-a)/2},"normal"):e.width(a).css("left",(r-a)/2),o.width=a),n!=o.height){var d=0;l>n&&(d=(l-n)/2-20),0>d&&(d=0),o.max?e.animate({height:n,top:d},"normal",function(){s.height(n-e.find("> .dialogHeader").outerHeight())}):(e.height(n).css("top",d),s.height(n-e.find("> .dialogHeader").outerHeight())),o.height=n}},s.prototype.reload=function(e){var a=this,i=t.extend({},"object"==typeof e&&e),n=t("body").data("bjui.dialog"),o=i.id&&n[i.id]&&n[i.id].dialog||a.getCurrent();if(o&&o.length){var s=o.data("options");i=t.extend({},s,i);var r=function(){var e=o.find("> .dialogContent"),n=t(window).width(),r=t(window).height(),l=i.width,d=i.height;if(l!=s.width&&(l>n&&(l=n),i.max?o.animate({width:l,left:(n-l)/2},"normal"):o.width(l).css("left",(n-l)/2)),d!=s.height){var c=0;r>d&&(c=(r-d)/2-20),0>c&&(c=0),i.max?o.animate({height:d,top:c},"normal",function(){e.height(d-o.find("> .dialogHeader").outerHeight())}):(o.height(d).css("top",c),e.height(d-o.find("> .dialogHeader").outerHeight()))}i.maxable!=s.maxable&&(i.maxable?o.find("a.maximize").show():o.find("a.maximize").hide()),i.minable!=s.minable&&(i.minable?o.find("a.minimize").show():o.find("a.minimize").hide()),i.max!=s.max&&i.max&&setTimeout(a.maxsize(o),10),i.mask!=s.mask&&(i.mask?(a.addMask(o),t.fn.taskbar&&a.$element.taskbar("closeDialog",i.id)):i.minable&&t.fn.taskbar&&a.$element.taskbar({id:i.id,title:i.title})),i.title!=s.title&&(o.find("> .dialogHeader > h1 > span.title").html(i.title),o.taskbar("changeTitle",i.id,i.title)),o.data("options",t.extend({},i)),a.tools.reload(o,i)};i.reloadWarn?o.alertmsg("confirm",i.reloadWarn,{okCall:function(){r()}}):r()}},s.prototype.reloadForm=function(e,a){var n,o=t.extend({},"object"==typeof a&&a),s=t("body").data("bjui.dialog");if(o.id?s&&s[o.id]&&(n=s[o.id].dialog):n=i,n){var r=(n.data("options"),{}),l={},d=o.form;if(d&&d.length)if(o.type=o.type||d.attr("method")||"POST",o.url=o.url||d.attr("action"),l=d.serializeJson(),e){var c=BJUI.pageInfo;for(var u in c)r[c[u]]=l[c[u]]}else r=l;o.data=t.extend({},o.data||{},r),this.tools.reload(n,o)}},s.prototype.getCurrent=function(){return i},s.prototype.switchDialog=function(e){var a=e.css("z-index");if(i&&i!=e){var o,s=i.css("z-index"),r=t("body").data("bjui.dialog");if(i.data("options").mask&&(o=i.parent().css("z-index"),Number(o)>Number(a)))return;i.css("z-index",a),e.css("z-index",s),t.CurrentDialog=i=e,r.current=e.data("options").id,t.fn.taskbar&&this.$element.taskbar("switchTask",r.current)}e.addClass(n),t("body").find("> .bjui-dialog-container, > .bjui-dialog-wrap > .bjui-dialog-container").not(e).removeClass(n)},s.prototype.close=function(e){var a=t("body").data("bjui.dialog"),n="string"==typeof e?a[e].dialog:e;if(n&&n.length){var r=this,l=n.data("bjui.dialog.mask"),d=n.data("options"),c=n.data("bjui.dialog.target"),u=d.beforeClose?d.beforeClose.toFunc():null,p=d.onClose?d.onClose.toFunc():null,h=!0,g=function(){delete a[d.id],p&&p.apply(r),t.CurrentDialog=i=null;var e=t("body").find(".bjui-dialog-container"),n=null;e.length?n=r.$element.getMaxIndexObj(e):o=s.ZINDEX,n&&n.is(":visible")&&(t.CurrentDialog=i=n,r.switchDialog(n))};if(n&&d){if(u&&(h=u.apply(r,[n])),!h)return void r.switchDialog(n);d.target&&c&&t(d.target).html(c),l&&l.length?(l.remove(),n.unwrap()):t.fn.taskbar&&this.$element.taskbar("closeDialog",d.id),d.noanimate?(n.trigger(BJUI.eventType.beforeCloseDialog).remove(),g()):n.animate({top:-n.outerHeight(),opacity:.1},"normal",function(){n.trigger(BJUI.eventType.beforeCloseDialog).remove(),g()})}}},s.prototype.closeCurrent=function(){this.close(i)},s.prototype.checkTimeout=function(){var t=i.find("> .dialogContent"),e=JSON.parse(t.html());e&&e[BJUI.keys.statusCode]==BJUI.statusCode.timeout&&this.closeCurrent()},s.prototype.maxsize=function(e){var a=t("#bjui-taskbar"),i=(a.is(":visible")?a.height():0)+1;e.data("original",{top:e.css("top"),left:e.css("left"),width:e.css("width"),height:e.css("height")}).data("max",!0),e.find("> .dialogHeader > a.maximize").hide(),e.find("> .dialogHeader > a.restore").show();t(window).width()-1,t(window).height()-i;e.css({top:0,right:0,left:0,bottom:i,width:"100%",height:"auto"}),this.tools.resizeContent(e),this.tools.resizeBjuiRow(e)},s.prototype.restore=function(t){var e=t.data("original"),a=e.width,i=e.height;t.css({top:e.top,right:"",bottom:"",left:e.left,width:a,height:i}),this.tools.resizeContent(t),this.tools.resizeBjuiRow(t),t.find("> .dialogHeader > a.maximize").show(),t.find("> .dialogHeader > a.restore").hide(),t.data("max",!1)},s.prototype.minimize=function(e){e.hide(),t.fn.taskbar&&this.$element.taskbar("minimize",e);var a=t("body").find(".bjui-dialog-container:visible"),i=null;a.length&&(i=this.$element.getMaxIndexObj(a)),i&&this.switchDialog(i)},s.prototype.drag=function(e,a){t("#bjui-dialogProxy");a.find("> .dialogContent").css("opacity",".3"),a.basedrag({selector:"> .dialogHeader",stop:function(){a.css({left:a.css("left"),top:a.css("top")}).find("> .dialogContent").css("opacity",1)},event:e,nounbind:!0})},s.prototype.resizeDialog=function(e,a,i){var n=parseInt(e.css("left"),10),o=parseInt(e.css("top"),10),s=parseInt(e.css("height"),10),r=parseInt(e.css("width"),10);0>o&&(o=0),a.css({top:o,left:n,width:r,height:s}),"w"!=i&&"e"!=i&&this.tools.resizeContent(a),"n"!=i&&"s"!=i&&(this.tools.resizeBjuiRow(a),t(window).trigger(BJUI.eventType.resizeGrid))},s.prototype.resizeInit=function(e,a,i,n){var o=this,s=n.attr("tar");t("body").css("cursor",s+"-resize"),a.css({top:i.css("top"),left:i.css("left"),height:i.outerHeight(),width:i.css("width")}).show(),this.options.dragCurrent||(this.options.dragCurrent={$resizable:a,$dialog:i,target:s,oleft:parseInt(a.css("left"),10)||0,owidth:parseInt(a.css("width"),10)||0,otop:parseInt(a.css("top"),10)||0,oheight:parseInt(a.css("height"),10)||0,ox:e.pageX||e.screenX,oy:e.pageY||e.clientY},t(document).on("mouseup.bjui.dialog.resize",t.proxy(o.resizeStop,o)),t(document).on("mousemove.bjui.dialog.resize",t.proxy(o.resizeStart,o)))},s.prototype.resizeStart=function(e){var a=this.options.dragCurrent;if(a){if(!e)var e=window.event;var i=(e.pageX||e.screenX)-a.ox,n=(e.pageY||e.clientY)-a.oy,o=a.$dialog.data("bjui.dialog.mask");if(o&&o.length||!((e.pageY||e.clientY)<=0||(e.pageY||e.clientY)>=t(window).height()-a.$dialog.find("> .dialogHeader").outerHeight())){var s=a.target,r=a.owidth,l=a.oheight;"n"!=s&&"s"!=s&&(r+=s.indexOf("w")>=0?-i:i),r>=this.options.minW&&(s.indexOf("w")>=0&&a.$resizable.css("left",a.oleft+i),"n"!=s&&"s"!=s&&a.$resizable.css("width",r)),"w"!=s&&"e"!=s&&(l+=s.indexOf("n")>=0?-n:n),l>=this.options.minH&&(s.indexOf("n")>=0&&a.$resizable.css("top",a.otop+n),"w"!=s&&"e"!=s&&a.$resizable.css("height",l))}}},s.prototype.resizeStop=function(e){var a=this.options.dragCurrent;return a?(t(document).off("mouseup.bjui.dialog.resize").off("mousemove.bjui.dialog.resize"),this.options.dragCurrent=null,this.resizeDialog(a.$resizable,a.$dialog,a.target),t("body").css("cursor",""),void a.$resizable.hide()):!1};var r=t.fn.dialog;t.fn.dialog=e,t.fn.dialog.Constructor=s,t.fn.dialog.noConflict=function(){return t.fn.dialog=r,this},BJUI.dialog=function(){e.apply(t("body"),arguments)},t(document).on("click.bjui.dialog.data-api",'[data-toggle="dialog"]',function(a){var i=t(this),n=i.attr("href"),o=i.data(),s=o.options;s&&("string"==typeof s&&(s=s.toObj()),"object"==typeof s&&t.extend(o,s)),o.title||(o.title=i.text()),n&&!o.url&&(o.url=n),e.call(i,o),a.preventDefault()})}(jQuery),+function(t){"use strict";function e(e){var a=arguments,i=e;return this.each(function(){var n=t(this),o=t.extend({},u.DEFAULTS,n.data(),"object"==typeof e&&e),s=n.data("bjui.taskbar");s?s.options.id!=o.id&&n.data("bjui.taskbar",s=new u(this,o)):n.data("bjui.taskbar",s=new u(this,o)),"string"==typeof i&&t.isFunction(s[i])?([].shift.apply(a),a?s[i].apply(s,a):s[i]()):s.init()})}var a,i,n,o,s,r,l,d,c;t(function(){var e=function(){a=t("#bjui-resizable"),i=t(FRAG.taskbar),n=i.find(".taskbarContent"),o=n.find("> ul"),s=i.find(".taskbarLeft"),r=i.find(".taskbarRight"),l="disabled",d="selected",c="taskbarMargin",t("body").append("<!-- dialog task bar -->").append(i),s.click(function(e){t(this).taskbar("scrollLeft")}),r.click(function(e){t(this).taskbar("scrollRight")})};e()});var u=function(e,a){this.$element=t(e),this.$task=null,this.options=a,this.tools=this.TOOLS()};u.DEFAULTS={id:void 0,title:void 0},u.prototype.init=function(){var e=this,a=o.find("#task-"+this.options.id);if(this.show(),a.length)a.find("> div > span.title").html(this.options.title);else{var i='<li id="#taskid#"><div class="taskbutton"><span><i class="fa fa-th-large"></i></span> <span class="title">#title#</span></div><div class="close"><i class="fa fa-times-circle"></i></div></li>';a=t(i.replace("#taskid#","task-"+this.options.id).replace("#title#",this.options.title)),a.appendTo(o)}this.contextmenu(a),this.switchTask(a),this.tools.scrollTask(a),a.click(function(i){if(t(i.target).closest("div").hasClass("close")||t(i.target).hasClass("close"))a.dialog("close",e.options.id);else{var n=t("body").data("bjui.dialog"),o=n[e.options.id].dialog;a.hasClass("selected")?o.find(".dialogHeader a.minimize").trigger("click"):o.is(":hidden")?e.restoreDialog(o):(o.trigger("click"),a.addClass(d)),e.scrollCurrent(a)}return!1})},u.prototype.TOOLS=function(){var e={scrollCurrent:function(){var t=this.tasksW(this.getTasks());if(t>this.getTaskBarW()){var e=this,a=o.find("> li:last-child"),i=this.getTaskBarW()-a.position().left-a.outerWidth(!0);o.animate({left:i},200,function(){e.ctrlScrollBtn()})}else this.ctrlScrollBtn()},getTaskBarW:function(){return n.width()-(s.is(":hidden")?s.width()+2:0)-(r.is(":hidden")?r.width()+2:0)},scrollTask:function(t){var e=this;if(t.position().left+this.getLeft()+t.outerWidth()>this.getBarWidth()){var a=this.getTaskBarW()-t.position().left-t.outerWidth(!0)-2;o.animate({left:a},200,function(){e.ctrlScrollBtn()})}else if(t.position().left+this.getLeft()<0){var a=this.getLeft()-(t.position().left+this.getLeft());o.animate({left:a},200,function(){e.ctrlScrollBtn()})}},ctrlScrollBtn:function(){var t=this.tasksW(this.getTasks());this.getTaskBarW()>t?(n.removeClass(c),r.hide(),s.hide(),this.getTasks().eq(0).length&&this.scrollTask(this.getTasks().eq(0))):(n.addClass(c),r.show().removeClass(l),s.show().removeClass(l),this.getLeft()>=0&&s.addClass(l),this.getLeft()<=this.getTaskBarW()-t&&r.addClass(l))},getLeft:function(){return o.position().left},visibleStart:function(){for(var t=this.getLeft(),e=this.getTasks(),a=0;a<e.size();a++)if(e.eq(a).position().left+e.eq(a).outerWidth(!0)+t>=0)return e.eq(a);return e.eq(0)},visibleEnd:function(){for(var t=this.getLeft(),e=this.getTasks(),a=0;a<e.size();a++)if(e.eq(a).position().left+e.eq(a).outerWidth(!0)+t>this.getBarWidth())return e.eq(a);return e.eq(e.size()-1)},getTasks:function(){return o.find("> li")},tasksW:function(e){var a=0;return e.each(function(){a+=t(this).outerWidth(!0)}),a},getBarWidth:function(){return i.innerWidth()},getCurrent:function(){return o.find("li."+d)}};return e},u.prototype.contextmenu=function(e){var a=this;e.contextmenu({id:"dialogCM",bindings:{reload:function(t){t.dialog("refresh",a.options.id)},closeCurrent:function(t,e){var i=t.isTag("li")?t:a.tools.getCurrent();i.find(".close").trigger("click")},closeOther:function(e,a){var i=o.find("> li").not(e);i.each(function(e){t(this).find(".close").trigger("click")})},closeAll:function(e,i){var n=a.tools.getTasks();n.each(function(e){t(this).find(".close").trigger("click")})}},ctrSub:function(t,e){var i=e.find('[rel="closeCurrent"]'),n=e.find('[rel="closeOther"]');a.tools.getCurrent().length?1==a.tools.getTasks().size()&&n.addClass(l):(i.addClass(l),n.addClass(l))}})},u.prototype.closeDialog=function(t){var e="string"==typeof t?this.getTask(t):t;e&&e.length&&(e.remove(),this.tools.getTasks().size()||this.hide(),this.tools.scrollCurrent(),this.$element.removeData("bjui.taskbar"))},u.prototype.minimize=function(e){var i=this,n=t("body").data("bjui.dialog"),o="string"==typeof e?n[e].dialog:e,s=this.getTask(o.data("options").id);a.css({top:o.css("top"),left:o.css("left"),height:o.css("height"),width:o.css("width")}).show().animate({top:t(window).height()-60,left:s.position().left,width:s.outerWidth(),height:s.outerHeight()},250,function(){t(this).hide(),i.inactive(s)})},u.prototype.restoreDialog=function(e){var i=this.getTask(e.data("options").id);a.css({top:t(window).height()-60,left:i.position().left,height:i.outerHeight(),width:i.outerWidth()}).show().animate({top:e.css("top"),left:e.css("left"),width:e.css("width"),height:e.css("height")},250,function(){t(this).hide(),e.show().trigger("click.bjui.taskbar.restore")}),this.switchTask(i)},u.prototype.inactive=function(t){var e="string"==typeof t?this.getTask(t):t;e.removeClass(d)},u.prototype.scrollLeft=function(){var t=this.tools.visibleStart();this.tools.scrollTask(t)},u.prototype.scrollRight=function(){var t=this.tools.visibleEnd();this.tools.scrollTask(t)},u.prototype.scrollCurrent=function(t){this.tools.scrollTask(t)},u.prototype.switchTask=function(t){this.tools.getCurrent().removeClass(d);var e="string"==typeof t?this.getTask(t):t;e.addClass(d)},u.prototype.getTask=function(t){return o.find("#task-"+t)},u.prototype.changeTitle=function(t,e){var a=this.getTask(t);a&&e&&a.find(".title").html(e)},u.prototype.show=function(){i.is(":hidden")&&i.show().animate({bottom:0},500)},u.prototype.hide=function(){i.is(":visible")&&i.animate({bottom:-50},500,function(){i.hide()})};var p=t.fn.taskbar;t.fn.taskbar=e,t.fn.taskbar.Constructor=u,t.fn.taskbar.noConflict=function(){return t.fn.taskbar=p,this}}(jQuery),+function(t){"use strict";function e(e){var a=arguments,n=e,o="bjui.ajax",s=t("body");return this.each(function(){var r,l=t(this),d=t.extend({},i.DEFAULTS,"object"==typeof e&&e),c=l.data(o);c?this===s[0]?c=new i(this,d):t.extend(c.options,"object"==typeof e&&e):c=new i(this,d),l.data(o,c),"string"==typeof n&&(r=c[n.toLowerCase()],t.isFunction(r)&&([].shift.apply(a),a?r.apply(c,a):r()))})}var a,i=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS()};i.DEFAULTS={okalert:!0,reload:!0,loadingmask:!0,gridrefreshflag:!0},i.NAVTAB="navtab",i.prototype.TOOLS=function(){var t=this,e={getTarget:function(){return t.$element.closest(".navtab-panel").length?i.NAVTAB:"dialog"}};return e},i.prototype.ajaxdone=function(t){t[BJUI.keys.statusCode]==BJUI.statusCode.error?t[BJUI.keys.message]&&BJUI.alertmsg("error",t[BJUI.keys.message]):t[BJUI.keys.statusCode]==BJUI.statusCode.timeout?(BJUI.alertmsg("info",t[BJUI.keys.message]||BJUI.regional.sessiontimeout),BJUI.loadLogin()):t[BJUI.keys.message]&&BJUI.alertmsg("correct",t[BJUI.keys.message])},i.prototype.ajaxerror=function(t,e,a){var i=t.responseText,n=this,o=n.$element.data("bjui.ajax.options")||n.options,s=o.failCallback;"string"==typeof i&&i.startsWith("{")?this.ajaxdone(i.toObj()):BJUI.alertmsg("error","<div>Http status: "+t.status+" "+t.statusText+"</div><div>ajaxOptions: "+e+" </div><div>thrownError: "+a+" </div><div>"+i+"</div>"),s&&("string"==typeof s&&(s=s.toFunc()),"function"==typeof s?s.apply(n,[i,o]):BJUI.debug("The callback function 'failCallback' is incorrect: "+s))},i.prototype.ajaxcallback=function(e){var a=this,i=a.options,n=i.okCallback,o=i.errCallback,s=i.okAfterCallback,r=[],l=[],d=[],c=[],u=function(){"string"==typeof n&&(n=n.toFunc()),"function"==typeof n?n.apply(a,[e,i]):BJUI.debug("The callback function 'okCallback' is incorrect: "+n)},p=function(){"string"==typeof s&&(s=s.toFunc()),"function"==typeof s?s.apply(a,[e,i]):BJUI.debug("The callback function 'okAfterCallback' is incorrect: "+s)},h=function(){"string"==typeof o&&(o=o.toFunc()),"function"==typeof o?o.apply(a,[e,i]):BJUI.debug("The callback function 'errCallback' is incorrect: "+o)};if("string"==typeof e&&(e=e.toObj()),i.okalert&&a.ajaxdone(e),!e[BJUI.keys.statusCode]&&n)return void u();if(e[BJUI.keys.statusCode]==BJUI.statusCode.ok){if(n)return void u();e.tabid&&t.merge(r,e.tabid.split(",")),i.tabid&&t.merge(r,i.tabid.split(",")),e.dialogid&&t.merge(l,e.dialogid.split(",")),i.dialogid&&t.merge(l,i.dialogid.split(",")),e.divid&&t.merge(d,e.divid.split(",")),i.divid&&t.merge(d,i.divid.split(",")),e.datagrid&&t.merge(c,e.datagrid.split(",")),i.datagrid&&t.merge(c,i.datagrid.split(",")),r.length&&(t.unique(r),setTimeout(function(){BJUI.navtab("reloadFlag",r.join(","))},100)),l.length&&(t.unique(l),setTimeout(function(){BJUI.dialog("refresh",l.join(","))},100)),d.length&&(t.unique(d),setTimeout(function(){a.refreshdiv(d.join(","))},100)),c.length&&setTimeout(function(){t.each(c,function(e,a){t("#"+a.trim()).datagrid("refresh",i.gridrefreshflag)})},100),a.$target==t.CurrentNavtab?a.navtabcallback(e):a.$target==t.CurrentDialog?a.dialogcallback(e):a.divcallback(e),s&&p()}else o&&h()},i.prototype.divcallback=function(e,a,i){var n=this,i=n.options,o=e.forward||i.forward||null,s=e.forwardConfirm||i.forwardConfirm||null;if(i.reload&&!o&&n.refreshlayout(),i.reloadNavtab&&setTimeout(function(){BJUI.navtab("refresh")},100),o){var r=function(){t.extend(i,{url:o}),n.refreshlayout()};s?BJUI.alertmsg("confirm",s,{okCall:function(){r()}}):r()}},i.prototype.navtabcallback=function(t){var e=this,a=e.options,i=t.closeCurrent||a.closeCurrent||!1,n=t.forward||a.forward||null,o=t.forwardConfirm||a.forwardConfirm||null;if(i&&!n?BJUI.navtab("closeCurrentTab"):a.reload&&!n&&setTimeout(function(){BJUI.navtab("refresh")},100),n){var s=function(){BJUI.navtab("reload",{url:n})};o?BJUI.alertmsg("confirm",o,{okCall:function(){s()},cancelCall:function(){i&&BJUI.navtab("closeCurrentTab")}}):s()}},i.prototype.dialogcallback=function(t){var e=this,a=e.options,i=t.closeCurrent||a.closeCurrent||!1,n=t.forward||a.forward||null,o=t.forwardConfirm||a.forwardConfirm||null;if(i&&!n?BJUI.dialog("closeCurrent"):a.reload&&!n&&setTimeout(function(){BJUI.dialog("refresh")},100),a.reloadNavtab&&setTimeout(function(){BJUI.navtab("refresh")},100),n){var s=function(){BJUI.dialog("reload",{url:n})};o?BJUI.alertmsg("confirm",t.forwardConfirm,{okCall:function(){s()},cancelCall:function(){i&&BJUI.dialog("closeCurrent")}}):s()}},i.prototype.doajax=function(e){var a,n=this,o=n.$element;if(e||(e={}),e.loadingmask||(e.loadingmask=!1),e=t.extend({},i.DEFAULTS,"object"==typeof e&&e),n.options=e,e.target?a=e.target instanceof jQuery?e.target:t(e.target):o[0]!==t("body")[0]&&(a=o.closest(".bjui-layout")),a&&a.length||(a=t.CurrentDialog||t.CurrentNavtab),n.$target=a,!e.url)return void BJUI.debug("BJUI.ajax: 'doajax' method: the url is undefined!");if(e.url=decodeURI(e.url).replacePlh(a),!e.url.isFinishedTm())return BJUI.alertmsg("error",e.warn||BJUI.regional.plhmsg),void BJUI.debug("BJUI.ajax: 'doajax' method: The url is incorrect: "+e.url);e.url=encodeURI(e.url);var s=(e.callback&&e.callback.toFunc(),function(){e.callback||(e.callback=t.proxy(function(t){n.ajaxcallback(t)},n)),a.data("bjui.ajax.options",e).doAjax(e)});e.confirmMsg?BJUI.alertmsg("confirm",e.confirmMsg,{okCall:function(){s()}}):s()},i.prototype._ajaxform=function(e,a){var i,n=this,o=null,s=a.beforeSubmit,r=a.callback;if(!e.data("holdSubmit")){if(s){if("string"==typeof s&&(s=s.toFunc()),"function"!=typeof s)return void BJUI.debug("BJUI.ajax: 'ajaxform' options 'beforeSubmit': Not a function!");if(!s.apply(n,[e]))return}var l,d=e.find('input[data-toggle="webuploader"]'),c=!1;if(d.length&&WebUploader&&d.each(function(a,i){var n=t(this).data("webuploader"),o=t(this).data("webuploader.wrap").find(".filelist > li"),s=o.length,r=s-o.filter(".uploaded").length;return r&&n&&r!==n.getStats().successNum?(n.upload(),n.on("uploadFinished",function(){e.submit()}),c=!0,!1):n&&n.options.required&&!s?(l=n.options.requiredMsg||"请上传图片！",!1):void 0}),l)return void BJUI.alertmsg("info",l);if(c)return void BJUI.alertmsg("info","表单将在图片上传完成后自动提交！");i=e.attr("enctype"),a.target||(a.target=e.closest(".bjui-layout")),a.target&&(o=a.target,o instanceof jQuery||(o=t(o))),o&&o.length||(o=t.CurrentDialog||t.CurrentNavtab),n.$target=o,a.url=a.url||e.attr("action"),BJUI.isIE(8)&&!a.type&&(e[0].getAttributeNode("method").specified||(a.type="POST")),a.type=a.type||e.attr("method")||"POST",t.extend(n.options,a),r&&(r=r.toFunc());var u=function(a,i,o){r?r.apply(n,[a,e]):t.proxy(n.ajaxcallback(a),n)},p=function(){var a={loadingmask:n.options.loadingmask,type:n.options.type,url:n.options.url,callback:u};i&&"multipart/form-data"==i?window.FormData?t.extend(a,{data:new FormData(e[0]),contentType:!1,processData:!1}):t.extend(a,{data:e.serializeArray(),files:e.find(":file"),iframe:!0,processData:!1}):t.extend(a,{data:e.serializeArray()}),n.options.ajaxTimeout&&(a.ajaxTimeout=n.options.ajaxTimeout),e.doAjax(a)};n.options.confirmMsg?BJUI.alertmsg("confirm",n.options.confirmMsg,{okCall:p}):p()}},i.prototype.ajaxform=function(e){var a=this,i=t.extend({},"object"==typeof e&&e),n=a.$element,o=null,s={validClass:"ok",msgClass:"n-bottom",theme:"red_bottom_effect_grid"};return n[0]===t("body")[0]?(o=i.form,o instanceof jQuery||(o=t(i.form))):o=n,o&&o.length&&o.isTag("form")?("undefined"==typeof i.validate&&(i.validate=!0),void(t.fn.validator&&i.validate?(o.data("validator")||o.validator(s),o.on("valid.form",function(t){a._ajaxform(o,i)}).on("invalid.form",function(t,e,a){i.alertmsg&&BJUI.alertmsg("error",BJUI.regional.validatemsg.replaceMsg(a.length))}),o.trigger("validate")):a._ajaxform(o,i))):void BJUI.debug("BJUI.ajax: 'ajaxform' method: Not set the form!")},i.prototype._ajaxsearch=function(e,a){var i=this,n=null,o=a.beforeSubmit;a.callback;if(!e.data("holdSubmit")){if(o){if("string"==typeof o&&(o=o.toFunc()),"function"!=typeof o)return void BJUI.debug("BJUI.ajax: 'ajaxform' options 'beforeSubmit': Not a function!");if(!o.apply(i,[e]))return}if(e.data("bjui.paging")&&(a.data||(a.data={}),t.extend(a.data,e.data("bjui.paging"))),a.searchDatagrid){var s=a.searchDatagrid;return s instanceof jQuery||(s=t(s)),s&&s.length&&s.data("bjui.datagrid")?(e.data("holdSubmit",!0),s.datagrid("filter",e.serializeJson()),void s.on("afterLoad.bjui.datagrid",function(){e.data("holdSubmit",!1)})):void BJUI.debug("BJUI.ajax: 'ajaxsearch' method: The options 'searchDatagrid' is not incorrect!")}if(a.target||(a.target=e.closest(".bjui-layout")),a.target&&(n=a.target,n instanceof jQuery||(n=t(n))),n&&n.length||(n=t.CurrentDialog||t.CurrentNavtab),i.$target=n,a.url=a.url||e.attr("action"),BJUI.isIE(8)&&!a.type&&(e[0].getAttributeNode("method").specified||(a.type="POST")),a.type=a.type||e.attr("method")||"POST",!a.url)return void BJUI.debug("BJUI.ajax: 'ajaxsearch' method: The form's action or url is undefined!");if(a.url=decodeURI(a.url).replacePlh(e.closest(".unitBox")),!a.url.isFinishedTm())return BJUI.alertmsg("error",a.warn||BJUI.regional.plhmsg),void BJUI.debug("BJUI.ajax: 'ajaxsearch' method: The form's action or url is incorrect: "+a.url);if(a.url=encodeURI(a.url),t.extend(i.options,a),n.hasClass("bjui-layout")){var r=t.extend(e.serializeJson(),a.data);i.reloadlayout({target:n[0],type:i.options.type,url:i.options.url,data:r,loadingmask:i.options.loadingmask})}else a.form=e,n[0]===t.CurrentNavtab[0]?BJUI.navtab("reloadForm",i.options.clearQuery,a):BJUI.dialog("reloadForm",i.options.clearQuery,a)}},i.prototype.ajaxsearch=function(e){var a=this,i=t.extend({},"object"==typeof e&&e),n=a.$element,o=null,s={validClass:"ok",msgClass:"n-bottom",theme:"red_bottom_effect_grid"};return n[0]===t("body")[0]?(o=i.form,o instanceof jQuery||(o=t(i.form))):o=n,o&&o.length&&o.isTag("form")?("undefined"==typeof i.validate&&(i.validate=!0),void(t.fn.validator&&i.validate?(o.data("validator")||o.validator(s),o.on("valid.form",function(t){a._ajaxsearch(o,i)}).on("invalid.form",function(t,e,a){i.alertmsg&&BJUI.alertmsg("error",BJUI.regional.validatemsg.replaceMsg(a.length))}),o.trigger("validate")):a._ajaxsearch(o,i))):void BJUI.debug("BJUI.ajax: 'ajaxsearch' method: Not set the form!")},i.prototype.doload=function(e){var a=this,i=null,n=a.options;return t.extend(n,"object"==typeof e&&e),n.target&&(i=n.target,i instanceof jQuery||(i=t(i))),i&&i.length?n.url?(n.url=decodeURI(n.url).replacePlh(),n.url.isFinishedTm()?(n.url=encodeURI(n.url),i.removeData("bjui.clientPaging").data("options",n),void a.reloadlayout(n)):(BJUI.alertmsg("error",n.warn||BJUI.regional.plhmsg),void BJUI.debug("BJUI.ajax: 'doload' method: The url is incorrect: "+n.url))):void BJUI.debug("BJUI.ajax: 'doload' method: The url is undefined!"):void BJUI.debug("BJUI.ajax: 'doload' method: Not set loaded container, like [data-target].")},i.prototype.refreshlayout=function(e){var i,n=this;if(e?(i=e,i instanceof jQuery||(i=t(i))):i=n.$target,!i||!i.length)return a&&clearInterval(a),void BJUI.debug("BJUI.ajax: 'refreshlayout' method: No argument, can not refresh DIV.(parameters:[selector/jQuery object/element])");if(i&&i.length){if(!i.data("options"))return void BJUI.debug("BJUI.ajax: 'refreshlayout' method: The target(DIV) is not a reload layout!");i.removeData("bjui.clientPaging"),n.reloadlayout(i.data("options"))}},i.prototype.reloadlayout=function(e){var i=null,n=t.extend({},"object"==typeof e&&e),o=n&&n.autorefresh&&(isNaN(String(n.autorefresh))?15:n.autorefresh);return n.target&&(i=n.target,i instanceof jQuery||(i=t(i))),i&&i.length?i.data("options")?(n=t.extend({},i.data("options"),n),void i.addClass("bjui-layout").data("options",n).ajaxUrl({type:n.type,url:n.url,data:n.data,loadingmask:n.loadingmask,callback:function(t){BJUI.ui.clientPaging&&i.data("bjui.clientPaging")&&i.pagination("setPagingAndOrderby",i),n.callback&&n.callback.apply(this,[i,t]),a&&clearInterval(a),o&&(a=setInterval(function(){i.bjuiajax("refreshlayout",i)},1e3*o)),i.height()||i.css("position","static")}})):void BJUI.debug("BJUI.ajax: 'refreshlayout' method: This target(DIV) is not initialized!"):(a&&clearInterval(a),void BJUI.debug("BJUI.ajax: 'refreshlayout' method: Not set loaded container, like [data-target]."))},i.prototype.refreshdiv=function(t){if(t&&"string"==typeof t)for(var e=t.split(","),a=0;a<e.length;a++)this.refreshlayout("#"+e[a])},i.prototype.ajaxdownload=function(e){var a,i=this,n=t.extend({},{loadingmask:!1},"object"==typeof e&&e);if(t.extend(i.options,n),n.target&&(a=n.target,a instanceof jQuery||(a=t(a))),a&&a.length||(a=t.CurrentDialog||t.CurrentNavtab),i.$target=a,!n.url)return void BJUI.debug("BJUI.ajax: 'ajaxdownload' method: The url is undefined!");if(n.url=decodeURI(n.url).replacePlh(a),!n.url.isFinishedTm())return BJUI.alertmsg("error",n.warn||BJUI.regional.plhmsg),void BJUI.debug("BJUI.ajax: 'ajaxdownload' method: The url is incorrect: "+n.url);var o=function(){var e={};e.failCallback=function(t,e){t.trim().startsWith("{")&&(t=t.toObj()),i.ajaxdone(t),a.trigger("bjui.ajaxError")},e.prepareCallback=function(t){n.loadingmask&&a.trigger("bjui.ajaxStart")},e.successCallback=function(t){a.trigger("bjui.ajaxStop")},n.type&&!n.httpMethod&&(n.httpMethod=n.type),t.extend(e,n),e.data||(e.data={}),"undefined"==typeof e.data.ajaxrequest&&(e.data.ajaxrequest=!0),t.fileDownload(n.url,e)};n.confirmMsg?BJUI.alertmsg("confirm",n.confirmMsg,{okCall:function(){o()}}):o()};var n=t.fn.bjuiajax;t.fn.bjuiajax=e,t.fn.bjuiajax.Constructor=i,t.fn.bjuiajax.noConflict=function(){return t.fn.bjuiajax=n,this},BJUI.ajax=function(){e.apply(t("body"),arguments)},t(document).on(BJUI.eventType.initUI,function(e){t.fn.validator&&t(e.target).find('form[data-toggle="ajaxform"], form[data-toggle="ajaxsearch"]').each(function(){var e=t(this),a=e.data(),i=a.options,n={validClass:"ok",msgClass:"n-bottom",theme:"red_bottom_effect_grid"};i&&("string"==typeof i&&(i=i.toObj()),"object"==typeof i&&(delete a.options,t.extend(a,i))),"undefined"==typeof a.validate&&(a.validate=!0),a.validate||(n.ignore="*"),e.validator(n).on("valid.form",function(t){BJUI.ajax("_"+a.toggle,e,a)}).on("invalid.form",function(t,e,i){a.alertmsg&&BJUI.alertmsg("error",BJUI.regional.validatemsg.replaceMsg(i.length))})})}),t(document).on("submit.bjui.bjuiajax.data-api",'form[data-toggle="ajaxform"], form[data-toggle="ajaxsearch"]',function(a){if(!t.fn.validator){var i=t(this),n=i.data(),o=n.options;o&&("string"==typeof o&&(o=o.toObj()),"object"==typeof o&&(delete n.options,t.extend(n,o))),e.call(i,"_"+n.toggle,i,n),a.preventDefault()}}),t(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="ajaxload"]',function(a){var i=t(this),n=i.data(),o=n.options;o&&("string"==typeof o&&(o=o.toObj()),"object"==typeof o&&(delete n.options,t.extend(n,o))),n.url||(n.url=i.attr("href")),e.call(i,"doload",n),a.preventDefault()}),t(document).on(BJUI.eventType.initUI,function(a){t(a.target).find('[data-toggle="autoajaxload"]').each(function(){var a=t(this),i=$this.data(),n=i.options;n&&("string"==typeof n&&(n=n.toObj()),"object"==typeof n&&(delete i.options,t.extend(i,n))),i.target=this,e.call(a,"doload",i)})}),t(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="refreshlayout"]',function(a){var i=t(this),n=i.data("target");e.call(i,"refreshlayout",n),a.preventDefault()}),t(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="reloadlayout"]',function(a){var i=t(this),n=i.data();e.call(i,"reloadlayout",n),a.preventDefault()}),t(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doajax"]',function(a){var i=t(this),n=i.data(),o=n.options;o&&("string"==typeof o&&(o=o.toObj()),"object"==typeof o&&(delete n.options,t.extend(n,o))),n.url||(n.url=i.attr("href")),e.call(i,"doajax",n),a.preventDefault()}),t(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="ajaxdownload"]',function(a){var i=t(this),n=i.data(),o=n.options;o&&("string"==typeof o&&(o=o.toObj()),"object"==typeof o&&(delete n.options,t.extend(n,o))),n.url||(n.url=i.attr("href")),e.call(i,"ajaxdownload",n),a.preventDefault()})}(jQuery),+function(t){"use strict";function e(e){var a=arguments,i=e,n="bjui.alertmsg",s=t("body"),r=s.data(n);return this.each(function(){var l=(t(this),t.extend({},o.DEFAULTS,"object"==typeof e&&e));r?r.options=l:r=new o(l),s.data(n,r),"string"==typeof i&&t.isFunction(r[i])&&([].shift.apply(a),a?r[i].apply(r,a):r[i]())})}var a,i,n;t(function(){var e=function(){a=t(FRAG.alertBoxFrag).hide().html(""),i=t(FRAG.alertBackground).hide().html(""),t("body").append("<!-- alert msg box -->").append(a).append("<!-- alert msg box mask bg -->").append(i)};e()});var o=function(t){this.options=t,this.tools=this.TOOLS(),this.clearTime=null};o.DEFAULTS={displayPosition:"topcenter",displayMode:"slide",autoClose:null,alertTimeout:3e3,mask:null,promptRequired:"required",types:{error:"error",info:"info",warn:"warn",correct:"correct",confirm:"confirm",prompt:"prompt"},fas:{
error:"fa-times-circle",info:"fa-info-circle",warn:"fa-exclamation-circle",correct:"fa-check-circle",confirm:"fa-question-circle",prompt:"fa-paper-plane-o"}},o.prototype.TOOLS=function(){var e=this,o={getTitle:function(t){return e.options.title||BJUI.regional.alertmsg.title[t]},keydownOk:function(t){return t.which==BJUI.keyCode.ENTER?(t.data.target.trigger("click"),!1):!0},keydownEsc:function(t){t.which==BJUI.keyCode.ESC&&t.data.target.trigger("click")},openPosition:function(){var t=BJUI.alertMsg.displayPosition,i=BJUI.alertMsg.displayMode,n=460,o=a.outerHeight(),s={},r={};switch(t?e.options.displayPosition&&"topcenter"!=e.options.displayPosition&&(t=e.options.displayPosition):t=e.options.displayPosition,i?e.options.displayMode&&"slide"!=e.options.displayMode&&(i=e.options.displayMode):i=e.options.displayMode,t){case"topleft":s={top:0-o,left:0,"margin-left":0},r={top:0};break;case"topcenter":s={top:0-o},r={top:0};break;case"topright":s={top:0-o,left:"auto",right:0,"margin-left":0},r={top:0};break;case"middleleft":s={top:"50%",left:0-n,"margin-left":0,"margin-top":0-o/2},r={left:0};break;case"middlecenter":s={top:"0","margin-top":0-o/2},r={top:"50%"};break;case"middleright":s={top:"50%",left:"auto",right:0-n,"margin-top":0-o/2},r={right:0};break;case"bottomleft":s={top:"auto",left:0,bottom:0-o,"margin-left":0},r={bottom:0};break;case"bottomcenter":s={top:"auto",bottom:0-o},r={bottom:0};break;case"bottomright":s={top:"auto",left:"auto",right:0,bottom:0-o,"margin-left":0},r={bottom:0}}"slide"==i?a.css(s).show().animate(r,500):"fade"==i?(s.opacity=.1,a.css(s).css(r).show().animate({opacity:1},500)):a.css(s).css(r).show()},closePosition:function(){var n=BJUI.alertMsg.displayPosition,o=BJUI.alertMsg.displayMode,s=460,r=a.outerHeight(),l={};switch(n?e.options.displayPosition&&"topcenter"!=e.options.displayPosition&&(n=e.options.displayPosition):n=e.options.displayPosition,o?e.options.displayMode&&"slide"!=e.options.displayMode&&(o=e.options.displayMode):o=e.options.displayMode,n){case"topleft":l={top:0-r};break;case"topcenter":l={top:0-r};break;case"topright":l={top:0-r};break;case"middleleft":l={left:0-s};break;case"middlecenter":l={top:0-r};break;case"middleright":l={right:0-s};break;case"bottomleft":l={bottom:0-r};break;case"bottomcenter":l={bottom:0-r};break;case"bottomright":l={bottom:0-r}}"slide"==o?a.animate(l,500,function(){i.hide(),t(this).hide().empty()}):"fade"==o?a.animate({opacity:0},500,function(){i.hide(),t(this).hide().empty()}):(a.hide().remove(),i.hide())},open:function(o,s,r){var l,d,c=this,u="",p=BJUI.alertMsg.alertTimeout,h="";if(r)for(var g=0;g<r.length;g++){var f=r[g].call?"callback":"",m=r[g].cls?r[g].cls:"default",b=r[g].cls&&"green"==r[g].cls?"check":"close";u+=FRAG.alertBtnFrag.replace("#btnMsg#",'<i class="fa fa-'+b+'"></i> '+r[g].name).replace("#callback#",f).replace("#class#",m)}o==e.options.types.prompt&&(h='<p style="padding-top:5px;"><input type="text" class="form-control" name="'+(e.options.promptname||"prompt")+'" value=""></p>'),l=t(FRAG.alertBoxFrag.replace("#type#",o).replace("#fa#",e.options.fas[o]).replace("#title#",this.getTitle(o)).replace("#message#",s).replace("#prompt#",h).replace("#btnFragment#",u)).hide().appendTo("body"),a&&a.length&&a.remove(),a=l,c.openPosition(),n&&(clearTimeout(n),n=null),null==e.options.mask&&e.options.types.info!=o&&e.options.types.correct!=o&&i.show(),null==e.options.autoClose&&(e.options.types.info==o||e.options.types.correct==o)&&(p?e.options.alertTimeout&&3e3!=e.options.alertTimeout&&(p=e.options.alertTimeout):p=e.options.alertTimeout,n=setTimeout(function(){c.close()},p)),o==e.options.types.prompt&&a.find(":text").focus().val(e.options.promptval),d=a.find(".btn"),d.each(function(i){t(this).on("click",t.proxy(function(){(o!==e.options.types.prompt||d.eq(i).hasClass("btn-red"))&&e.tools.close();var t=r[i].call;if("string"==typeof t&&(t=t.toFunc()),"function"==typeof t)if(o==e.options.types.prompt){var n=a.find("input"),s=n.val();n.focus(function(){a.removeClass("has-error")}),"required"!==e.options.promptRequired||s?(e.tools.close(),t.call(e,s)):a.addClass("has-error")}else t.call()},e)),r[i].keyCode===BJUI.keyCode.ENTER&&t(document).on("keydown.bjui.alertmsg.ok",{target:d.eq(i)},c.keydownOk),r[i].keyCode===BJUI.keyCode.ESC&&t(document).on("keydown.bjui.alertmsg.esc",{target:d.eq(i)},c.keydownEsc)})},alert:function(a,i,n){t.extend(e.options,"object"==typeof n&&n);var o=t.extend({},{okName:BJUI.regional.alertmsg.btnMsg.ok,okCall:null},e.options),s=[{name:o.okName,call:o.okCall,cls:"default",keyCode:BJUI.keyCode.ENTER}];this.open(a,i,s)},close:function(){t(document).off("keydown.bjui.alertmsg.ok").off("keydown.bjui.alertmsg.esc"),this.closePosition()}};return o},o.prototype.error=function(t,e){this.tools.alert(this.options.types.error,t,e)},o.prototype.info=function(t,e){this.tools.alert(this.options.types.info,t,e)},o.prototype.warn=function(t,e){this.tools.alert(this.options.types.warn,t,e)},o.prototype.ok=function(t,e){this.tools.alert(this.options.types.correct,t,e)},o.prototype.correct=function(t,e){this.tools.alert(this.options.types.correct,t,e)},o.prototype.confirm=function(e,a){t.extend(this.options,"object"==typeof a&&a);var i=t.extend({},{okName:BJUI.regional.alertmsg.btnMsg.ok,okCall:null,cancelName:BJUI.regional.alertmsg.btnMsg.cancel,cancelCall:null},this.options),n=[{name:i.okName,call:i.okCall,cls:"green",keyCode:BJUI.keyCode.ENTER},{name:i.cancelName,call:i.cancelCall,cls:"red",keyCode:BJUI.keyCode.ESC}];this.tools.open(this.options.types.confirm,e,n)},o.prototype.prompt=function(e,a){t.extend(this.options,"object"==typeof a&&a);var i=this,n=t.extend({},{okName:BJUI.regional.alertmsg.btnMsg.ok,okCall:null,cancelName:BJUI.regional.alertmsg.btnMsg.cancel,cancelCall:null},this.options);null==n.okCall&&"object"==typeof i.options.prompt&&i.options.prompt&&(n.okCall=function(e){var a={};a[i.options.promptname||"prompt"]=e,i.options.prompt.data?t.extend(i.options.prompt.data,a):i.options.prompt.data=a,BJUI.ajax("doajax",i.options.prompt)});var o=[{name:n.okName,call:n.okCall,cls:"green",keyCode:BJUI.keyCode.ENTER},{name:n.cancelName,call:n.cancelCall,cls:"red",keyCode:BJUI.keyCode.ESC}];this.tools.open(this.options.types.prompt,e,o)};var s=t.fn.alertmsg;t.fn.alertmsg=e,t.fn.alertmsg.Constructor=o,t.fn.alertmsg.noConflict=function(){return t.fn.alertmsg=s,this},BJUI.alertmsg=function(){e.apply(t("body"),arguments)},t(document).on("click.bjui.alertmsg.data-api",'[data-toggle="alertmsg"]',function(a){var i,n=t(this),o=n.data(),s=o.options;return s&&("string"==typeof s&&(s=s.toObj()),"object"==typeof s&&t.extend(o,s)),(i=o.type)?(o.msg||s.msg&&(o.msg=s.msg),e.call(n,i,o.msg||i,o),void a.preventDefault()):!1})}(jQuery),+function(t){"use strict";function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),s=t.extend({},a.DEFAULTS,o.data(),"object"==typeof e&&e),r=o.data("bjui.pagination");r||o.data("bjui.pagination",r=new a(this,s)),"string"==typeof n&&t.isFunction(r[n])?([].shift.apply(i),i?r[n].apply(r,i):r[n]()):r.init()})}var a=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS()};a.DEFAULTS={width:"100%",pageSize:30,selectPageSize:"30,60,90",pageCurrent:1,total:0,showPagenum:5,form:null,callback:null},a.prototype.TOOLS=function(){var e=this,a={getPageCount:function(t,e){return Math.ceil(e/t)},getPageInterval:function(t,e,a){var i=Math.ceil(a/2),n=t-a,o=e>i?Math.max(Math.min(e-i,n),0):0,s=e>i?Math.min(e+i,t):Math.min(a,t);return s-o==a&&(s+=1),a>s&&(s+=1),o+1==s&&(s+=1),{start:o+1,end:s}},jumpPage:function(t,a){var i=e.options.callback;"string"==typeof i&&(i=i.toFunc()),t&&(e.options.pageCurrent=t),a&&(e.options.pageSize=a,e.pageCount=this.getPageCount(a,e.options.total),e.options.pageCurrent>e.pageCount&&(e.options.pageCurrent=e.pageCount)),i&&"function"==typeof i?i.call(e,e.options.pageCurrent,a):this.setPaging(e.options.pageCurrent,a,!0),e.$element.trigger("bjui.pagination.jump")},setPaging:function(a,i,n){var o=e.options.form,s={};if(o){if(o instanceof jQuery||(o=t(o)),!o||!o.length)return void BJUI.debug("BJUI.Pagination: The options 'form' is not incorrect!");s[BJUI.pageInfo.pageCurrent]=a,s[BJUI.pageInfo.pageSize]=i,o.data("bjui.paging",s),n&&o.trigger("submit")}}};return a},a.prototype.jumpPage=function(t,e){var a=this,i=a.options,n=a.pageCount;t&&isNaN(t)||e&&isNaN(e)||t&&(t=parseInt(t,10),1>t&&(t=1),t>n&&(t=n),t==i.pageCurrent)||(e&&(e=parseInt(e,10)),a.tools.jumpPage(t||i.pageCurrent,e||i.pageSize))},a.prototype.init=function(){var e,a=this,i=a.tools,n=a.options,o=BJUI.regional.pagination,s=FRAG.gridPaging,r=[],l=[],d=BJUI.StrBuilder();a.pageCount=i.getPageCount(n.pageSize,n.total),e=i.getPageInterval(a.pageCount,n.pageCurrent,n.showPagenum);for(var c=e.start;c<e.end;c++)r.push(FRAG.gridPageNum.replace("#num#",c).replace("#active#",n.pageCurrent==c?" active":""));s=BJUI.doRegional(s.replaceAll("#pageCurrent#",n.pageCurrent).replaceAll("#count#",n.total+"/"+parseInt(a.pageCount||0,10)),o),d.add('<div class="paging-content">').add('<span></span><div class="paging-pagesize"><button type="button" class="btn-default btn-refresh" title="'+o.refresh+'" data-icon="refresh"></button>').add('<select data-toggle="selectpicker"></select>').add("</div>").add('<div class="paging-box">').add(s.replace("#pageNumFrag#",r.join(""))).add("</div>").add("</div>"),a.$element.addClass("bjui-paging-box").html(d.toString()),a.$element.find("> .paging-content").width(n.width).initui(),i.setPaging(n.pageCurrent,n.pageSize);var u=a.$element.find("div.paging-pagesize > select"),p=a.$element.find("ul.pagination"),h=p.find("> li.page-total"),g=h.next(),f=g.next(),m=f.next(),b=m.nextAll(".page-next"),v=b.next(),y=function(){f.addClass("disabled"),m.addClass("disabled")},x=function(){f.removeClass("disabled"),m.removeClass("disabled")},k=function(){b.addClass("disabled"),v.addClass("disabled")},C=function(){b.removeClass("disabled"),v.removeClass("disabled")},j=function(){y(),C()},$=function(){x(),k()},w=function(e){u.empty(),e||(e=a.options.pageSize),l=n.selectPageSize.split(","),l.push(String(e)),t.unique(l).sort(function(t,e){return t-e});var i=[];t.each(l,function(t,e){i.push('<option value="'+e+'"'+(e==n.pageSize&&"selected")+">"+e+"/"+o.page+"</option>")}),u.html(i.join("")).selectpicker("refresh")};1==n.pageCurrent&&j(),n.pageCurrent==a.pageCount&&($(),1==n.pageCurrent&&y()),n.total||k(),w(),a.$element.on("click.bjui.pagination.pagenum","li.page-num",function(e){var i=t(this);i.hasClass("active")||a.jumpPage(i.text()),e.preventDefault()}).on("click.bjui.pagination.refresh","button.btn-refresh",function(){a.jumpPage()}).on("bjui.pagination.jump",function(t){for(var e=a.options.pageCurrent,o=i.getPageInterval(a.pageCount,e,n.showPagenum),s=[],r=o.start;r<o.end;r++)s.push(FRAG.gridPageNum.replace("#num#",r).replace("#active#",e==r?" active":""));p.find("> li.page-num").remove(),m.after(s.join("")),1==e?(j(),e==a.pageCount&&k(),a.options.total||k()):e==a.pageCount?$():(x(),C()),g.find("input").val(e),h.find("> span").html(a.options.total+"/"+a.pageCount)}).on("bjui.pagination.pageSize",function(t,e){w(e)}).on("change","div.paging-pagesize > select",function(){var e=t(this).val();a.pageCount=i.getPageCount(e,n.total),a.jumpPage(null,e)}),g.find("input").on("keyup",function(e){if(e.which===BJUI.keyCode.ENTER){var i=t(this).val();i&&a.jumpPage(i)}}),f.on("click",function(){a.options.pageCurrent>1&&a.jumpPage(1)}),m.on("click",function(){a.options.pageCurrent>1&&a.jumpPage(a.options.pageCurrent-1)}),b.on("click",function(){a.options.pageCurrent<a.pageCount&&a.jumpPage(a.options.pageCurrent+1)}),v.on("click",function(){a.options.pageCurrent<a.pageCount&&a.jumpPage(a.pageCount)})},a.prototype.destroy=function(){this.$element.removeData("bjui.pagination").empty()};var i=t.fn.pagination;t.fn.pagination=e,t.fn.pagination.Constructor=a,t.fn.pagination.noConflict=function(){return t.fn.pagination=i,this},t(document).on(BJUI.eventType.initUI,function(a){t(a.target).find('[data-toggle="pagination"]').each(function(){var a=t(this),i=a.data(),n=i.options;n&&("string"==typeof n&&(n=n.toObj()),"object"==typeof n&&(delete i.options,t.extend(i,n))),e.call(a,i)})})}(jQuery),+function($){"use strict";function LZ(t){return(0>t||t>9?"":"0")+t}function formatDate(t,e){e+="";var a,i="",n=0,o="",s="",r=t.getYear()+"",l=t.getMonth()+1,d=t.getDate(),c=t.getDay(),a=t.getHours(),u=t.getMinutes(),p=t.getSeconds(),h={};for(r.length<4&&(r=""+(r-0+1900)),h.y=""+r,h.yyyy=r,h.yy=r.substring(2,4),h.M=l,h.MM=LZ(l),h.MMM=MONTH_NAMES[l-1],h.NNN=MONTH_NAMES[l+11],h.d=d,h.dd=LZ(d),h.E=DAY_NAMES[c+7],h.EE=DAY_NAMES[c],h.H=a,h.HH=LZ(a),a?a>12?h.h=a-12:h.h=a:h.h=12,h.hh=LZ(h.h),a>11?h.K=a-12:h.K=a,h.k=a+1,h.KK=LZ(h.K),h.kk=LZ(h.k),a>11?h.a="PM":h.a="AM",h.m=u,h.mm=LZ(u),h.s=p,h.ss=LZ(p);n<e.length;){for(o=e.charAt(n),s="";e.charAt(n)==o&&n<e.length;)s+=e.charAt(n++);i+=null!=h[s]?h[s]:s}return i}function _isInteger(t){return new RegExp(/^\d+$/).test(t)}function _getInt(t,e,a,i){for(var n=i;n>=a;n--){var o=t.substring(e,e+n);if(o.length<a)return null;if(_isInteger(o))return o}return null}function parseDate(t,e){t+="",e+="";for(var a,i,n=0,o=0,s="",r="",l=new Date(1900,0,1),d=l.getYear(),c=l.getMonth()+1,u=1,p=l.getHours(),h=l.getMinutes(),g=l.getSeconds(),f="";o<e.length;){for(s=e.charAt(o),r="";e.charAt(o)==s&&o<e.length;)r+=e.charAt(o++);if("yyyy"==r||"yy"==r||"y"==r){if("yyyy"==r&&(a=4,i=4),"yy"==r&&(a=2,i=2),"y"==r&&(a=2,i=4),d=_getInt(t,n,a,i),null==d)return 0;n+=d.length,2==d.length&&(d=d>70?1900+(d-0):2e3+(d-0))}else if("MMM"==r||"NNN"==r){c=0;for(var m=0;m<MONTH_NAMES.length;m++){var b=MONTH_NAMES[m];if(t.substring(n,n+b.length).toLowerCase()==b.toLowerCase()&&("MMM"==r||"NNN"==r&&m>11)){c=m+1,c>12&&(c-=12),n+=b.length;break}}if(1>c||c>12)return 0}else if("EE"==r||"E"==r)for(var m=0;m<DAY_NAMES.length;m++){var v=DAY_NAMES[m];if(t.substring(n,n+v.length).toLowerCase()==v.toLowerCase()){n+=v.length;break}}else if("MM"==r||"M"==r){if(c=_getInt(t,n,r.length,2),null==c||1>c||c>12)return 0;n+=c.length}else if("dd"==r||"d"==r){if(u=_getInt(t,n,r.length,2),null==u||1>u||u>31)return 0;n+=u.length}else if("hh"==r||"h"==r){if(p=_getInt(t,n,r.length,2),null==p||1>p||p>12)return 0;n+=p.length}else if("HH"==r||"H"==r){if(p=_getInt(t,n,r.length,2),null==p||0>p||p>23)return 0;n+=p.length}else if("KK"==r||"K"==r){if(p=_getInt(t,n,r.length,2),null==p||0>p||p>11)return 0;n+=p.length}else if("kk"==r||"k"==r){if(p=_getInt(t,n,r.length,2),null==p||1>p||p>24)return 0;n+=p.length,p--}else if("mm"==r||"m"==r){if(h=_getInt(t,n,r.length,2),null==h||0>h||h>59)return 0;n+=h.length}else if("ss"==r||"s"==r){if(g=_getInt(t,n,r.length,2),null==g||0>g||g>59)return 0;n+=g.length}else if("a"==r){if("am"==t.substring(n,n+2).toLowerCase())f="AM";else{if("pm"!=t.substring(n,n+2).toLowerCase())return 0;f="PM"}n+=2}else{if(t.substring(n,n+r.length)!=r)return 0;n+=r.length}}if(n!=t.length)return 0;if(2==c)if(d%4==0&&d%100!=0||d%400==0){if(u>29)return 0}else if(u>28)return 0;return(4==c||6==c||9==c||11==c)&&u>30?0:(12>p&&"PM"==f?p=p-0+12:p>11&&"AM"==f&&(p-=12),new Date(d,c-1,u,p,h,g))}function replaceTmEval(data){return data.replace(RegExp("({[A-Za-z0-9_+-]*})","g"),function($1){return eval("("+$1.replace(/[{}]+/g,"")+")")})}var MONTH_NAMES=new Array("January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),DAY_NAMES=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat");Date.prototype.formatDate=function(t){return formatDate(this,t)},String.prototype.parseDate=function(t){return this.length<t.length&&(t=t.slice(0,this.length)),parseDate(this,t)},Date.prototype.formatDateTm=function(t){var e=this.getFullYear(),a=this.getMonth()+1,i=this.getDate(),n=t.replaceAll("%y",e).replaceAll("%M",a).replaceAll("%d",i);n=replaceTmEval(n);var o=1900,s=0,r=1,l=n.split("-");return l.length>0&&(o=l[0]),l.length>1&&(s=l[1]-1),l.length>2&&(r=l[2]),new Date(o,s,r).formatDate("yyyy-MM-dd")}}(jQuery),+function(t){"use strict";function e(e){var a=arguments,i=e;return this.each(function(){var n=t(this),o=t.extend({},x.DEFAULTS,n.data(),"object"==typeof e&&e),s=n.data("bjui.datepicker");s||n.data("bjui.datepicker",s=new x(this,o)),"string"==typeof i&&t.isFunction(s[i])?([].shift.apply(a),a?s[i].apply(s,a):s[i]()):s.init()})}var a,i,n,o,s,r,l,d,c,u,p,h,g,f,m,b,v,y;t(function(){var e=function(){var e=BJUI.regional.datepicker,x=FRAG.calendarFrag.replace("#close#",e.close).replace("#prev#",e.prev).replace("#next#",e.next).replace("#clear#",e.clear).replace("#ok#",e.ok);a=t(x).hide(),t("body").append("<!-- datepicker -->").append(a),i=a.find("> .main"),n=a.find("a.prev"),o=a.find("a.next"),s=a.find("select[name=year]"),r=a.find("select[name=month]"),l=a.find(".time"),d=l.find(":text"),c=l.find("ul > li"),u=l.find(".hh"),p=l.find(".mm"),h=l.find(".ss"),g=i.find("> .tm"),f=a.find(".close"),m=i.find("> .body > .days"),b=i.find("> .body > .dayNames"),v=a.find(".clearBtn"),y=a.find(".okBtn");var k="",C=BJUI.regional.datepicker;t.each(C.dayNames,function(t,e){k+="<dt>"+e+"</dt>"}),b.html(k),t.each(C.monthNames,function(t,e){var a=t+1;r.append('<option value="'+a+'">'+e+"</option>")}),a.on("selectstart",function(){return!1})};e()});var x=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS(),this.$dateBtn=null;var i=new Date;this.options.minDate=i.formatDateTm(this.options.minDate),this.options.maxDate=i.formatDateTm(this.options.maxDate),this.events={focus_time:"focus.bjui.datepicker.time",click_prev:"click.bjui.datepicker.prev",click_next:"click.bjui.datepicker.next",click_ok:"click.bjui.datepicker.ok",click_days:"click.bjui.datepicker.days",click_clear:"click.bjui.datepicker.clear",click_close:"click.bjui.datepicker.close",click_tm:"click.bjui.datepicker.tm",click_spinner:"click.bjui.datepicker.spinner",mousedown_sp:"mousedown.bjui.datepicker.spinner",mouseup_sp:"mouseup.bjui.datepicker.spinner",change_ym:"change.bjui.datepicker.ym",click_time:"click.bjui.datepicker.time",keydown_time:"keydown.bjui.datepicker.time",keyup_time:"keyup.bjui.datepicker.time"}};x.DEFAULTS={pattern:"yyyy-MM-dd",minDate:"1900-01-01",maxDate:"2099-12-31",mmStep:1,ssStep:1},x.EVENTS={afterChange:"afterchange.bjui.datepicker"},x.prototype.TOOLS=function(){var e=this,i={changeTmMenu:function(t){g.removeClass("hh").removeClass("mm").removeClass("ss"),t&&(g.addClass(t),d.removeClass("slt").filter("."+t).addClass("slt"))},clickTmMenu:function(a,i){g.find("> ul").hide().filter("."+i).show().find("> li").off(e.events.click_tm).on(e.events.click_tm,function(){var e=t(this),i=parseInt(e.text())<10?"0"+e.text():e.text();a.val(i)})},keydownInt:function(t){return t.keyCode>=48&&t.keyCode<=57||t.keyCode==BJUI.keyCode.DELETE||t.keyCode==BJUI.keyCode.BACKSPACE?void 0:!1},changeTm:function(t,e){var a=parseInt(t.val()),i=parseInt(t.data("start"))||0,n=parseInt(t.data("end")),o=parseInt(t.data("step")||1),s=e?e.data("add")?e.data("add"):-1:0,r=a;1==s?n-o>=a&&(r=a+o):-1==s?a>=i+o&&(r=a-o):a>n?r=n:i>a&&(r=i),10>r&&(r="0"+r),t.val(r)},closeCalendar:function(n){i.changeTmMenu(),n&&(t(document).off(e.events.click_close),a.hide())},get:function(t){return e.options[t]},getDays:function(t,e){return 2==e?t%4||!(t%100)&&t%400?28:29:/4|6|9|11/.test(e)?30:31},minMaxDate:function(t){var e=t.split("-").length-1,a="y-M-d";return 1==e?a="y-M":e||(a="y"),t.parseDate(a)},getMinDate:function(){return this.minMaxDate(e.options.minDate)},getMaxDate:function(){var t=e.options.maxDate,a=t.split("-").length-1,i=this.minMaxDate(t);if(2>a){var n=this.getDays(i.getFullYear(),i.getMonth()+1);i.setDate(n),a||i.setMonth(11)}return i},getDateWrap:function(t){t||(t=this.parseDate(e.sDate)||new Date);var a=t.getFullYear(),i=t.getMonth()+1,n=this.getDays(a,i);return{year:a,month:i,day:t.getDate(),hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds(),days:n,date:t}},changeDate:function(t,a,i){var n,i=(this.getDateWrap(),i||1);return n=new Date(t,a-1,i),n.getMonth()+1!=a&&(n=new Date(t,n.getMonth(),0),n.setMonth(a-1)),e.sDate=this.formatDate(n),n},changeDateTime:function(t,a,i,n,o,s){var r=new Date(t,a-1,i,n,o,s);return r.getMonth()+1!=a&&(r=new Date(t,r.getMonth(),0,n,o,s),r.setMonth(a-1)),e.sDate=this.formatDate(r),r},changeDay:function(t,e){e||(e=0);var a=this.getDateWrap();return this.changeDate(a.year,a.month+parseInt(e),t)},changeMonth:function(t){var e=s.get(0).selectedIndex,a=s.find("option").length,i=1*r.val()+t;i?13==i&&(e==a-1?i=12:(i=1,e++,s.get(0).selectedIndex=e)):e?(i=12,e--,s.get(0).selectedIndex=e):i=1,r.val(i).change()},parseDate:function(t){return t?t.parseDate(e.options.pattern):null},formatDate:function(t){return t.formatDate(e.options.pattern)},hasHour:function(){return-1!=e.options.pattern.indexOf("H")},hasMinute:function(){return-1!=e.options.pattern.indexOf("m")},hasSecond:function(){return-1!=e.options.pattern.indexOf("s")},hasTime:function(){return this.hasHour()||this.hasMinute()||this.hasSecond()},hasDate:function(){for(var t=["y","M","d","E"],a=0;a<t.length;a++)if(-1!=e.options.pattern.indexOf(t[a]))return!0;return!1},afterChange:function(t){var a=t?this.formatDate(t):"";e.$element.trigger(x.EVENTS.afterChange,{date:t,value:a}).trigger("change")}};return i},x.prototype.addBtn=function(){var e=this,a=e.$element,i=a.attr("size")?"":" fluid";if(!(a.data("nobtn")||this.$dateBtn||this.options.addbtn||a.parent().hasClass("wrap_bjui_btn_box"))){this.$dateBtn=t(FRAG.dateBtn),this.$element.css({paddingRight:"15px"}).wrap('<span class="wrap_bjui_btn_box'+i+'"></span>');var n=this.$element.parent(),o=this.$element.addClass("form-control").innerHeight();n.css({position:"relative",display:"inline-block"}),this.$dateBtn.css({height:o,lineHeight:o+"px"}).appendTo(n),this.$dateBtn.on("selectstart",function(){return!1})}},x.prototype.init=function(){if(this.$element.is(":text")){this.$element.val()&&(this.sDate=this.$element.val().trim());var e=this,a=this.options,i=this.tools,l=i.getDateWrap(),d=i.getMinDate(),c=i.getMaxDate(),g=d.getFullYear(),b=c.getFullYear();(!a.toggle||"datepicker"!==a.toggle&&!e.JSAPI)&&e.$element.data("JSAPI",!0),s.empty();for(var x=g;b>=x;x++)s.append('<option value="'+x+'"'+(l.year==x?" selected":"")+">"+x+"</option>");r.val(l.month),s.add(r).off(this.events.change_ym).on(this.events.change_ym,function(){if(i.hasTime()){var t=m.find(".slt"),a=i.changeDateTime(s.val(),r.val(),t.data("day"),l.hour,l.minute,l.second);e.create(i.getDateWrap(a),d,c)}else{var t=m.find(".slt"),a=i.changeDate(s.val(),r.val(),t.data("day"));e.create(i.getDateWrap(a),d,c)}}),n.off(this.events.click_prev).on(this.events.click_prev,function(){e.tools.changeMonth(-1)}),o.off(this.events.click_prev).on(this.events.click_prev,function(){e.tools.changeMonth(1)}),v.off(this.events.click_clear).on(this.events.click_clear,function(){e.$element.val(""),i.closeCalendar(!0),i.afterChange("")}),y.off(this.events.click_ok).on(this.events.click_ok,function(){var t=m.find("dd.slt");if(t.hasClass("disabled"))return!1;var a=i.changeDay(t.data("day"),t.data("month"));i.hasTime()&&(a.setHours(parseInt(u.val())),a.setMinutes(parseInt(p.val())),a.setSeconds(parseInt(h.val()))),i.closeCalendar(!0),e.$element.val(i.formatDate(a)).focus(),i.afterChange(a)}),f.off(this.events.click_close).on(this.events.click_close,function(){i.closeCalendar(!0)}),t(document).off(this.events.click_close).on(this.events.click_close,function(a){var n=t(a.target);a.target!=e.$element.get(0)&&(n.closest("#calendar").length||("datepicker"==n.data("toggle")||"datepickerbtn"==n.parent().data("toggle")||"datepickerbtn"==n.data("toggle")||n.data("JSAPI")?i.closeCalendar(!1):i.closeCalendar(!0)))}),e.dw=l,e.minDate=d,e.maxDate=c,e.$element.data("JSAPI")&&(a.nobtn||e.addBtn(),e.$element.off("click.bjui.datepicker.data-api").on("click.bjui.datepicker.data-api",t.proxy(function(t){e.create()},e)),a.nobtn||e.$element.parent(".wrap_bjui_btn_box").find('[data-toggle="datepickerbtn"]').off("click.bjui.datepicker.data-api").on("click.bjui.datepicker.data-api",t.proxy(function(t){e.create()},e)))}},x.prototype.create=function(e,n,o){e||(this.init(),e=this.dw,n=this.minDate,o=this.maxDate);var s=this,r=this.options,f=this.tools,b=new Date(e.year,e.month-1,1),v=b.getDay(),y="";if(v>0){b.setMonth(b.getMonth()-1);for(var x=f.getDateWrap(b),k=x.days-v+1;k<=x.days;k++){var C=new Date(e.year,e.month-2,k),j=C>=n&&o>=C?"":" disabled";y+='<dd class="other'+j+'" data-month="-1" data-day="'+k+'">'+k+"</dd>"}}for(var k=1;k<=e.days;k++){var C=new Date(e.year,e.month-1,k),j=C>=n&&o>=C?"":"disabled";k==e.day&&(j+=" slt"),y+='<dd class="'+j+'" data-day="'+k+'">'+k+"</dd>"}for(var k=1;k<=42-v-e.days;k++){var C=new Date(e.year,e.month,k),j=C>=n&&o>=C?"":" disabled";y+='<dd class="other'+j+'" data-month="1" data-day="'+k+'">'+k+"</dd>"}var $=m.html(y).find("dd");if($.not(".disabled").off(this.events.click_days).on(this.events.click_days,function(){var e=t(this);if(f.hasTime())$.removeClass("slt"),e.addClass("slt");else{var a=f.changeDay(e.data("day"),e.data("month"));f.closeCalendar(!0),s.$element.val(f.formatDate(a)).focus(),f.afterChange(a)}}),f.hasDate()?i.removeClass("nodate"):i.addClass("nodate"),f.hasTime()){l.show(),u.val(e.hour<10?"0"+e.hour:e.hour).off(this.events.focus_time).on(this.events.focus_time,function(){f.changeTmMenu("hh")});var w=parseInt(e.minute/r.mmStep)*r.mmStep;p.val(10>w?"0"+w:w).data("step",r.mmStep).off(this.events.focus_time).on(this.events.focus_time,function(){f.changeTmMenu("mm")}),h.val(f.hasSecond()?e.second<10?"0"+e.second:e.second:"00").data("step",r.ssStep).off(this.events.focus_time).on(this.events.focus_time,function(){f.changeTmMenu("ss")}),a.off("click").on("click",function(e){t(e.target).closest(".time").length||(g.find("> ul").hide(),f.changeTmMenu())}),d.off(this.events.keydown_time).on(this.events.keydown_time,f.keydownInt).each(function(){var e=t(this);e.off(s.events.keyup_time).on(s.events.keyup_time,function(){f.changeTm(e)})}).off(this.events.click_time).on(this.events.click_time,function(){f.clickTmMenu(t(this),t(this).data("type"))});var T=null;c.off(this.events.click_spinner).on(this.events.click_spinner,function(e){var a=t(this);d.filter(".slt").each(function(){f.changeTm(t(this),a)}),e.preventDefault()}).off(this.events.mousedown_sp).on(this.events.mousedown_sp,function(e){var a=t(this);T=setInterval(function(){d.filter(".slt").each(function(){f.changeTm(t(this),a)})},150)}).off(this.events.mouseup_sp).on(this.events.mouseup_sp,function(t){clearTimeout(T)}),u.prop("disabled",!f.hasHour()),p.prop("disabled",!f.hasMinute()),h.prop("disabled",!f.hasSecond())}else l.hide();this.show()},x.prototype.show=function(){var e=this.$element.offset(),i=e.top+this.$element.get(0).offsetHeight,n=e.left,o=a.outerHeight(!0),s=a.outerWidth(!0),r={};i>o&&i>t(window).height()-o&&(i=e.top-o),r.left=n,r.top=i,n>t(window).width()-s&&(a.css("left",""),delete r.left,r.right=10),a.css(r).show().click(function(t){t.stopPropagation()})};var k=t.fn.datepicker;t.fn.datepicker=e,t.fn.datepicker.Constructor=x,t.fn.datepicker.noConflict=function(){return t.fn.datepicker=k,this},t(document).on(BJUI.eventType.initUI,function(a){t(a.target).find('[data-toggle="datepicker"]').each(function(){var a=t(this);a.length&&(a.data("nobtn")||e.call(a,"addBtn"))})}),t(document).on("click.bjui.datepicker.data-api",'[data-toggle="datepickerbtn"]',function(a){var i=t(this).prevAll('[data-toggle="datepicker"]');i&&i.is(":text")&&(e.call(i,"create"),a.preventDefault())}),t(document).on("click.bjui.datepicker.data-api",'[data-toggle="datepicker"]',function(a){var i=t(this);i.data("onlybtn")||i.is(":text")&&(e.call(i,"create"),a.preventDefault())})}(jQuery),+function(t){"use strict";function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),s=t.extend({},a.DEFAULTS,o.data(),"object"==typeof e&&e),r=o.data("bjui.ajaxtab");r||o.data("bjui.ajaxtab",r=new a(this,s)),"string"==typeof n&&t.isFunction(r[n])?([].shift.apply(i),i?r[n].apply(r,i):r[n]()):r.init()})}var a=function(e,a){this.$element=t(e),this.options=a};a.DEFAULTS={url:void 0,target:void 0,reload:!1},a.prototype.init=function(){var t=this.options;if(!t.url)return void BJUI.debug("Ajaxtab Plugin: Error trying to open a tab, url is undefined!");if(t.url=decodeURI(t.url).replacePlh(this.$element.closest(".unitBox")),!t.url.isFinishedTm())return this.$element.alertmsg("error",t.warn||BJUI.regional.plhmsg),void BJUI.debug("Ajaxtab Plugin: The new ajaxtab's url is incorrect, url: "+t.url);if(t.url=encodeURI(t.url),!t.target)return void BJUI.debug("Ajaxtab Plugin: Attribute 'target' is not defined!");if(t.reload)this.load();else{var e=this.$element.data("bjui.ajaxtab.reload");e?this.$element.tab("show"):this.load()}},a.prototype.load=function(){var e=this.$element,a=this.options;t(a.target).ajaxUrl({url:a.url,data:{},callback:function(){e.data("bjui.ajaxtab.reload",!0).tab("show")}})};var i=t.fn.ajaxtab;t.fn.ajaxtab=e,t.fn.ajaxtab.Constructor=a,t.fn.ajaxtab.noConflict=function(){return t.fn.ajaxtab=i,this},t(document).on("click.bjui.ajaxtab.data-api",'[data-toggle="ajaxtab"]',function(a){var i=t(this),n=i.data();n.url||(n.url=i.attr("href")),e.call(i,n),a.preventDefault()})}(jQuery),+function(t){"use strict";function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),s=t.extend(!0,{},a.DEFAULTS,"object"==typeof e&&e),r=o.data("bjui.datagrid");r||o.data("bjui.datagrid",r=new a(this,s)),"string"==typeof n&&t.isFunction(r[n])?([].shift.apply(i),i?r[n].apply(r,i):r[n]()):r.init()})}var a=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS(),this.datanames={tbody:"bjui.datagrid.tbody.dom",td_html:"bjui.datagrid.td.html",changeData:"bjui.datagrid.tr.changeData"},this.classnames={s_checkbox:"datagrid-checkbox",s_linenumber:"datagrid-linenumber",s_edit:"datagrid-column-edit",s_lock:"datagrid-lock",s_menu:"datagrid-menu-box",s_filter:"datagrid-filter-box",s_showhide:"datagrid-showhide-box",th_cell:"datagrid-cell",th_menu:"datagrid-column-menu",btn_menu:"datagrid-column-menu-btn",th_col:"datagrid-col",th_field:"datagrid-col-field",th_sort:"datagrid-sortable",th_resize:"datagrid-resize-head",th_resizemark:"datagrid-column-resizemark",tr_child:"datagrid-child-tr",tr_edit:"datagrid-edit-tr",tr_add:"datagrid-add-tr",tr_selected:"datagrid-selected-tr",td_edit:"datagrid-edit-td",td_changed:"datagrid-changed",td_child:"datagrid-child-td",td_linenumber:"datagrid-linenumber-td",td_checkbox:"datagrid-checkbox-td",li_asc:"datagrid-li-asc",li_desc:"datagrid-li-desc",li_filter:"datagrid-li-filter",li_showhide:"datagrid-li-showhide",li_lock:"datagrid-li-lock",li_unlock:"datagrid-li-unlock"}};a.DEFAULTS={gridTitle:"",columns:null,data:null,dataUrl:null,updateRowUrl:null,postData:null,loadType:"POST",dataType:"json",local:"remote",fieldSortable:!0,filterThead:!0,sortAll:!0,filterAll:!0,filterMult:!0,initFilter:{},selectMult:!1,linenumberAll:!1,showLinenumber:!0,showCheckboxcol:!1,showChildcol:void 0,showEditbtnscol:!1,customEditbtns:{position:"after",buttons:null,width:0},showTfoot:!1,showToolbar:!1,showNoDataTip:!0,toolbarItem:"",toolbarCustom:"",columnResize:!0,columnMenu:!0,columnShowhide:!0,columnFilter:!1,columnLock:!0,paging:!0,pagingAlign:"center",keys:{gridChild:"gridChild",gridNumber:"gridNumber",gridCheckbox:"gridCheckbox",gridEdit:"gridEdit",gridIndex:"gridIndex",dropFlag:"dropFlag",treePTr:"datagrid.tree.parentTr",treePData:"datagrid.tree.parentData",childlen:"childlen",isExpand:"isExpand",isParent:"isparent"},hasChild:!1,childOptions:{width:"100%",height:"auto",paging:!1,columnMenu:!1,filterThead:!1,childUpdate:!1},isTree:!1,treeOptions:{keys:{key:"id",parentKey:"pid",childKey:"children",childLen:"childlen",isParent:"isparent",level:"level",order:"order",isExpand:"isExpand"},simpleData:!0,expandAll:!1,add:!0},dropOptions:{drop:!1,dropUrl:null,paging:!0,scope:"drop",beforeDrag:null,beforeDrop:null,afterDrop:"POST"},tdTemplate:"",editUrl:null,editCallback:null,
editMode:"inline",editDialogOp:null,editType:"POST",inlineEditMult:!0,saveAll:!0,addLocation:"first",delUrl:null,delType:"POST",delPK:null,delConfirm:!0,delCallback:null,jsonPrefix:"",contextMenuH:!0,contextMenuB:!1,templateWidth:600,flowLayoutWidth:0,dialogFilterW:360,hScrollbar:!1,fullGrid:!1,importOption:null,exportOption:null,beforeEdit:null,beforeDelete:null,beforeSave:null,afterSave:null,afterDelete:null},a.renderItem=function(e,a,i,n){if(!i||!i.length)return"";var o="";return t.each(i,function(t,a){if(n&&n.value){if(a[n.value]==e)return o=a[n.label],!1}else if("undefined"!=typeof a[e])return o=a[e],!1}),o},a.renderItemMulti=function(e,a,i,n){if(!i||!i.length)return"";var o=[],s="array"===t.type(e)?e:String(e).split(",");return t.each(i,function(e,a){t.each(s,function(t,e){if(n&&n.value){if(a[n.value]==e)return o.push(a[n.label]),!1}else if("undefined"!=typeof a[e])return o.push(a[e]),!1})}),o.join(",")},a.prototype.TOOLS=function(){var e=this,i=e.options,n={getPageCount:function(t,e){return Math.ceil(e/t)},getPageInterval:function(t,e,a){var i=Math.ceil(a/2),n=t-a,o=e>i?Math.max(Math.min(e-i,n),0):0,s=e>i?Math.min(e+i,t):Math.min(a,t);return s-o==a&&(s+=1),a>s&&(s+=1),o+1==s&&(s+=1),{start:o+1,end:s}},getRight:function(t){for(var a=0,i=t.data("index"),n=e.columnModel,o=i;o>=0;o--)a+=n[o].th.outerWidth();return a},getRight4Lock:function(a){var i=0,n=e.$lockTbody.find("> tr:first > td:eq("+a+")"),o=n&&n.prevAll().add(n);return o&&o.length||(o=e.$lockColgroupH.filter(":lt("+(a+1)+")")),o.each(function(){var e=t(this),a=e.is(":hidden")?0:e.outerWidth();i+=a}),i},beforeEdit:function(t,a){var n=i.beforeEdit;return n&&("string"==typeof n&&(n=n.toFunc()),"function"==typeof n)?n.call(e,t,a):!0},beforeSave:function(t,a){var n=i.beforeSave;return n&&("string"==typeof n&&(n=n.toFunc()),"function"==typeof n)?n.call(e,t,a):!0},afterSave:function(a,n){var o=i.afterSave,s=e.options.childUpdate,r=e.$element.data("bjui.datagrid.parent"),l=function(t){t.closest("table").datagrid("updateRow",t)};if(o&&("string"==typeof o&&(o=o.toFunc()),"function"==typeof o&&o.call(e,a,n)),a.each(function(){t(this).removeData("datagrid.addData")}),r&&s&&("string"==typeof s&&-1===s.indexOf("all")?n.addFlag&&-1!==s.indexOf("add")?l(r):-1!==s.indexOf("edit")&&l(r):l(r)),e.needfixedWidth&&(e.fixedWidth(),e.needfixedWidth=!1),"auto"===i.height){var d=e.$boxB.scrollTop();e.$boxB.scrollTop(5),e.$boxB.scrollTop()&&(e.fixedHeight(),e.$boxB.scrollTop(d))}e.$element.data("allData",e.allData)},afterDelete:function(){var t=i.afterDelete;t&&("string"==typeof t&&(t=t.toFunc()),"function"==typeof t&&t.call(e)),e.$element.data("allData",e.allData)},setColspan:function(t,e){t.colspan&&(t.colspan=t.colspan+e-1),t.index=t.index+e-1,t.parent&&this.setColspan(t.parent,e)},setOp:function(t){return t.name?(t.menu="undefined"==typeof t.menu?!0:t.menu,t.lock="undefined"==typeof t.lock?!0:t.lock,t.edit="undefined"==typeof t.edit?!0:t.edit,t.add="undefined"==typeof t.add?!0:t.add,t.quicksort="undefined"==typeof t.quicksort?!0:t.quicksort,t.quickfilter="undefined"==typeof t.quickfilter?!0:t.quickfilter,t.finalWidth="undefined"==typeof t.finalWidth?!1:t.finalWidth):t.menu=t.lock=t.edit=t.add=t.quickSort=t.quickfilter=!1,t.hide="undefined"==typeof t.hide?!1:t.hide,t},json2Array4Tree:function(e,a,i,n){if(!a)return[];i||(i=0);var o,s=e.key,r=(e.parentKey,e.childKey),l=e.childLen,d=e.level,c=e.isParent,u=[];if(a&&a.sort(function(t,a){return t[e.order]-a[e.order]}),t.isArray(a))for(var p=0,h=a.length;h>p;p++)o=t.extend({},a[p]),o[d]=i,u.push(o),o[r]&&(delete o[r],o[c]=!0,o[l]=a[p][r].length,n=o[s],u=u.concat(this.json2Array4Tree(e,a[p][r],o[d]+1,n)),n=null);else o=t.extend({},a),o[d]=i,u.push(o),o[r]&&(delete o[r],o[c]=!0,o[l]=a[r].length,n=o[s],u=u.concat(this.json2Array4Tree(e,a[r],o[d]+1)),n=null);return u},array2Json4Tree:function(e,a){var i=[],n=[],o=e.keys,s=o.key,r=o.parentKey,l=o.childKey;if(!t.isArray(a))return[a];for(var d=0,c=a.length;c>d;d++)n[a[d][s]]=a[d];for(var d=0,c=a.length;c>d;d++)a[d][r]&&a[d][s]!==a[d][r]?(n[a[d][r]]||(n[a[d][r]]=[]),n[a[d][r]][l]||(n[a[d][r]][l]=[]),n[a[d][r]][l].push(a[d])):i.push(a[d]);return i},createTrsByData:function(a,i){var o;e.$tbody||(e.$tbody=t("<tbody></tbody>")),a&&(o=a.list?a.list:a,e.paging.total=o.length||0,e.options.isTree&&(e.options.treeOptions.simpleData?(o=this.array2Json4Tree(e.options.treeOptions,o),o=this.json2Array4Tree(e.options.treeOptions.keys,o)):o=this.json2Array4Tree(e.options.treeOptions.keys,o)),o&&!t.isArray(o)&&(o=[o]),e.paging.total=o&&o.length||0,e.paging.total||(o=[]),"object"==typeof a&&e.paging.total&&(a[BJUI.pageInfo.total]&&(e.paging.total=parseInt(a[BJUI.pageInfo.total],10)),a[BJUI.pageInfo.pageSize]&&(i&&e.paging.pageSize!=a[BJUI.pageInfo.pageSize]&&e.$boxP&&e.$boxP.trigger("bjui.datagrid.paging.pageSize",a[BJUI.pageInfo.pageSize]),e.paging.pageSize=parseInt(a[BJUI.pageInfo.pageSize],10))),e.paging.pageCount=n.getPageCount(e.paging.pageSize,e.paging.total),e.paging.pageCurrent>e.paging.pageCount&&(e.paging.pageCurrent=e.paging.pageCount),e.paging.pageCurrent||(e.paging.pageCurrent=1),this.initTbody(o,i)),e.init_tbody||e.$tbody.appendTo(e.$tableB),e.init_thead||e.initThead()},initTbody:function(a,n){var o,s=this,r=e.allData,l=i.dataType||"json",d=e.columnModel,c=e.hiddenFields,u=(e.regional,[]),p=e.attach,h=e.paging,g=0,f=h.pageSize,m=e.options.keys,b=function(){if(l=l.toLowerCase(),a&&(r=e.allData=a),e.$element.data("allData",e.allData),r.length?"local"===i.local?(g=h.pageSize*(h.pageCurrent-1),f=g+h.pageSize,h.total!=r.length&&(h.total=r.length),g>r.length&&(g=h.pageSize*(h.pageCount-1))):r.length>h.pageSize&&(f=h.pageSize):f=0,f>r.length&&(f=r.length),"array"===l&&a&&a.length&&"array"===t.type(a[0])){var b,v=g,y=f,x=[];"local"===i.local&&(v=0,y=r.length);for(var k=v;y>k;k++)o={},b=0,t.each(r[k],function(e,a){var i,n=a;d[b]&&d[b][m.gridChild]&&b++,d[b]&&d[b][m.gridNumber]&&b++,d[b]&&d[b][m.gridCheckbox]&&b++,"string"==typeof n&&(n='"'+n+'"'),d[b]&&!d[b][m.gridEdit]?(i='{"'+d[b].name+'":'+n+"}",t.extend(o,JSON.parse(i))):(d[b]&&d[b][m.gridEdit]&&b++,b>=d.length&&c&&c[e-d.length]&&(i='{"'+c[e-d.length]+'":'+n+"}",t.extend(o,JSON.parse(i)))),b++}),x.push(o);r=e.allData=x}for(var k=g;f>k;k++)o=t.extend({},e.allData[k],p),"local"!==i.local||n||(o.bjui_local_index=k,e.allData[k].bjui_local_index=k),u.push(o);s.createTrs(u,n),e.data=u,e.$element.trigger("afterLoad.bjui.datagrid",{datas:u})};n&&e.$boxM?e.$boxM.show().trigger("bjui.ajaxStop").trigger("bjui.ajaxStart",[50,b]):b()},createTrs:function(a,n){var o=this,s=e.options.keys,r=e.columnModel,l=e.paging,d=[],c=BJUI.doRegional(FRAG.gridEditBtn,e.regional),u=BJUI.doRegional(FRAG.gridExpandBtn,e.regional),p=!1,h=e.options.customEditbtns,g=h.buttons;if(g&&("function"==typeof g&&(g=g.apply()),g&&("before"===h.position?c=g+c:"replace"===h.position?c=g:c+=g)),n&&(t.each(r,function(t,a){a.locked&&(e.colLock(a.th,!1),a.lock_refresh=!0)}),e.$tbody.find("> tr.datagrid-nodata").length&&(e.needfixedWidth=!0),e.$tbody.empty(),e.$lockTableH&&e.$lockTableH.empty(),e.$lockTableB&&e.$lockTableB.empty()),!a.length&&!n){var f={};f[r[0].name]="0",p=!0,a=[],a.push(f)}for(var m=0,b=a.length;b>m;m++){var v,y,x,k,C,j,$,w,T,I=a[m],B=r.length,D=B,U=i.linenumberAll?(l.pageCurrent-1)*l.pageSize+(m+1):m+1,J=[],_=BJUI.StrBuilder(),S=!1,F="",A=i.tdTemplate;I[s.gridNumber]=U,I[s.gridIndex]=m,e.options.hasChild&&e.options.childOptions&&(D-=1),e.options.showLinenumber&&(D-=1),e.options.showCheckboxcol&&(D-=1);for(var M=t.extend({},I),P=0;B>P;P++){if(v=r[P],y=v.name||"datagrid-noname",x=I[y],j="",$=[],k="",w="",T="",C=void 0,("undefined"==typeof x||"null"===x||null===x)&&(x=""),k=x,v.align&&(j=' align="'+v.align+'"'),v[s.gridChild]&&(x=u),v[s.gridCheckbox]&&(x='<div><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox" value="true"></div>'),v[s.gridEdit]&&(x=c,$.push(e.classnames.s_edit)),i.hScrollbar&&(v.width&&"auto"!==v.width||$.push("nowrap")),v[s.gridChild]&&$.push(e.classnames.td_child),v[s.gridNumber]&&$.push(e.classnames.td_linenumber),v[s.gridCheckbox]&&$.push(e.classnames.td_checkbox),$=$.length?$.join(" "):"",n&&v.hidden&&(w=' style="display:none;"'),v.items&&!v.render&&(v.attrs&&v.attrs.multiple?v.render=t.datagrid.renderItemMulti:v.render=t.datagrid.renderItem),v.render&&"string"==typeof v.render&&(v.render=v.render.toFunc()),v.render&&"function"==typeof v.render)if(v.items){"string"==typeof v.items&&(v.items.trim().startsWith("[")?v.items=v.items.toObj():v.items=v.items.toFunc()),e.renderTds||(e.renderTds=[]);var N=function(a,i,n,o){t.when(o.items.call(e)).done(function(t){o.items=t,e.delayRender--})};"function"==typeof v.items?(m||(e.delayRender||(e.delayRender=0),e.delayRender++,N(m*P,k,I,v)),v.delayRender=!0,e.renderTds.push({trindex:m,tdindex:P,label:k,data:I,render:v.render})):(delete v.delayRender,C=v.render.call(e,k,I,v.items,v.itemattr))}else C=v.render.call(e,k,I);if(i.isTree&&!S&&(v!==e.childColumn&&v!==e.linenumberColumn&&v!==e.checkboxColumn&&v!==e.editBtnsColumn||e.treeColumn)&&("string"==typeof i.isTree?v.name&&v.name===i.isTree&&(S=!0):S=!0,S&&(!e.treeColumn&&(e.treeColumn=v),v.hasTree=!0,!I[i.treeOptions.keys.level]&&(I[i.treeOptions.keys.level]=0),T=e.tools.createTreePlaceholder(I,C||x),j=' align="left"',$?$+=" datagrid-tree-td":$="datagrid-tree-td",F=' data-child="'+(I[i.treeOptions.keys.childLen]||0)+'" data-level="'+I[i.treeOptions.keys.level]+'" class="datagrid-tree-tr datagrid-tree-level-'+I[i.treeOptions.keys.level]+'"')),$&&($=' class="'+$+'"'),e.isTemplate){if(v.delayRender?delete M[v.name]:M[v.name]="undefined"==typeof C?x:C,!J[0]&&P==B-1){if(A&&"function"==typeof A&&(A=A.apply(e,[I])),A=e.tools.replacePlh4Template(A,M,!0),e.options.hasChild&&e.options.childOptions&&(w=e.childColumn.hidden?' style="display:none;"':"",J[0]=['<td data-title="..." align="center" class="datagrid-child-td"'+w+"><div>"+u+"</div></td>"]),e.options.showLinenumber){w=e.linenumberColumn.hidden?' style="display:none;"':"";var E=['<td data-title="No." align="center" class="datagrid-linenumber-td"'+w+">"+U+"</td>"];J[J.length]=E}if(e.options.showCheckboxcol){w=e.checkboxColumn.hidden?' style="display:none;"':"";var R=['<td data-title="Checkbox" align="center" class="datagrid-checkbox-td"'+w+'><div><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox" value="true"></div></td>'];J[J.length]=R}var O=['<td class="datagrid-template-td" colspan="'+D+'">'+A+"</td>"];J[J.length]=O,F=' class="datagrid-template-tr"'}}else _.add('<td data-title="'+v.label+'"').add(j).add($).add(w).add(">"),T?_.add(T):_.add("<div>").add("undefined"==typeof C?x:C).add("</div>"),_.add("</td>"),J.push(_.toString())}d.push("<tr"+F+">"+J.join("")+"</tr>"),p?(d=[],d.push(o.createNoDataTr(!0)||"")):d.push(o.createChildTr(null,I))}e.$tbody.html(d.join("")),n&&(e.initEvents(),i.editMode&&e.edit(),a.length||o.createNoDataTr(),e.$boxP&&e.$boxP.trigger("bjui.datagrid.paging.jump"),t.each(r,function(t,a){a.lock_refresh&&(e.colLock(a.th,!0),delete a.lock_refresh)}),setTimeout(function(){e.$tableB.initui(),e.$lockTableB&&e.$lockTableB.initui(),e.fixedHeight(),e.needfixedWidth&&(e.fixedWidth(),e.needfixedWidth=null),e.$boxM&&e.$boxM.trigger("bjui.ajaxStop").hide(),e.doInitFilter&&(e.tools.initFilter(),e.doInitFilter=void 0)},a.length+1))},coverTemplate:function(){var a,i=this,n=e.options,o=e.data,s=e.columnModel;e.isTemplate?(a=e.$grid.data("bjui.datagrid.trs.template"),a?(e.$tbody.html(a),e.initEvents(),n.editMode&&e.edit(),o.length||i.createNoDataTr(),e.$boxP&&e.$boxP.trigger("bjui.datagrid.paging.jump"),t.each(s,function(t,a){a.lock_refresh&&(e.colLock(a.th,!0),delete a.lock_refresh)}),setTimeout(function(){e.$tableB.initui(),e.$lockTableB&&e.$lockTableB.initui(),e.fixedHeight(),e.$boxM&&e.$boxM.trigger("bjui.ajaxStop").hide(),e.doInitFilter&&(e.tools.initFilter(),e.doInitFilter=void 0)},o.length+1)):i.createTrs(o,!0)):(a=e.$grid.data("bjui.datagrid.trs.normal"),a?(e.$tbody.html(a),e.initEvents(),n.editMode&&e.edit(),o.length||i.createNoDataTr(),e.$boxP&&e.$boxP.trigger("bjui.datagrid.paging.jump"),t.each(s,function(t,a){a.lock_refresh&&(e.colLock(a.th,!0),delete a.lock_refresh)}),setTimeout(function(){e.$tableB.initui(),e.$lockTableB&&e.$lockTableB.initui(),e.fixedHeight(),e.$boxM&&e.$boxM.trigger("bjui.ajaxStop").hide(),e.doInitFilter&&(e.tools.initFilter(),e.doInitFilter=void 0)},o.length+1)):this.createTrs(o,!0)),setTimeout(function(){e.initFixedW=!1,e.hasAutoCol=!0,e.fixedWidth(!0)},300)},replacePlh:function(t,e){return t.replace(/{\/?[^}]*}/g,function(t){var a=t.replace(/[{}]+/g,""),i=e[a];return("undefined"==typeof i||"null"===i||null===i)&&(i=""),i})},replacePlh4Template:function(t,e,a){return t.replace(/{#\/?[^}]*}/g,function(t){var i=t.replace(/[{#}]+/g,""),n=e[i];return a&&"undefined"==typeof n?t:(("undefined"==typeof n||"null"===n||null===n)&&(n=""),n)})},createNoDataTr:function(a){if(e.options.showNoDataTip){if(a)return'<tr class="datagrid-nodata"><td colspan="'+e.columnModel.length+'">'+("string"==typeof e.options.showNoDataTip?e.options.showNoDataTip:BJUI.getRegional("datagrid.noData"))+"</td></tr>";e.$tbody.find("> tr").length||t('<tr class="datagrid-nodata"></tr>').html('<td colspan="'+e.columnModel.length+'">'+("string"==typeof e.options.showNoDataTip?e.options.showNoDataTip:BJUI.getRegional("datagrid.noData"))+"</td>").appendTo(e.$tbody)}},createTreePlaceholder:function(t,a,i){var n=e.options.treeOptions.keys,o=BJUI.StrBuilder(),s=function(t){for(var e=[];t--;)e.push('<span class="datagrid-tree-indent"></span>');return e.join("")};return o.add('<div class="datagrid-tree-box">'),t[n.level]&&o.add(s(t[n.level])),o.add('<span class="datagrid-tree-switch'+("undefined"==typeof i||i?"":" collapsed")+'">'),t[n.isParent]&&("undefined"==typeof i?("undefined"==typeof t[n.isExpand]&&(t[n.isExpand]=!0),t[n.isExpand]||(e.collapseIndex||(e.collapseIndex=[]),e.collapseIndex.push(t.gridIndex)),o.add('<i class="fa fa-minus-square-o"></i>')):o.add('<i class="fa fa-'+(i?"minus":"plus")+'-square-o"></i>')),o.add("</span>").add('<span class="datagrid-tree-'+(t[n.isParent]?"branch":"leaf")+'"><i class="fa fa-'+(t[n.isParent]?"folder":"file")+'-o"></i></span>').add('<span class="datagrid-tree-title">').add(a).add("</span>").add("</div>"),o.toString()},createChildTr:function(n,o){if(!(n&&n.next()&&n.next().hasClass(e.classnames.tr_child))){if(i.hasChild&&i.childOptions&&i.childOptions.dataUrl){e.childOptions=t.extend(!0,{},a.DEFAULTS,i.childOptions);var s='<tr class="'+e.classnames.tr_child+'"><td colspan="'+e.columnModel.length+'" style="width:100%; padding:10px;"><table class="table-child"></table></td></tr>';if(!n||!n.length)return s;n.after(s)}return""}},getNoChildTrIndex:function(t){var a;if(isNaN(t)){if(!t||!t.length)return-1;a=t.index()}else a=parseInt(t,10);return e.options.hasChild&&e.options.childOptions&&(a=2*a),a},getNoChildDataIndex:function(t){var a;return a=isNaN(t)?this.getNoChildTrIndex(t):parseInt(t,10),-1===a?a:(e.options.hasChild&&e.options.childOptions&&(a/=2),a)},loadData:function(a,n){var o=this,s=i.dataUrl,r=i.dataType||"json";e.columnModel;e.$boxM&&e.$boxM.show().trigger("bjui.ajaxStart"),r=r.toLowerCase(),"array"===r&&(r="text"),i.postData&&("string"==typeof i.postData&&(i.postData.trim().startsWith("{")?i.postData=i.postData.toObj():i.postData=i.postData.toFunc()),"function"==typeof i.postData&&(i.postData=i.postData.apply()),"object"==typeof i.postData&&(a=a?t.extend({},i.postData,a):i.postData)),a=a||{},!a.pageSize&&i.paging&&(a.pageSize=e.paging.pageSize,a.pageCurrent=e.paging.pageCurrent),i.paging||(delete a.pageSize,delete a.pageCurrent),BJUI.ajax("doajax",{url:s,data:a,type:i.loadType,cache:i.cache||!1,dataType:r,okCallback:function(e){if("json"===r||"jsonp"===r)o.createTrsByData(e,n);else if("text"===r)"array"!==t.type(e)&&(e=[]),o.createTrsByData(e,n);else if("xml"===r){var a,i=[];t(e).find("row").each(function(){a={},t(this).find("cell").each(function(e){var i=t(this),n=i.text(),o=i.attr("name");a[o]=n}),i.push(a)}),i.length&&o.createTrsByData(i,n)}else BJUI.debug("BJUI.Datagrid: The options 'dataType' is incorrect!")},errCallback:function(t){t&&t[BJUI.keys.statusCode]?BJUI.alertmsg("error",t[BJUI.keys.message]||BJUI.getRegional("datagrid.errorData")):BJUI.alertmsg("warn",BJUI.getRegional("datagrid.errorData")),o.createTrsByData([],n)},failCallback:function(t){BJUI.alertmsg("warn",BJUI.getRegional("datagrid.failData")),o.createTrsByData([],n)}})},appendColumns:function(){e.childColumn={name:e.options.keys.gridChild,gridChild:!0,width:30,minWidth:30,label:"...",align:"center",menu:!1,edit:!1,quicksort:!1},e.linenumberColumn={name:e.options.keys.gridNumber,gridNumber:!0,width:"auto",minWidth:80,label:"No.",align:"center",menu:!1,edit:!1,quicksort:!1},e.checkboxColumn={name:e.options.keys.gridCheckbox,gridCheckbox:!0,width:30,minWidth:30,label:"Checkbox",align:"center",menu:!1,edit:!1,quicksort:!1},e.editBtnsColumn={name:e.options.keys.gridEdit,gridEdit:!0,width:e.options.customEditbtns.width,minWidth:110,label:"string"==typeof i.showEditbtnscol?i.showEditbtnscol:"Edit",align:"center",menu:!1,edit:!1,hide:!1,quicksort:!1}},setBoxbH:function(t){var a,n,o,s=t||e.boxH||i.height,r=0;100>s||(isNaN(s)&&("auto"===s?(n=e.$boxB.clone().height("").prependTo("body").find("> colgroup").remove().end(),o=n.outerHeight(),n.remove(),s=(e.$boxT?e.$boxT.outerHeight():0)+(e.$boxH?e.$boxH.outerHeight():0)+(e.$toolbar?e.$toolbar.outerHeight():0)+(e.$boxP?e.$boxP.outerHeight():0)+o+(e.$boxF?e.$boxF.outerHeight():0),i.maxHeight&&Number(i.maxHeight)<s&&(s=Number(i.maxHeight)),e.$grid.height(s),e.boxH=s):s=e.$grid.height()),e.$boxT&&(a=e.$boxT.outerHeight(),s-=a,r+=a),e.$toolbar&&(a=e.$toolbar.outerHeight(),s-=a,r+=a),e.$boxP&&(s-=e.$boxP.outerHeight()),e.$boxF&&(s-=e.$boxF.outerHeight()),r+=e.$tableH.outerHeight(),s-=e.$boxH.outerHeight(),0>s&&(s=0),e.$boxB.height(s),e.$boxM.height(s).css({top:r}),e.$lockB&&e.$lockB.height(s),e.$element.data("bjui.datagrid.parent")&&e.$element.data("bjui.datagrid.parent").closest("table").datagrid("fixedHeight"))},showSubMenu:function(a,i,n){var o,s,r,l=i.outerWidth(),d=n.data("width")||n.outerWidth(),c=e.$grid.height(),u=n.data("height"),p=e.$boxH.width(),h=function(a,i,n){o=i.offset().left-e.$grid.offset().left-1,r={left:"50%"},a.removeClass("active"),i.hasClass("position-right")||l+d>p-o?(n.css({left:"auto",right:"100%"}),r={right:"50%"}):n.css({left:"100%",right:"auto"}),r.opacity=.2,n.stop().animate(r,"fast",function(){t(this).hide()})};a.hover(function(){if(n.appendTo(a),a.hasClass(e.classnames.li_filter)&&n.is(":visible"))return!1;var t=a.siblings("."+e.classnames.li_filter);t.length&&t.hasClass("active")&&h(t,i,t.find("> ."+e.classnames.s_filter)),a.hasClass(e.classnames.li_showhide)&&(s=a.position().top+i.position().top,u>c-s&&(u>c&&(u=c,n.css("height",c)),n.css({top:-(u-(c-s))}))),o=i.offset().left-e.$grid.offset().left-1,r={left:"100%"},i.hasClass("position-right")||l+d>p-o?(n.css({left:"auto",right:"50%"}),r={right:"100%"}):n.css({left:"50%",right:"auto"}),r.opacity=1,a.addClass("active"),n.show().stop().animate(r,"fast")},function(){return a.hasClass(e.classnames.li_filter)?!1:void h(a,i,n)}),a.on("hidesubmenu.bjui.datagrid.th",function(e,a,i){h(t(this),a,i)})},locking:function(t){var a=t.data("index"),i=e.columnModel[a],n=i.lock,o=i.locked,s=e.$menu,r=s.find("> ul"),l=r.find("> li."+e.classnames.li_lock),d=l.next();o?(l.addClass("disable"),d.removeClass("disable")):(d.addClass("disable"),l.removeClass("disable")),n?(l.show().off("click").on("click",function(){l.hasClass("disable")||(s.hide().data("bjui.datagrid.menu.btn").removeClass("active"),e.colLock(t,!0))}),d.show().off("click").on("click",function(){d.hasClass("disable")||(s.hide().data("bjui.datagrid.menu.btn").removeClass("active"),e.colLock(t,!1))})):(l.hide().off("click"),d.hide().off("click"))},createShowhide:function(){var a;e.options.keys;e.$showhide||(e.col_showhide_count=e.columnModel.length,a=t('<ul class="'+e.classnames.s_showhide+'" role="menu"></ul>'),t.each(e.columnModel,function(i,n){e.tools.isGridModel(n)&&e.col_showhide_count--;var o=t(FRAG.gridShowhide.replaceAll("#index#",n.index).replaceAll("#label#",n.label||"")).attr("title",n.label||"").toggleClass("nodisable",!!e.tools.isGridModel(n)),s=function(i){o.click(function(){if(t(this).hasClass("disable"))return!1;var n=t(this),o=!n.find("i").hasClass("fa-check-square-o");i.index;n.toggleClass("datagrid-col-check").find("i").attr("class","fa fa"+(o?"-check":"")+"-square-o"),e.showhideColumn(i.th,o),e.tools.isGridModel(i)||(e.col_showhide_count=o?e.col_showhide_count+1:e.col_showhide_count-1),1==e.col_showhide_count?a.find("> li.datagrid-col-check").addClass("disable"):a.find("> li.disable").removeClass("disable"),a.find("> li.nodisable").removeClass("disable")})};s(n),o.appendTo(a),n.hide&&o.trigger("click")}),a.appendTo(e.$grid),a.data("width",a.outerWidth()).data("height",a.outerHeight()),e.$showhide=a)},showhide:function(t,a){var i=(e.options.keys,t.index),n=t.th,o=e.$tbody.find("> tr"),s=a?"":"none",r=function(t){var e=t.colspan;a?e++:e--,e?t.th.css("display",""):t.th.css("display","none"),t.th.attr("colspan",e),t.colspan=e,t.parent&&r(t.parent)};if("undefined"==typeof t.hidden&&(t.hidden=!1),t.hidden!==!a){if(t.hidden=!a,n.css("display",s),e.options.tdTemplate&&!this.isGridModel(t)){var l=o.eq(0).find("> td.datagrid-template-td").attr("colspan");l&&o.find("> td.datagrid-template-td").attr("colspan",parseInt(l,10)+(t.hidden?-1:1))}else o.find("> td:eq("+i+")").css("display",s);e.$colgroupH.find("> col").eq(i).css("display",s),e.$colgroupB.find("> col").eq(i).css("display",s),e.$thead.find("> tr.datagrid-filter > th:eq("+i+")").css("display",s),e.$boxF&&(e.$tableF.find("> thead > tr > th:eq("+i+")").css("display",s),e.$colgroupF.find("> col").eq(i).css("display",s)),t.calc&&e.$tfoot&&e.$tfoot.trigger("resizeH.bjui.datagrid.tfoot"),t.parent&&r(t.parent),e.$tbody.find("> tr."+e.classnames.tr_child+":visible > td table").trigger("bjui.datagrid.child.resize")}},isGridModel:function(t){var a=e.options.keys;return t&&"object"==typeof t?t[a.gridChild]||t[a.gridNumber]||t[a.gridCheckbox]||t[a.gridEdit]:!1},isGridData:function(t){var a=e.options.keys,i=!1;for(var n in a)if(a[n]===t){i=!0;break}return i},jumpPage:function(t,a){var n,o=e.allData;t&&(e.paging.oldPageCurrent=e.paging.pageCurrent,e.paging.pageCurrent=t),a&&(e.paging.oldPageSize=e.paging.pageSize,e.paging.pageSize=a,e.paging.pageCount=this.getPageCount(a,e.paging.total),e.paging.pageCurrent>e.paging.pageCount&&(e.paging.pageCurrent=e.paging.pageCount)),"remote"===i.local?(n=this.getRemoteFilterData(!0),this.loadData(n,!0)):this.initTbody(o,!0)},quickSort:function(a){if(e.isDom){if("local"===i.local)return;i.sortAll=!0}if(e.sortData||(e.sortData={}),e.$tbody.find("> tr."+e.classnames.tr_edit).length)return void e.$tbody.alertmsg("info",BJUI.getRegional("datagrid.editMsg"));var n,o,s=a.th,r=e.data,l=e.allData,d=a.name;a.type,e.$thead.find("> tr > th.datagrid-quicksort-th");d||(d="datagrid-noname");var c=function(){var a=[];return t.each(e.sortData,function(t,e){a.push(t+" "+e.direction)}),a},u=function(t,e){var a=function(t,a){function i(){var o=e[n].split(" "),s=o[0],r=o[1],l=typeof t[s],d=typeof a[s];return t[s]==a[s]&&n<e.length-1?(n++,i()):(l="number"===d)||(l="boolean"===d)?"asc"===r?t[s]-a[s]:a[s]-t[s]:"asc"===r?String(t[s]).localeCompare(a[s]):String(a[s]).localeCompare(t[s])}var n=0;return e&&e.length?i():t.bjui_local_index-a.bjui_local_index};t.sort(a)};i.fieldSortable?s.find("> div > .datagrid-label > i").remove():e.$thead.find("> tr:not(.datagrid-filter) > th > div > .datagrid-label > i").remove(),a.sortDesc?a.sortDesc=!1:(a.sortAsc?(o="desc",a.sortAsc=!1,a.sortDesc=!0):(o="asc",a.sortAsc=!0),s.find("> div > .datagrid-label").prepend('<i class="datagrid-sort-i fa fa-long-arrow-'+(a.sortAsc?"up":"down")+'"></i>')),o?e.sortData[d]?e.sortData[d].direction=o:e.sortData[d]={index:Object.keys(e.sortData).length,direction:o}:delete e.sortData[d],i.sortAll?"remote"===i.local?(n=e.$element.data("filterDatas")||{},n[BJUI.pageInfo.pageSize]=e.paging.pageSize,n[BJUI.pageInfo.pageCurrent]=e.paging.pageCurrent,o?(n[BJUI.pageInfo.orderField]=d,n[BJUI.pageInfo.orderDirection]=o):(n[BJUI.pageInfo.orderField]="",n[BJUI.pageInfo.orderDirection]=""),n.orders=c().join(","),e.orders={orders:n.orders},this.loadData(e.tools.getRemoteFilterData(!0),!0)):(u(l,c()),this.initTbody(l,!0)):(u(r,c()),this.createTrs(r,!0))},showFilterMsg:function(a){var i=e.$boxH.find(".datagrid-thead-dialog-filter-msg"),n=i.find("> .msg-filter"),o=BJUI.StrBuilder();n.html(""),a.length&&(t.each(a,function(t,a){if(!a)return!0;var i=(a.label,a.data.valA);("select"===a.model.type||"boolean"===a.model.type)&&(i=a.model.render.call(e,i,{},a.model.items,a.model.itemattr)),o.add("；").add(a.model.label+":"+i)}),o=o.toString(),o.length>1&&(o=o.substr(1)),n.html(o))},quickFilter:function(a,n){if(e.isDom){if("remote"!=i.local)return void BJUI.debug("BJUI.Datagrid: Please change the local option is remote!");if(!i.dataUrl)return void BJUI.debug("BJUI.Datagrid: Not Set the dataUrl option!")}var o,s=this,r=(a.th,e.data),l=e.allData,d=a.name,c=[],u=function(e,a,i,n){var o=!1;switch(e){case"=":o=String(a)===String(i);break;case"!=":o=String(a)!==String(i);break;case">":o=parseFloat(i)>parseFloat(a);break;case"<":o=parseFloat(i)<parseFloat(a);break;case"like":n&&"select"===n.type?(o=String(a)===String(i),n.attrs&&n.attrs.multiple&&t.isArray(a)&&String(i)&&t.each(String(i).split(","),function(e,i){return o=-1!=t.inArray(i,a),o?!1:void 0})):o=String(i).indexOf(String(a))>=0}return o},p=function(e,a){var i=function(e){var i=0;return t.each(a,function(t,a){var n=a.datas;return i++,n?(a.model.isFiltered=!0,a.model.th.trigger("filter.bjui.datagrid.th",[!0]),c[a.model.index]||(c[a.model.index]={model:a.model,data:a.datas}),void(n.andor?"and"===n.andor?u(n.operatorA,n.valA,e[t],a.model)&&u(n.operatorB,n.valB,e[t],a.model)&&i--:"or"===n.andor&&(u(n.operatorA,n.valA,e[t],a.model)||u(n.operatorB,n.valB,e[t],a.model))&&i--:n.operatorB?u(n.operatorB,n.valB,e[t],a.model)&&i--:u(n.operatorA,n.valA,e[t],a.model)&&i--)):(i--,a.model.isFiltered=!1,a.model.th.trigger("filter.bjui.datagrid.th",[!1]),a.model.$quickfilter&&a.model.$quickfilter.trigger("clearfilter.bjui.datagrid.thead"),!0)}),i?!1:!0};return t.grep(e,function(t,e){return i(t)})};e.filterDatas||(e.filterDatas={}),i.filterMult?e.filterDatas[d]={datas:n,model:a}:(e.filterDatas={},e.filterDatas[d]={datas:n,model:a}),"remote"!==i.local&&l&&(e.oldAllData?l=e.oldAllData.concat():e.oldAllData=l.concat()),i.filterAll?"remote"===i.local?s.loadData(s.getRemoteFilterData(!1,c),!0):(o=p(l,e.filterDatas),e.tools.showFilterMsg(c),e.paging.pageCurrent=1,e.paging.pageCount=this.getPageCount(e.paging.pageSize,o.length),this.initTbody(o,!0)):e.isDom?s.loadData(s.getRemoteFilterData(!1,c),!0):(e.oldData?r=e.oldData.concat():e.oldData=r.concat(),o=p(r,e.filterDatas),e.tools.showFilterMsg(c),this.createTrs(o,!0))},getRemoteFilterData:function(a,n){var o={};if(e.filterDatas&&!t.isEmptyObject(e.filterDatas)&&(t.each(e.filterDatas,function(t,e){return e.datas?(e.model.isFiltered=!0,e.model.th.trigger("filter.bjui.datagrid.th",[!0]),i.jsonPrefix&&(t=i.jsonPrefix+"."+t),e.datas.andor&&(o.andor=e.datas.andor),e.datas.operatorA&&(o[t]=e.datas.valA,o[t+".operator"]=e.datas.operatorA),void(e.datas.operatorB&&(o[t]?(o[t]=[o[t],e.datas.valB],o[t+".operator"]=[o[t+".operator"],e.datas.operatorB]):(o[t]=e.datas.valB,o[t+".operator"]=e.datas.operatorB)))):(e.model.isFiltered=!1,e.model.th.trigger("filter.bjui.datagrid.th",[!1]),e.model.$quickfilter&&e.model.$quickfilter.trigger("clearfilter.bjui.datagrid.thead"),n&&n[e.model.index]&&(n[e.model.index]=!1),!0)}),a||(e.paging.pageCurrent=1)),e.initFilter){var s=i.jsonPrefix?i.jsonPrefix+".":"";t.each(e.initFilter,function(t,a){e.filterDatas&&"undefined"!=typeof e.filterDatas[t]||(o[s+t]=a.value)})}return o[BJUI.pageInfo.pageSize]=e.paging.pageSize,o[BJUI.pageInfo.pageCurrent]=e.paging.pageCurrent||1,t.extend(o,e.orders||{}),e.$element.data("filterDatas",o),o},setDomData:function(a){var i=e.columnModel,n={},o=a.attr("data-hidden-datas"),s=e.attach;return a.find("> td").each(function(e){var a=t(this),o=i[e],s=a.attr("data-val")||a.text();o.name?n[o.name]=s:n["datagrid-noname"+e]=s}),o&&(o=o.toObj()),s[e.options.keys.gridNumber]=a.index()+1,t.extend(n,s,o),a.data("initData",n),n},updateLinenumber:function(){if(-1!=t.inArray(e.linenumberColumn,e.columnModel)){var a=!1;e.linenumberColumn.locked&&(e.colLock(e.linenumberColumn.th,!1),a=!0),e.$tbody.find("> tr:not(."+e.classnames.tr_child+")").each(function(a){var i=t(this);i.find("> td."+e.classnames.td_linenumber).text(a+1)}),a&&e.colLock(e.linenumberColumn.th,!0)}},updateGridIndex:function(){var a=e.paging,i=e.options,n=(a.pageCurrent-1)*a.pageSize;t.each(e.data,function(t,e){var a=i.linenumberAll?n+(t+1):t+1;e[i.keys.gridNumber]=a,e[i.keys.gridIndex]=t})},initFilter:function(a,i){var n=e.initFilter,o=function(t,a){if(t.val(String(e.options.initFilter[a.name])),e.$headFilterUl){var i=e.$headFilterUl.find("> li.li-"+a.index+"> "+t[0].tagName);i.length&&(i.val(t.val()),i.isTag("select")&&i.selectpicker("refresh"))}"remote"===e.options.local?(a.isFiltered=!0,a.th.trigger("filter.bjui.datagrid.th",[!0])):e.tools.quickFilter(a,{operatorA:"like",valA:e.options.initFilter[a.name]})};return a||i?(n||(n={}),void(i&&(o(a,i),n[i.name]||(n[i.name]={},n[i.name].input=a,n[i.name].model=i,n[i.name].value=e.options.initFilter[i.name]),e.initFilter=n))):void(n&&t.each(n,function(t,e){o(e.input,e.model)}))},initEditInputs:function(){var a=e.columnModel;return e.inputs=[],t.each(a,function(a,i){var n=i.name,o="",s="",r=[],l="";if(i)if(i.attrs&&"object"==typeof i.attrs&&t.each(i.attrs,function(t,e){"object"==typeof e&&(e=JSON.stringify(e).replaceAll('"',"'")),l+=" "+t+"="+e}),i===e.childColumn||i===e.linenumberColumn||i===e.checkboxColumn||i===e.editBtnsColumn)e.inputs.push("");else if(n)if(i.rule?o=' data-rule="'+i.label+"："+i.rule+'"':"date"===i.type&&(o=' data-rule="pattern('+(i.pattern||"yyyy-MM-dd")+')"'),i.type)switch(i.type){case"date":i.pattern||(i.pattern="yyyy-MM-dd"),s=' data-pattern="'+i.pattern+'"',e.inputs.push('<input type="text" name="'+n+'" data-toggle="datepicker"'+s+o+l+">");break;case"select":if(!i.items)return;t.each(i.items,function(e,a){i.itemattr?r.push('<option value="'+a[i.itemattr.value]+'">'+a[i.itemattr.label]+"</option>"):t.each(a,function(t,e){r.push('<option value="'+t+'">'+e+"</option>")})}),e.inputs.push('<select name="'+n+'" data-toggle="selectpicker"'+o+l+' data-width="100%">'+r.join("")+"</select>");break;case"boolean":e.inputs.push('<input type="checkbox" name="'+n+'" data-toggle="icheck"'+o+l+' value="true">');break;case"findgrid":e.inputs.push('<input type="text" name="'+n+'" data-toggle="findgrid" data-custom-event="true"'+o+l+">");break;case"tags":e.inputs.push('<input type="text" name="'+n+'" data-toggle="tags"'+l+">");break;case"spinner":e.inputs.push('<input type="text" name="'+n+'" data-toggle="spinner"'+o+l+">");break;case"textarea":e.inputs.push('<textarea data-toggle="autoheight" rows="1"'+o+l+"></textarea>");break;default:e.inputs.push('<input type="text" name="'+n+'"'+o+l+">")}else e.inputs.push('<input type="text" name="'+n+'"'+o+l+">");else e.inputs.push("")}),e.inputs},contextmenuH:function(){var a=this;e.$tableH.on("contextmenu","tr:not(.datagrid-filter)",function(i){e.$showhide||a.createShowhide();var n=i.pageX,o=i.pageY,s=t(window).height(),r=e.$showhide.data("height");t(window).width()<n+e.$showhide.width()&&(n-=e.$showhide.width()),(0>o||o+r>s)&&(o=0),r>s?e.$showhide.css({height:s}):e.$showhide.css({height:""}),e.$menu&&e.$grid.trigger("click.bjui.datagrid.filter"),e.$showhide.appendTo("body").css({left:n,top:o,opacity:1,"z-index":9999}).show(),t(document).on("click",function(a){var i=t(a.target).closest("."+e.classnames.s_showhide);i.length||e.$showhide.css({left:"50%",top:0,opacity:.2,"z-index":""}).hide().appendTo(e.$grid)}),i.preventDefault(),
i.stopPropagation()})},contextmenuB:function(t,a){t.contextmenu("show",{exclude:"input, .bootstrap-select",items:[{icon:"refresh",title:BJUI.getRegional("datagrid.refresh"),func:function(t,a){e.refresh()}},{title:"diver"},{icon:"plus",title:BJUI.getRegional("datagrid.add"),func:function(t,a){e.add()}},{icon:"edit",title:BJUI.getRegional("datagrid.edit"),func:function(t,i){var n=t;a&&(n=e.$tbody.find("> tr:eq("+n.index()+")")),e.doEditRow(n)}},{icon:"undo",title:BJUI.getRegional("datagrid.cancel"),func:function(t,i){var n=t;a&&(n=e.$tbody.find("> tr:eq("+n.index()+")")),n.hasClass(e.classnames.tr_edit)||(n=e.$tbody.find("> tr."+e.classnames.tr_edit)),e.doCancelEditRow(n)}},{icon:"remove",title:BJUI.getRegional("datagrid.del"),func:function(t,i){var n=t;a&&(n=e.$tbody.find("> tr:eq("+n.index()+")")),e.delRows(n)}}]})}};return n},a.prototype.init=function(){if(this.$element.isTag("table")&&!this.$element.data("bjui.datagrid.init")){this.$element.data("bjui.datagrid.init",!0);var e=this,a=e.options,i=a.keys,n=e.tools,o=(e.$element.parent(),BJUI.StrBuilder());if(a.tableWidth=a.tableWidth||"",a.width=a.width||"100%",a.height=a.height||"auto",e.isDom=!1,e.columnModel=[],e.inputs=[],e.regional=BJUI.regional.datagrid,o.add('<div class="bjui-datagrid">').add(a.gridTitle?'<div class="datagrid-title">'+a.gridTitle+"</div>":"").add(a.showToolbar?'<div class="datagrid-toolbar"></div>':"").add('<div class="datagrid-box-h"><div class="datagrid-wrap-h"><table class="table table-bordered"><colgroup></colgroup></table></div></div>').add('<div class="datagrid-box-b"><div class="datagrid-wrap-b"></div></div>').add('<div class="datagrid-box-m"></div>').add(a.paging?'<div class="datagrid-paging-box bjui-paging-box"></div>':"").add("</div>"),e.$grid=t(o.toString()).insertAfter(e.$element).css("height",a.height),e.$boxH=e.$grid.find("> div.datagrid-box-h"),e.$boxB=e.$boxH.next(),e.$boxM=e.$boxB.next().css("height",a.height),e.$boxP=a.paging?e.$boxM.next():null,e.$boxT=a.gridTitle?e.$grid.find("> div.datagrid-title"):null,e.$toolbar=a.showToolbar?e.$boxH.prev():null,e.$tableH=e.$boxH.find("> div > table"),e.$tableB=e.$element,e.isTemplate=a.tdTemplate&&a.templateWidth&&a.templateWidth>e.$grid.width()||a.tdTemplate&&!a.templateWidth,e.$grid.data("bjui.datagrid.table",e.$element.clone()),e.$boxB.find("> div").append(e.$element),e.initTop(),"string"==typeof a.paging&&(a.paging=a.paging.toObj()),e.paging=t.extend({},{pageSize:30,selectPageSize:"30,60,90",pageCurrent:1,total:0,showPagenum:5},"object"==typeof a.paging&&a.paging),e.$thead=e.$element.find("> thead"),e.$tbody=e.$element.find("> tbody"),e.attach={},e.attach[i.gridNumber]=0,e.attach[i.gridCheckbox]="#checkbox#",e.attach[i.gridEdit]="#edit#",e.$tbody&&e.$tbody.find("> tr").length)e.isDom=!0,e.setColumnModel(),e.$tbody.find("> tr > td").each(function(){var e=t(this),a=e.html();e.html("<div>"+a+"</div>")}),e.paging.total?e.paging.pageCount=n.getPageCount(e.paging.pageSize,e.paging.total):(e.paging.total=e.$tbody.find("> tr").length,e.paging.pageCount=1),e.paging.pageCurrent=1,e.initThead();else{if(e.$tbody=null,e.$element.find("> tbody").remove(),a.columns)"string"==typeof a.columns&&(a.columns.trim().startsWith("[")?a.columns=a.columns.toObj():a.columns=a.columns.toFunc()),"function"==typeof a.columns&&(a.columns=a.columns.call()),e.$thead=null,e.$element.find("> thead").remove(),e.createThead();else{if(!(e.$thead&&e.$thead.length&&e.$thead.find("> tr").length))return BJUI.debug("BJUI.Datagrid: No set options 'columns' !"),void e.destroy();e.setColumnModel()}a.data||a.dataUrl?e.createTbody():(BJUI.debug("BJUI.Datagrid: No options 'data' or 'dataUrl'!"),e.destroy())}}},a.prototype.setColumnModel=function(){var e=this,a=e.options,i=e.$thead.find("> tr"),n=[],o=[],s=i.length;if(!e.isDom){e.tools.appendColumns();var r,l=s>1?' rowspan="'+s+'"':"";a.showCheckboxcol&&(e.columnModel.push(e.checkboxColumn),"lock"===a.showCheckboxcol&&(e.checkboxColumn.initLock=!0),r=t('<th class="'+e.classnames.td_checkbox+'"'+l+'><input type="checkbox" data-toggle="icheck"></th>'),r.prependTo(i.first()),l&&r.data("datagrid.column",e.checkboxColumn)),a.showLinenumber&&(e.columnModel.unshift(e.linenumberColumn),"lock"===a.showLinenumber&&(e.linenumberColumn.initLock=!0),r=t('<th class="'+e.classnames.td_linenumber+'"'+l+">No.</th>"),r.prependTo(i.first()),l&&r.data("datagrid.column",e.linenumberColumn)),(a.showChildcol||void 0===a.showChildcol&&a.hasChild&&a.childOptions)&&(e.columnModel.unshift(e.childColumn),r=t('<th class="'+e.classnames.td_child+'"'+l+">...</th>"),r.prependTo(i.first()),l&&r.data("datagrid.column",e.childColumn)),a.showEditbtnscol&&(r=t("<th"+l+">"+e.editBtnsColumn.label+"</th>"),r.appendTo(i.first()),l&&r.data("datagrid.column",e.editBtnsColumn),e.columnModel[r.index()]=e.editBtnsColumn)}i.length&&1==s?i.find("> th").each(function(i){var n=t(this).addClass("single-row").data("index",i),o=n.data("options"),s=n.attr("width")||"auto",r=n.html();e.columnModel.length&&e.columnModel[i]?(o=e.columnModel[i],o.index=i):(o&&"string"==typeof o&&(o=o.toObj()),"object"!=typeof o&&(o={}),o.index=i,o.label=r,o.width="undefined"==typeof o.width?s:o.width,o=e.tools.setOp(o),e.columnModel[i]=o),e.columnModel[i].th=n,n.html('<div><div class="datagrid-space"></div><div class="datagrid-label">'+r+'</div><div class="'+e.classnames.th_cell+'"><div class="'+e.classnames.th_resizemark+'"></div></div></div>'),o.menu&&a.columnMenu&&n.addClass(e.classnames.th_menu),a.fieldSortable&&o.quicksort&&n.addClass("datagrid-quicksort-th"),o.align&&n.attr("align",o.align)}):i.each(function(i){var s=[],r=[],l=-1,d=0;n.length&&(s=n.concat(),r=o.concat()),n=[],o=[],t(this).find("> th").each(function(i){var c=t(this),u=c.data("options")||c.data("datagrid.column")||{},p=parseInt(c.attr("colspan")||0,10),h=parseInt(c.attr("rowspan")||0,10),g=c.attr("width")||"auto",f=c.html();if(u&&"string"==typeof u&&(u=u.toObj()),"object"!=typeof u&&(u={}),BJUI.isIE(8)&&1===p&&(p=0),u.label=f,u.th=c,u[a.keys.gridCheckbox]&&(u.label="Checkbox"),l++,p){u.colspan=p;for(var m=s.length?s[l]:l,b=m;m+p>b;b++)n[d++]=b,o[d-1]=u;l+=p-1,c.data("index",l),s.length&&(u.parent=r[l])}h&&1!=h||c.addClass("single-row"),p?c.html('<div><div class="datagrid-space"></div><div class="datagrid-label">'+f+'</div><div class="'+e.classnames.th_cell+'"><div class="'+e.classnames.th_resizemark+'"></div></div></div>'):(u.width="undefined"==typeof u.width?g:u.width,u=e.tools.setOp(u),c.html('<div><div class="datagrid-space"></div><div class="datagrid-label">'+f+'</div><div class="'+e.classnames.th_cell+'"><div class="'+e.classnames.th_resizemark+'"></div></div></div>'),u.menu&&a.columnMenu&&c.addClass(e.classnames.th_menu),a.fieldSortable&&u.quicksort&&c.addClass("datagrid-quicksort-th"),u.align&&c.attr("align",u.align),s.length?(u.index=s[l],u.parent=r[l],e.columnModel[s[l]]=u):(u.index=l,e.columnModel[l]=u),c.data("index",u.index))})})},a.prototype.createThead=function(){var e,a,i,n,o,s,r,l=this,d=l.options,c=d.keys,u=d.columns.concat(),p=[],h=function(e,a,i,n){return a||(a=[]),i||(i=0),a[i]||(a[i]=[]),t.each(e,function(t,e){var o,s=a[i].length;return n&&(e.parent=n),e.columns?(o=e.columns.length,i&&e.parent&&l.tools.setColspan(e.parent,o),e.index=l.columnModel.length+o-1,e.colspan=o,e.quicksort=!1,a[i][s++]=e,h(e.columns,a,i+1,e)):(e.rowspan=i,e.index=l.columnModel.length,e=l.tools.setOp(e),a[i][s++]=e,l.columnModel.push(e),void 0)}),a};l.tools.appendColumns(),d.showCheckboxcol&&(u.unshift(l.checkboxColumn),"lock"===d.showCheckboxcol&&(l.checkboxColumn.initLock=!0)),d.showLinenumber&&(u.unshift(l.linenumberColumn),"lock"===d.showLinenumber&&(l.linenumberColumn.initLock=!0)),(d.showChildcol||void 0===d.showChildcol&&d.hasChild&&d.childOptions)&&u.unshift(l.childColumn),d.showEditbtnscol&&u.push(l.editBtnsColumn),p=h(u,p),l.columnModel[l.columnModel.length-(d.showEditbtnscol?2:1)].lock=!1,d.hiddenFields&&(l.hiddenFields=d.hiddenFields),l.$thead=t("<thead></thead>"),t.each(p,function(u,h){var g,f=t('<tr style="height:25px;"></tr>');t.each(h,function(u,h){e=h.label||h.name,a=h.align?' align="'+h.align+'"':"",i=h.width?' width="'+h.width+'"':"",n=h.colspan?' colspan="'+h.colspan+'"':"",o=p.length-h.rowspan>1?' rowspan="'+(p.length-h.rowspan)+'"':"",s='<div class="'+l.classnames.th_resizemark+'"></div>',r="",h[c.gridCheckbox]&&(e='<input type="checkbox" data-toggle="icheck">'),h.colspan&&(a=' align="center"'),h.thalign&&(a=' align="'+h.thalign+'"'),h.menu&&d.columnMenu&&(r=' class="'+l.classnames.th_menu+'"'),g=t("<th"+r+i+a+n+o+'><div><div class="datagrid-space"></div><div class="datagrid-label">'+e+'</div><div class="'+l.classnames.th_cell+'">'+s+"</div></div></th>"),g.data("index",h.index).appendTo(f),o||g.addClass("single-row"),h[c.gridChild]&&g.addClass(l.classnames.td_child),h[c.gridNumber]&&g.addClass(l.classnames.td_linenumber),h[c.gridCheckbox]&&g.addClass(l.classnames.td_checkbox),d.fieldSortable&&h.quicksort&&g.addClass("datagrid-quicksort-th"),h.th=g}),f.appendTo(l.$thead)}),l.$thead.appendTo(l.$element).initui()},a.prototype.createTbody=function(){var e=this,a=e.options,i=a.data;e.columnModel;if(i)"string"==typeof i&&(i=i.trim().startsWith("[")||i.trim().startsWith("{")?i.toObj():i.toFunc()),"function"==typeof i&&(i=i.call()),a.data=i,e.tools.createTrsByData(i);else if(a.dataUrl){var i={};"object"==typeof a.initFilter&&a.initFilter&&a.jsonPrefix&&t.each(a.initFilter,function(t,e){i[a.jsonPrefix+"."+t]=e}),e.$element.data("filterDatas",i),e.tools.loadData(i)}},a.prototype.refresh=function(e){var a=this,i=a.options,n=a.tools,o=(a.isDom,BJUI.pageInfo),s=a.paging,r={};return i.dataUrl?(i.postData&&i.postData[o.pageSize]||(r[o.pageSize]=s.pageSize,r[o.pageCurrent]=s.pageCurrent),i.initFilter&&"object"==typeof i.initFilter&&("object"==typeof i.initFilter&&i.initFilter&&i.jsonPrefix&&t.each(i.initFilter,function(t,e){r[i.jsonPrefix+"."+t]=e}),a.doInitFilter=!0),e&&t.extend(r,a.$element.data("filterDatas")||{}),n.loadData(r,!0),void(e||(a.filterDatas=null,t.each(a.columnModel,function(t,e){e.th.trigger("filter.bjui.datagrid.th",[!1]),e.isFiltered=!1,e.$quickfilter&&e.$quickfilter.trigger("clearfilter.bjui.datagrid.thead")}),a.orders={},a.$thead.find("> tr > th.datagrid-quicksort-th").find("> div > .datagrid-label > i").remove()))):i.data&&i.data.length?void n.initTbody(a.allData,!0):void BJUI.debug("BJUI.Datagrid: Not Set the dataUrl option!")},a.prototype.refreshParent=function(t){var e=this,a=e.$element.data("bjui.datagrid.parent");a&&a.length&&a.closest("table").datagrid("refresh",t)},a.prototype.refreshChild=function(e,a){var i,n=this,o=n.$tbody.find("> tr"),s=function(t){i=t.data("bjui.datagrid.child"),i&&i.length&&i.isTag("table")&&i.datagrid("refresh",a)};e instanceof jQuery?e.each(function(){s(t(this))}):isNaN(e)?t.each(e.split(","),function(t,e){2*e<o.length&&s(o.eq(2*e))}):2*e<o.length&&s(o.eq(2*e))},a.prototype.showChild=function(e,a,i){"undefined"==typeof a&&(a="toggle");var n,o,s,r,l,d,c,u=this,p=(u.options,u.$tbody.find("> tr:not(."+u.classnames.tr_child+")")),h=function(){u.fixedWidth(),u.fixedHeight()},g=function(t,e,a){if(u.$lockTableB){var i=u.$lockTableB.find("> tbody > tr:eq("+t+")");i.toggle(e),a?i.height(a):i.height()||i.height(n.height())}},f=function(e,a,n){o.find("> div").html(BJUI.doRegional(FRAG.gridShrinkBtn,u.regional)),a.fadeIn("normal",function(){n.data("bjui.datagrid.init")?(h(),g(r,!0),i&&i.apply(u,[n])):(d=t.extend(!0,{},u.childOptions),c=d.dataUrl,l=u.isDom?e.data("initData")||u.tools.setDomData(e):u.data[u.tools.getNoChildDataIndex(e.index())],c&&!c.isFinishedTm()&&(c=u.tools.replacePlh(c,l),c.isFinishedTm()?d.dataUrl=c:BJUI.debug("BJUI.Datagrid: The datagrid options 'childOptions' in the 'dataUrl' options is incorrect: "+c)),n.datagrid(d).data("bjui.datagrid.parent",e).on("completed.bjui.datagrid",t.proxy(function(){h(),g(r,!0,a.outerHeight()),i&&i.apply(u,[n])},u)).on("bjui.datagrid.child.resize",function(){n.datagrid("fixedWidth").datagrid("fixedHeight")}),e.data("bjui.datagrid.child",n))})},m=function(t,e,a){e.fadeOut("normal",function(){o.find("> div").html(BJUI.doRegional(FRAG.gridExpandBtn,u.regional)),h(),g(r,!1),i&&i.apply(u,[a])})},b=function(t){n=t.next("."+u.classnames.tr_child),n&&n.length&&(o=t.find("> td."+u.classnames.td_child),r=n.index(),s=n.find("> td").find("table.table-child"),s&&s.length&&(a&&"toggle"===a?n.is(":hidden")?f(t,n,s):m(t,n,s):a?f(t,n,s):m(t,n,s)))};if(i&&("string"==typeof i&&(i=i.toFunc()),"function"!=typeof i&&(i=!1)),e instanceof jQuery)e.each(function(){b(t(this))});else if(isNaN(e))t.each(e.split(","),function(t,e){var a=p.eq(parseInt(e.trim(),10));a&&a.length&&b(a)});else if(!isNaN(e)){var v=p.eq(e);v&&v.length&&b(v)}},a.prototype.updateRow=function(e,a){var i,n,o,s,r=this,l=r.options,d=function(a,i){if(t.extend(n,"object"==typeof i&&i),r.dialogEditComplete(a,n),n["refresh.datagrid.child"]){var o=a.data("bjui.datagrid.child");o&&o.length?o.datagrid("refresh"):r.showChild(e)}if("auto"===l.height){var s=r.$boxB.scrollTop();r.$boxB.scrollTop(5),r.$boxB.scrollTop()&&(r.fixedHeight(),r.$boxB.scrollTop(s))}};if(e instanceof jQuery)s=e;else{if(isNaN(e))return void BJUI.debug("BJUI.Datagrid: Func 'updateRow', Parameter 'row' is incorrect!");s=r.$tbody.find("> tr:not(."+r.classnames.tr_child+")").eq(parseInt(e,10))}if(r.isDom?n=s.data("initData")||r.tools.setDomData(s):(i=r.tools.getNoChildDataIndex(s.index()),n=r.data[i]),a){if("string"==typeof a&&(a=a.trim().startsWith("{")?a.toObj():a.toFunc()),"function"==typeof a&&(a=a.apply()),"object"!=typeof a&&!l.updateRowUrl)return void BJUI.debug("BJUI.Datagrid: Func 'updateRow', Parameter 'updateData' is incorrect!");d(s,a)}else l.updateRowUrl?(o=r.tools.replacePlh(l.updateRowUrl,n),o.isFinishedTm()?BJUI.ajax("doajax",{url:o,type:l.loadType,okCallback:function(t){d(s,t)}}):BJUI.debug("BJUI.Datagrid: The datagrid options 'updateRowUrl' is incorrect!")):BJUI.debug("BJUI.Datagrid: The datagrid options 'updateRowUrl' is not set!")},a.prototype.doAjaxRow=function(t,e){var a,i,n,o,s=this;s.options;if(t instanceof jQuery)a=t;else{if(isNaN(t))return void BJUI.debug("BJUI.Datagrid: Func 'doAjaxRow', Parameter 'row' is incorrect!");a=s.$tbody.find("> tr:not(."+s.classnames.tr_child+")").eq(parseInt(t,10))}"object"==typeof e&&e.url?("undefined"==typeof e.reload&&(e.reload=!1),e.callback||e.okCallback||(e.okCallback=function(t,e){s.updateRow(a,"object"==typeof t&&!t[BJUI.keys.statusCode]&&t)}),s.isDom?i=a.data("initData")||s.tools.setDomData(a):(n=s.tools.getNoChildDataIndex(a.index()),i=s.data[n]),o=e.url,o=!i||i.addFlag?o.replace(/{\/?[^}]*}/g,""):s.tools.replacePlh(o,i),o.isFinishedTm()||BJUI.debug("BJUI.Datagrid: Func 'doAjaxRow', options 'url' is incorrect: "+o),e.url=o,e.loadingmask=!0,e.target=s.$boxB,BJUI.ajax("doajax",e)):BJUI.debug("BJUI.Datagrid: Func 'doAjaxRow', options is incorrect or the property 'url' is not set!")},a.prototype.filter=function(e){var a=this,i=a.options,n=a.$tbody.find("> tr.datagrid-nodata").length;e&&"object"==typeof e&&((e.clearOldPostData||!i.postData)&&(i.postData={}),t.extend(i.postData,e)),a.paging.pageCurrent=1,a.refresh(),n&&a.$element.one("afterLoad.bjui.datagrid",function(){a.needfixedWidth=!0,a.fixedWidth(),a.needfixedWidth=null})},a.prototype.reload=function(e){var i,n,o=this,s=o.options;e&&"object"==typeof e&&(e.clearOldPostData&&delete s.postData,e.columns&&delete s.columns,t.extend(!0,s,e)),o.destroy(),n=o.$element,n.data("bjui.datagrid",i=new a(n,s)),i&&i.init()},a.prototype.destroy=function(){var t=this,e=t.$grid.data("bjui.datagrid.table");e&&(t.$element.html(e.html()).removeData().insertBefore(t.$grid),t.$grid.remove())},a.prototype.initTop=function(){var e,a=this,i=a.options,n=(a.regional,!1),o='<div class="btn-group" role="group"></div>',s='<button type="button" class="btn" data-icon=""></button>';if(i.showToolbar&&(i.toolbarItem||i.toolbarCustom)){if(i.toolbarItem){var r=i.toolbarItem.toFunc();"function"==typeof r&&(i.toolbarItem=r.apply()),n=!0,i.toolbarItem.indexOf("all")>=0&&(i.toolbarItem="add, edit, cancel, save, |, del, |, refresh, |, import, export, exportf"),t.each(i.toolbarItem.split(","),function(n,r){return r=r.trim().toLocaleLowerCase(),e&&"|"!==r||(e=t(o).appendTo(a.$toolbar),"|"!==r)?void("add"===r?a.$toolbar_add=t(s).attr("data-icon","plus").addClass("btn-blue").text(i.addName||BJUI.getRegional("datagrid.add")).appendTo(e).on("click",function(t){a.add()}):"edit"===r?a.$toolbar_edit=t(s).attr("data-icon","edit").addClass("btn-green").text(i.editName||BJUI.getRegional("datagrid.edit")).appendTo(e).on("click",function(e){var n=a.$tbody.find("> tr."+a.classnames.tr_selected);return i.editMode?void(n.length?i.inlineEditMult?a.doEditRow(n):a.$lastSelect?a.doEditRow(a.$lastSelect):a.doEditRow(n.first()):t(this).alertmsg("info",BJUI.getRegional("datagrid.selectMsg"))):!1}):"cancel"===r?a.$toolbar_calcel=t(s).attr("data-icon","undo").addClass("btn-orange").text(i.cancelName||BJUI.getRegional("datagrid.cancel")).appendTo(e).on("click",function(t){a.doCancelEditRow(a.$tbody.find("> tr."+a.classnames.tr_edit))}):"save"===r?a.$toolbar_save=t(s).attr("data-icon","save").addClass("btn-default").text(i.saveName||BJUI.getRegional("datagrid.save")).appendTo(e).on("click",function(t){a.doSaveEditRow()}):"del"===r?a.$toolbar_del=t(s).attr("data-icon","times").addClass("btn-red").text(i.delName||BJUI.getRegional("datagrid.del")).appendTo(e).on("click",function(e){var i=a.$tbody.find("> tr."+a.classnames.tr_selected);i.length?a.delRows(i):t(this).alertmsg("info",BJUI.getRegional("datagrid.selectMsg"))}):"refresh"===r?a.$toolbar_refresh=t(s).attr("data-icon","refresh").addClass("btn-green").text(i.refreshName||BJUI.getRegional("datagrid.refresh")).appendTo(e).on("click",function(t){a.refresh()}):"import"===r?a.$toolbar_add=t(s).attr("data-icon","sign-in").addClass("btn-blue").text(i.importName||BJUI.getRegional("datagrid.import")).appendTo(e).on("click",function(t){if(i.importOption){var e=i.importOption;"string"==typeof e&&(e=e.toObj()),e.options&&e.options.url&&("dialog"===e.type?a.$grid.dialog(e.options):"navtab"===e.type?a.$grid.navtab(e.options):a.$grid.bjuiajax("doajax",e.options))}}):"export"===r?a.$toolbar_add=t(s).attr("data-icon","sign-out").addClass("btn-green").text(i.exportName||BJUI.getRegional("datagrid.export")).appendTo(e).on("click",function(e){if(i.exportOption){var n=i.exportOption;"string"==typeof n&&(n=n.toObj()),n.options&&n.options.url&&(n.options.data||(n.options.data={}),t.extend(n.options.data,a.$element.data("filterDatas")||{},a.sortData||{}),n.options.type="POST","dialog"===n.type?BJUI.dialog(n.options):"navtab"===n.type?BJUI.navtab(n.options):"file"===n.type?(n.options.target=a.$boxB,BJUI.ajax("ajaxdownload",n.options)):BJUI.ajax("doajax",n.options))}}):"exportf"===r&&(a.$toolbar_add=t(s).attr("data-icon","filter").addClass("btn-green").text(i.exportfName||BJUI.getRegional("datagrid.exportf")).appendTo(e).on("click",function(e){if(i.exportOption){var n=i.exportOption,o=a.tools.getRemoteFilterData(!0);"string"==typeof n&&(n=n.toObj()),n.options&&n.options.url&&(n.options.data||(n.options.data={}),t.extend(n.options.data,o,a.sortData||{}),n.options.type="POST","dialog"===n.type?BJUI.dialog(n.options):"navtab"===n.type?BJUI.navtab(n.options):"file"===n.type?(n.options.target=a.$boxB,BJUI.ajax("ajaxdownload",n.options)):BJUI.ajax("doajax",n.options))}}))):!0})}if(i.toolbarCustom){var l,d=t('<div style="display:inline-block;"></div>');if("string"==typeof i.toolbarCustom){var c=t(i.toolbarCustom);c&&c.length?l=c:(c=c.toFunc(),c&&(l=c.call(a),"string"==typeof l&&(l=t(l))))}else"function"==typeof i.toolbarCustom?(l=i.toolbarCustom.call(a),"string"==typeof l&&(l=t(l))):l=i.toolbarCustom;l&&l.length&&"string"!=typeof l&&(n&&d.css("margin-left","5px"),d.appendTo(a.$toolbar),l.appendTo(d))}a.$toolbar.initui()}},a.prototype.initThead=function(){var e,a=this,i=a.options,n=a.tools,o=a.columnModel,s=[];a.$tableH.append(a.$thead),a.init_thead=!0,a.$trsH=a.$thead.find("> tr"),a.table_width=0,a.$colgroupH=a.$tableH.find("> colgroup"),a.fixtedColumnWidthCount=0,t.each(a.columnModel,function(t,i){var n="";(i===a.checkboxColumn||i===a.childColumn||i===a.editBtnsColumn||i.finalWidth)&&(n=' class="datagrid_col_lockwidth"'),e=i.width,e&&"auto"!==e||a.hasAutoCol||(a.hasAutoCol=!0),s.push('<col style="width:'+(e&&"auto"!==e?e+"px":"auto")+'"'+n+">"),i.width=e}),a.table_width=a.$grid.width(),a.$colgroupH.html(s.join(""));var r=a.$trsH.find("> th");r.filter(".datagrid-quicksort-th").on("click.bjui.datagrid.quicksort",function(e){var i=t(e.target);i.closest("."+a.classnames.th_cell).length||a.isResize||n.quickSort(o[t(this).data("index")])}),r.filter(".datagrid-column-menu").on("filter.bjui.datagrid.th",function(e,i){var n=t(this),o=n.find("> div > ."+a.classnames.th_cell+"> ."+a.classnames.btn_menu+"> .btn");i?(n.addClass("filter-active"),o.find("> i").attr("class","fa fa-filter")):(n.removeClass("filter-active"),o.find("> i").attr("class","fa fa-bars"))}),i.contextMenuH&&n.contextmenuH(),a.initTbody(),i.columnResize&&a.colResize(),i.columnMenu&&a.colMenu(),i.paging&&a.initPaging(),i.editMode&&a.edit();var l=function(){if(i.showTfoot&&a.initTfoot(),a.renderTds&&a.renderTds.length){for(var e=a.$tbody.find("> tr:not(."+a.classnames.tr_child+", .datagrid-nodata)"),o=a.renderTds&&a.renderTds.length,s={},r=t(),l=[],d=0;o>d;d++){var c=a.renderTds[d],u=c.render.call(a,c.label,c.data,a.columnModel[c.tdindex].items,a.columnModel[c.tdindex].itemattr),p=t.extend({},c.data);if(!s[c.tdindex]&&a.columnModel[c.tdindex].fixedWidth&&(s[c.tdindex]=a.columnModel[c.tdindex]),a.isTemplate){var p={},h=t.inArray(e.eq(c.trindex)[0],r);-1==h?(r=r.add(e.eq(c.trindex)),p=t.extend({},c.data),p[a.columnModel[c.tdindex].name]=u,l.push(p)):l[h][a.columnModel[c.tdindex].name]=u}else e.eq(c.trindex).find("> td:eq("+c.tdindex+") > div:last").html(u)}t.each(r,function(e){var a=t(this).find("> td.datagrid-template-td"),i=a.html();a.length&&a.html(n.replacePlh4Template(i,l[e]))})}a.isTemplate?a.$grid.data("bjui.datagrid.trs.template",a.$tbody.html()):a.$grid.data("bjui.datagrid.trs.normal",a.$tbody.html()),a.initEvents(),a.$tableB.initui(),a.$lockTableB&&a.$lockTableB.initui(),n.setBoxbH(),a.collapseIndex&&a.collapseIndex.length&&(a.expand(a.collapseIndex.join(","),!1),a.collapseIndex=null),setTimeout(function(){a.fixedWidth("init"),a.initLock(),a.$element.trigger("completed.bjui.datagrid",{datas:a.data}),a.$boxM&&a.$boxM.trigger("bjui.ajaxStop").hide(),(a.options.width.endsWith("%")&&a.options.flowLayoutWidth&&a.$grid.width()<a.options.flowLayoutWidth||a.options.dialogFilterW&&a.$grid.width()<a.options.dialogFilterW||0===a.options.dialogFilterW)&&t(window).resize(),a.resizeGrid()},50),a.delayFilterTimeout&&clearInterval(a.delayFilterTimeout)};i.filterThead?a.delayRender?a.delayFilterTimeout=setInterval(function(){a.delayRender||(a.filterInThead(),l())},100):(a.filterInThead(),l()):l()},a.prototype.fixedWidth=function(e){var a,i=this,n=i.options,o=i.columnModel;o.length;if(!e||!i.initFixedW){i.initFixedW=!0;var s=function(){if(String(i.options.width).endsWith("%")&&i.$grid.css("width",""),i.$boxH.find("> div").css("width",""),i.$boxB.find("> div").css("width",""),i.$boxF&&i.$boxF.find("> div").css("width",""),i.$boxP&&i.$boxP.find("> div.paging-content").css("width",""),a=i.$boxB.find("> div")[0].clientWidth,i.options.hasChild){var s=i.$boxB.scrollTop();i.$boxB.scrollTop(1),i.$boxB.scrollTop()&&i.$boxB.scrollTop(s)}if(i.$element.hasClass("table-child")&&(a-=18),i.$boxB.find("> div").width(a),i.$boxH.find("> div").width(a),i.$boxF&&i.$boxF.find("> div").width(a),i.table_width>a||n.fullGrid?i.$boxP&&i.$boxP.find("> div.paging-content").width(a):i.$boxP&&i.$boxP.find("> div.paging-content").width(i.table_width),n.fullGrid||i.isTemplate||i.needfixedWidth||i.hasAutoCol&&e){t("body").find("> .bjui-datagrid").remove();var r=i.$tableH.height(),l=t('<div class="bjui-datagrid forwidth"></div>'),d=i.$element.clone().addClass("table table-bordered").appendTo(l);d.find("> tbody").before(i.$thead.clone()),d.find("> colgroup > col").each(function(e){var a=t(this),n=i.data.length?String(i.data[i.data.length-1].gridNumber).length:2;return a.hasClass("datagrid_col_lockwidth")?!0:void(o[e]===i.linenumberColumn?(1==n&&(n=2),a.width(15*n)):(!o[e].width||"auto"===o[e].width||i.isTemplate)&&a.width(""))}),l.width(a+17).height(i.$boxB.height()).prependTo(t("body")),n.fullGrid||i.isTemplate||!n.hScrollbar||l.width(""),i.isTemplate&&(n.tableWidth="100%"),d.attr("style","width:"+(n.tableWidth||"auto")+" !important;"),d.find("thead th > div").height("");var c=d.find("> tbody > tr:first");if(!c.length||i.isTemplate||c.hasClass("datagrid-nodata")){var u=BJUI.StrBuilder();u.add("<tr>");for(var p=0,h=d.find("colgroup > col").length;h>p;p++)u.add("<td></td>");u.add("</tr>"),d.find("> tbody").prepend(u.toString()),c=d.find("> tbody > tr:first")}i.isTemplate&&i.$boxP&&i.$boxP.find("> div.paging-content").width("100%");var g=i.$thead.find("th");d.find("thead > tr:not(.datagrid-filter) > th").each(function(e){var a=t(this),i=a.is(":hidden");i&&a.show(),g.eq(e).find("> div").height(a.find("> div").height()),i&&a.hide()}),i.$boxB.height(i.$boxB.height()+(r-d.find("> thead").height())),i.$boxM&&i.$boxM.height(i.$boxB.height()).css("top",i.$boxB.position().top),i.$lockB&&i.$lockB.height(i.$boxB.height()),c.find("> td").each(function(e){var a=i.$colgroupB.find("> col:eq("+e+")");!a.hasClass("datagrid_col_lockwidth")&&a.width(t(this).outerWidth())}),i.$colgroupH.html(i.$colgroupB.html()),i.options.noremove||l.remove()}};s()}},a.prototype.fixedHeight=function(t){var e=this,a=e.options;"auto"===a.height?(e.boxH="auto",e.$grid.css("height",""),e.$boxB.css("height",""),e.tools.setBoxbH()):e.tools.setBoxbH(t);var i=e.$boxB.scrollLeft();e.$boxB.scrollLeft(5),e.$boxB.scrollLeft()&&(e.fixedWidth(),e.$boxB.scrollLeft(i))},a.prototype.initTbody=function(){var t=this,e=t.options,a=(t.tools,t.$tbody.find("> tr")),i=(a.find("> td"),e.tableWidth||"0");t.init_tbody=!0,t.$colgroupB=t.$colgroupH.clone(),t.$tableB.prepend(t.$colgroupB),(e.fullGrid||t.isTemplate)&&(i="100%"),t.$tableH.css("width",i),t.$tableB.css("width",i),t.$tableB.removeAttr("data-toggle width").addClass("table table-bordered").removeClass("table-hover"),t.$boxB.scroll(function(){t.$boxH.find("> div").prop("scrollLeft",this.scrollLeft),t.$boxF&&t.$boxF.find("> div").prop("scrollLeft",this.scrollLeft),t.$lockB&&t.$lockB.prop("scrollTop",this.scrollTop)}),t.isDom&&(e.showLinenumber&&t.showLinenumber(e.showLinenumber),e.showCheckboxcol&&t.showCheckboxcol(e.showCheckboxcol),e.showEditbtnscol&&t.showEditCol(e.showEditbtnscol),t.$grid.data(t.datanames.tbody,t.$tbody.clone()))},a.prototype.initEvents=function(e){var a=this,i=a.options,n=a.$tbody.find("> tr");if(e||(e=n),e.on("click.bjui.datagrid.tr",function(e,n){var o,s,r=t(this),l=r.index(),d=a.$tbody.find("> tr."+a.classnames.tr_selected),c=a.$lastSelect;a.$lockTbody&&a.$lockTbody.find("> tr");if(n)s=n.is(":checked"),s||(a.$lastSelect=r),a.selectedRows(r,!s);else{if(r.hasClass(a.classnames.tr_edit))return;i.selectMult?a.selectedRows(r):BJUI.KeyPressed.ctrl||BJUI.KeyPressed.shift?BJUI.KeyPressed.ctrl?(r.hasClass(a.classnames.tr_selected)||(a.$lastSelect=r),a.selectedRows(r)):BJUI.KeyPressed.shift&&(c||(c=a.$lastSelect=r),c.length&&(a.selectedRows(null),c.index()!=l?c.index()>l?a.selectedRows(r.nextUntil(c).add(r).add(c),!0):a.selectedRows(r.prevUntil(c).add(r).add(c),!0):a.selectedRows(l))):d.length>1&&r.hasClass(a.classnames.tr_selected)?(a.selectedRows(d.not(r)),a.$lastSelect=r):(d.length&&d[0]!=this&&a.selectedRows(null),r.hasClass(a.classnames.tr_selected)||(a.$lastSelect=r),a.selectedRows(r))}o=a.isDom?a.tools.setDomData(r):a.data[a.tools.getNoChildDataIndex(l)],a.$element.trigger("clicked.bjui.datagrid.tr",{target:e.target,tr:r,data:o})}).on("mouseenter.bjui.datagrid",function(e){var i=t(this),n=i.index();return a.isDrag?!1:(i.addClass("datagrid-hover"),void(a.$lockTbody&&a.$lockTbody.find("> tr:eq("+n+")").addClass("datagrid-hover")))}).on("mouseleave.bjui.datagrid",function(e){var i=t(this),n=i.index();return a.isDrag?!1:(i.removeClass("datagrid-hover"),void(a.$lockTbody&&a.$lockTbody.find("> tr:eq("+n+")").removeClass("datagrid-hover")))}).on("delete.bjui.datagrid.tr",function(e){e.stopPropagation();var i,n=t(this),o=n.index(),s=o,r=a.data,l=a.allData,d=a.$lockTbody&&a.$lockTbody.find("> tr");if(n.hasClass("datagrid-nodata"))return!1;if(a.options.hasChild&&a.options.childOptions&&(s/=2,n.next().remove(),d&&d.eq(o).next().remove()),a.options.isTree){var c=a.getChildrens(n,null,!0),u=c.length;a.options.hasChild&&a.options.childOptions&&(u/=2),c.remove(),a.isDom||(i=r[s].gridIndex,a.data.splice(s+1,u),a.allData.splice(i+1,u))}a.isDom||(i=r[s].gridIndex,a.data=r.remove(s),a.allData=l.remove(i),a.tools.updateGridIndex()),-1!=t.inArray(a.linenumberColumn,a.columnModel)&&(n.nextAll(":not(."+a.classnames.tr_child+")").each(function(){var e=t(this).find("> td."+a.classnames.td_linenumber),i=parseInt(e.text(),10);e.text(i-1)}),d&&d.eq(o).trigger("delete.bjui.datagrid.tr",[o])),n.remove(),d&&d.eq(o).remove(),a.tools.createNoDataTr()}),a.$grid.off("click.bjui.datagrid.tr.child").on("click.bjui.datagrid.tr.child","td."+a.classnames.td_child,function(e){e.stopPropagation();var i=t(this),n=i.closest("tr"),o=n.next("."+a.classnames.tr_child);o&&o.length&&a.showChild(n,!o.is(":visible"))}).off("ifClicked").on("ifClicked","td."+a.classnames.td_checkbox+" input",function(e){e.stopPropagation();var i=t(this),n=i.closest("tr"),o=n.index();a.$tbody.find("> tr:eq("+o+")").trigger("click.bjui.datagrid.tr",[i])}).off("ifChanged").on("ifChanged","th."+a.classnames.td_checkbox+" input",function(e){e.stopPropagation();var i=t(this).is(":checked"),n=a.$tbody.find('> tr:not(".'+a.classnames.tr_child+'")');a.selectedRows(n,i)}),i.contextMenuB&&e.each(function(){a.tools.contextmenuB(t(this))}),a.$tableB.off("click.bjui.datagrid.refresh").on("click.bjui.datagrid.refresh",'tbody > tr > td [data-toggle="update.datagrid.tr"]',function(e){e.stopPropagation(),e.preventDefault(),a.updateRow(t(this).closest("tr"))}).off("click.bjui.datagrid.edit").on("click.bjui.datagrid.edit",'tbody > tr > td [data-toggle="edit.datagrid.tr"]',function(e){e.stopPropagation(),e.preventDefault();var i=t(this),n=i.data("options"),o=i.closest("tr");n&&"string"==typeof n&&(n=n.toObj()),"object"==typeof n?a.externalEdit(o,n):a.doEditRow(o)}).off("click.bjui.datagrid.ajax").on("click.bjui.datagrid.ajax",'tbody > tr > td [data-toggle="ajax.datagrid.tr"]',function(e){e.stopPropagation(),e.preventDefault();var i=t(this),n=i.data();n.options&&"string"==typeof n.options&&(n.options=n.options.toObj()),t.extend(n,"object"==typeof n.options&&n.options),!n.url&&i.attr("href")&&(n.url=i.attr("href")),a.doAjaxRow(i.closest("tr"),n)}).off("click.bjui.datagrid.addchild").on("click.bjui.datagrid.addchild",'tbody > tr > td [data-toggle="addchild.datagrid.tr"]',function(e){e.stopPropagation(),e.preventDefault();var i,n,o=t(this),s=o.closest("tr"),r=s.data("bjui.datagrid.child"),l=s.next("."+a.classnames.tr_child),d=o.data("addData"),c=function(t){return t.replace(/#\/?[^#]*#/g,function(t){var e=t.replace(/[##]+/g,""),a=i[e];return("undefined"==typeof a||"null"===a||null===a)&&(a=""),a})},u=function(t){d&&("string"==typeof d?(d=c(d),d=d.trim().startsWith("{")?d.toObj():d.toFunc()):("function"==typeof d&&(d=d.toFunc()),"object"==typeof d&&(d=JSON.stringify(d)),d=c(d).toObj()),"object"==typeof d&&(n=d)),t.datagrid("add",!1,n)};l&&l.length&&(i=a.isDom?s.data("initData")||tools.setDomData(s):a.data[a.tools.getNoChildDataIndex(s.index())],r&&r.length?u(r):a.showChild(s,!0,u))}).off("click.bjui.datagrid.del").on("click.bjui.datagrid.del",'tbody > tr > td [data-toggle="del.datagrid.tr"]',function(e){e.stopPropagation(),e.preventDefault(),a.delRows(t(this).closest("tr"))}).off("click.bjui.datagrid.tree").on("click.bjui.datagrid.tree","tbody > tr > td .datagrid-tree-switch",function(e){e.stopPropagation(),e.preventDefault();var n=t(this),o=n.closest("tr"),s=o.data("child"),r=o.data("level"),l=!n.hasClass("collapsed");
s&&(o.data("isExpand",!l).nextAll(".datagrid-tree-level-"+(r+1)).slice(0,s).toggleClass("collapsed",l).trigger("switch.child.bjui.datagrid.tree",{isExpand:l}),n.toggleClass("collapsed",l).find("> i").attr("class","fa "+(l?"fa-plus-square-o":"fa-minus-square-o"))),"auto"===i.height&&a.fixedHeight()}).off("switch.child.bjui.datagrid.tree").on("switch.child.bjui.datagrid.tree","tbody > tr",function(e,i){e.stopPropagation(),e.preventDefault();var n=t(this),o=n.data("child"),s=n.data("level");o&&n.nextAll(".datagrid-tree-level-"+(s+1)).slice(0,o).toggleClass("collapsed-child",i[a.options.treeOptions.isExpand]).trigger("switch.child.bjui.datagrid.tree",{isExpand:i[a.options.treeOptions.isExpand]})}).off("expand.bjui.datagrid.tree").on("expand.bjui.datagrid.tree","tbody > tr",function(e){e.stopPropagation(),e.preventDefault();var n=t(this).data("isExpand",!0),o=n.find("> td.datagrid-tree-td .datagrid-tree-switch");return o&&o.length&&o.hasClass("collapsed")?(o.trigger("click.bjui.datagrid.tree"),void("auto"===i.height&&a.fixedHeight())):!1}).off("collapse.bjui.datagrid.tree").on("collapse.bjui.datagrid.tree","tbody > tr",function(e){e.stopPropagation(),e.preventDefault();var n=t(this).data("isExpand",!1),o=n.find("> td.datagrid-tree-td .datagrid-tree-switch");return o&&o.length&&!o.hasClass("collapsed")?(o.trigger("click.bjui.datagrid.tree"),void("auto"===i.height&&a.fixedHeight())):!1}).off("mouseover.bjui.datagrid.tree").on("mouseover.bjui.datagrid.tree","tbody > tr > td.datagrid-tree-td",function(e){if(e.stopPropagation(),e.preventDefault(),!i.treeOptions.add||a.isDrag)return!1;var n=t(this),o=(n.closest("tr"),n.find(".datagrid-tree-add"));o&&o.length?o.show():n.find("> div").append('<a href="javascript:;" class="datagrid-tree-add" data-toggle="add.datagrid.tree" title="添加"><i class="fa fa-plus-circle"></i></a>')}).off("mouseout.bjui.datagrid.tree").on("mouseout.bjui.datagrid.tree","tbody > tr > td.datagrid-tree-td",function(e){if(e.stopPropagation(),e.preventDefault(),!i.treeOptions.add||a.isDrag)return!1;var n=t(this),o=n.find(".datagrid-tree-add");o&&o.length&&o.hide()}).off("click.bjui.datagrid.tree.add").on("click.bjui.datagrid.tree.add",'tbody > tr > td.datagrid-tree-td [data-toggle="add.datagrid.tree"]',function(e){e.stopPropagation(),e.preventDefault();var i=t(this),n=i.closest("tr"),o=i.data();o.addData&&"string"==typeof o.addData&&(o.addData=o.addData.toObj()),a.addTree(n,o.addLocation||"",o.addData||{})}),i.dropOptions.drop){var e=a.$tbody.find("> tr:not(."+a.classnames.tr_child+")"),o=i.dropOptions.beforeDrag;"string"==typeof o&&(o=o.toFunc()),"function"!=typeof o&&(o=!1),e.basedrag("destroy").basedrag({exclude:"input, button, a, .bjui-lookup, .datagrid-tree-switch, .datagrid-tree-add, .datagrid-child-td",drop:e,container:a.$boxB,beforeDrag:o,treeData:a.data,drag:function(){a.isDrag=!0},stop:function(){a.isDrag=!1,t(this).find("> td.datagrid-tree-td").trigger("mouseout.bjui.datagrid.tree")}}).off("dropover.bjui.basedrag").on("dropover.bjui.basedrag",function(e,i,o,s){if(n.removeClass("datagrid-hover datagrid-drop-over-after datagrid-drop-over-before").find(".datagrid-tree-box").removeClass("datagrid-drop-over-append"),this===s[0]||s.hasClass(a.classnames.tr_edit))return!1;if(a.options.isTree){var r=a.getChildrens(s);if(-1!==t.inArray(this,r))return!1}var l=t(this).addClass("datagrid-hover"),d=l.outerHeight()/2,c=l.offset().top;a.options.isTree&&(d=5),c+d>o?l.addClass("datagrid-drop-over-before").prevAll(":visible:first").addClass("datagrid-drop-over-after"):!a.options.isTree||a.options.isTree&&o>c+l.outerHeight()-d?l.addClass("datagrid-drop-over-after"):a.options.isTree&&l.find(".datagrid-tree-box").addClass("datagrid-drop-over-append")}).off("dropout.bjui.basedrag").on("dropout.bjui.basedrag",function(t,a){e.removeClass("datagrid-hover datagrid-drop-over-after datagrid-drop-over-before"),e.find("div.datagrid-drop-over-append").removeClass("datagrid-drop-over-append")}).off("drop.bjui.basedrag").on("drop.bjui.basedrag",function(n,o){var s,r=t(this),l=(i.dropOptions.beforeDrop,i.dropOptions.afterDrop);if(a.afterDrop=!1,r.hasClass("datagrid-drop-over-before")?s="top":r.hasClass("datagrid-drop-over-after")?s="bottom":a.options.isTree&&r.find(".datagrid-tree-box").hasClass("datagrid-drop-over-append")&&(s="append"),s)if("append"!=s)a.insertTr(o,r,s);else{var d=a.getParents(o,null,!0);if(-1!==t.inArray(this,d))return r.find(".datagrid-tree-box").removeClass("datagrid-drop-over-append"),!1;a.appendTr(o,r)}if(e.removeClass("datagrid-drop-over-after datagrid-drop-over-before").find(".datagrid-tree-box").removeClass("datagrid-drop-over-append"),l&&a.afterDrop)if("function"==typeof l)l.apply(a,[o,r]);else if(i.dropOptions.dropUrl){var c={pageSize:a.paging.pageSize,pageCurrent:a.paging.pageCurrent},u=i.editType,p={url:i.dropOptions.dropUrl,type:"POST",reload:!1};c.list=[],t.each(a.data,function(e,a){var n=t.extend({},a);if("drop"!==i.dropOptions.scope||a[i.keys.dropFlag])for(var o in i.keys)delete n[i.keys[o]];"drop"===i.dropOptions.scope?a[i.keys.dropFlag]&&c.list.push(n):c.list.push(n)}),c&&(c=JSON.stringify(i.dropOptions.paging&&i.paging?c:c.list),u&&"raw"===u?(p.data=c,p.contentType="application/json"):(p.data={json:c},u&&(p.type=u)),BJUI.ajax("doajax",p))}})}},a.prototype.getChildrens=function(e,a,i,n){var o=this,s=e.data("child"),r=e.data("level");return n&&n--,a||(a=t()),s&&e.nextAll(".datagrid-tree-level-"+(r+1)).slice(0,s).each(function(){a=a.add(this),i&&t(this).next().hasClass(o.classnames.tr_child)&&(a=a.add(t(this).next())),n&&(a=a.add(o.getChildrens(t(this),a,i,n)))}),a},a.prototype.getParents=function(e,a,i,n){var o,s=this,r=e.data("level");return a||(a=t()),r&&(o=e.prevAll(".datagrid-tree-level-"+(r-1)+":first"),o.length&&(a=a.add(o),n&&o.next().hasClass(s.classnames.tr_child)&&(a=a.add(o.next())),i||(a=a.add(s.getParents(o,a,n))))),a},a.prototype.appendTr=function(e,a,i){if(this.options.isTree){var n,o,s,r,l,d,c,u,p=this,h=p.options,g=p.tools.getNoChildDataIndex(e.index()),f=p.tools.getNoChildDataIndex(a.index()),m=e.next().hasClass(p.classnames.tr_child),b=h.treeOptions.keys,v=e.data("level"),y=a.data("level")+1||0,x=a.data("child")+1,k=a.find("> td.datagrid-tree-td"),C=h.dropOptions.beforeDrop;if(m&&(e=e.add(e.next()),a=a.add(a.next())),n=p.data[g],o=p.data[f],C&&"string"==typeof C&&(C=C.toFunc()),!C||"function"!=typeof C||C.apply(this,[n,o,"append"])){if(s=p.getParents(e,null,!0),s.length&&(r=p.data[p.tools.getNoChildDataIndex(s.index())],r[b.childLen]=r[b.childLen]-1,s.data("child",r[b.childLen]).attr("data-child",r[b.childLen]),!r[b.childLen])){delete r[b.isParent],delete r[b.isExpand];var j=s.find("> td.datagrid-tree-td");j.html(p.tools.createTreePlaceholder(r,j.find(".datagrid-tree-title").html()),s.data("isExpand"))}if(a.length&&(a=p.getChildrens(a,a,!0),u=p.getChildrens(a.last(),a.last(),!0,!0).last(),p.expand(a.first(),!0),o[b.isParent]=!0,o[b.childLen]=x,a.first().data("child",x).attr("data-child",x),k.html(p.tools.createTreePlaceholder(o,k.find(".datagrid-tree-title").html(),a.first().data("isExpand")))),e=p.getChildrens(e,e,!0),e.filter(":not(."+p.classnames.tr_child+")").each(function(){var e=t(this),a=e.data("level"),n=a+(y-v),s=e.find("> td.datagrid-tree-td"),r=s.find(".datagrid-tree-title").html(),l=e.index(),d=p.data[p.tools.getNoChildDataIndex(l)];i&&i.isUp&&(n=o[b.level]),d[b.level]=n,e.removeClass("datagrid-tree-level-"+a).addClass("datagrid-tree-level-"+n).data("level",n).attr("data-level",n),s.html(p.tools.createTreePlaceholder(d,r,e.data("isExpand")))}),i&&i.dIndex?d=i.dIndex:(d=a.last().index()+1,m&&(d/=2)),c=m?e.length/2:e.length,p.data.moveItems(g,d,c),p.allData.moveItems(n.gridIndex,n.gridIndex+(d-g),c),p.tools.updateGridIndex(),i&&i._dTr?(l=p.getParents(i._dTr,null,!0,!1),i.isBefore?e.insertBefore(i._dTr):i.isUp?e.insertAfter(u):e.insertAfter(i._dTr)):e.insertAfter(u),s){var $=p.getChildrens(s,null,!1);$.each(function(e){var a=p.data[p.tools.getNoChildDataIndex(t(this).index())];a&&(a[b.order]=e,a[h.keys.dropFlag]=!0)})}if(l||(l=a.first()),l&&l.length){var $=p.getChildrens(l,null,!1),w=p.data[p.tools.getNoChildDataIndex(l.index())];n[b.parentKey]=w[b.key],$.each(function(e){var a=p.data[p.tools.getNoChildDataIndex(t(this).index())];a&&(a[b.order]=e,a[h.keys.dropFlag]=!0)})}else{var T=e.siblings(".datagrid-tree-level-"+n[b.level]).addBack();n[b.parentKey]=null,T.each(function(e){var a=p.data[p.tools.getNoChildDataIndex(t(this).index())];a&&(a[b.order]=e,a[h.keys.dropFlag]=!0)})}p.tools.updateLinenumber(),p.afterDrop=!0}}},a.prototype.insertTr=function(e,a,i){var n,o,s,r,l,d,c=this,u=c.options,p=u.treeOptions.keys,h=c.tools.getNoChildDataIndex(e.index()),g=c.tools.getNoChildDataIndex(a.index()),f=e.next().hasClass(c.classnames.tr_child),m=u.dropOptions.beforeDrop,b=function(t,e,a){"bottom"===i?(f&&(e=e.next()),t.insertAfter(e)):t.insertBefore(e)};if(o=c.data[h],s=c.data[g],m&&"string"==typeof m&&(m=m.toFunc()),(!m||"function"!=typeof m||m.apply(this,[o,s,i]))&&(n=h>g?"top"===i?0:1:"top"===i?-1:0,r=g+n,r!=h||u.isTree))if(f&&(e=e.add(e.next())),c.isDom)b(e,a,n);else{if(o=c.data[h],s=c.data[g],u.isTree){var v,y={},x=!1,k=c.getParents(e.first(),null,!0),C=c.getParents(a,null,!0);if(s[p.level]===o[p.level]&&s[p.order]==o[p.order]+("bottom"===i?-1:1))return;if("bottom"===i&&s[p.isParent]?(x=!0,y._dTr=a,y.dIndex=g+1,y.isUp=!0):(e.data("level")!=a.data("level")||k[0]!==C[0])&&(x=!0,y._dTr=a,y.dIndex=r,a=C,"top"===i&&(y.isBefore=!0),g>h&&y.dIndex++),x)return void c.appendTr(e,a,y);e=c.getChildrens(e,e,!0),v=f?e.length/2:e.length,c.data.moveItems(h,r,v),c.allData.moveItems(o.gridIndex,s.gridIndex+n,v),l=h>g?g:h,d=(h>g?h:g)+(v-1)}else c.data.move(h,r),c.allData.move(o.gridIndex,s.gridIndex+n),l=h>g?g:h,d=h>g?h:g;if(c.tools.updateGridIndex(),b(e,a,n),k){var j=c.getChildrens(k,null,!1,1);j.each(function(e){var a=c.data[c.tools.getNoChildDataIndex(t(this).index())];a&&a[u.keys.gridIndex]>=l&&a[u.keys.gridIndex]<=d&&(a[p.order]=e,a[u.keys.dropFlag]=!0)})}else for(var $=l;d>=$;$++){var w=c.data[$];w[u.keys.dropFlag]=!0}c.tools.updateLinenumber(),c.afterDrop=!0}},a.prototype.addTree=function(t,e,a){var i,n=this,o=n.options;o.isTree&&(a&&"object"==typeof a||(a={}),i=t instanceof jQuery?t.first():n.$tbody.find("> tr:not(."+n.classnames.tr_child+")").eq(parseInt(t,10)),i&&i.length&&(n.$lastSelect=i,n.add(e,a)))},a.prototype.expand=function(e,a){var i,n=this,o=n.options,s=n.$tbody.find("> tr:not(."+n.classnames.tr_child+")");if("undefined"==typeof a&&(a=!0),i=(a?"expand":"collapse")+".bjui.datagrid.tree",o.isTree)if(e instanceof jQuery)e.trigger(i);else if(isNaN(e))t.each(e.split(","),function(t,e){var a=s.eq(parseInt(e.trim(),10));a&&a.length&&a.trigger(i)});else if(!isNaN(e)){var r=s.eq(e);r&&r.length&&r.trigger(i)}},a.prototype.initTfoot=function(){var e=this,a=e.options,i=e.tools,n=e.columnModel,o=t("<tr></tr>");e.$boxF=t('<div class="datagrid-box-f"></div>'),e.$colgroupF=e.$colgroupH.clone(),e.$tableF=e.$tableH.clone().empty(),e.$tableF.append(e.$colgroupF),e.$boxF.append(t('<div class="datagrid-wrap-h"></div>').append(e.$tableF)),e.$boxF.insertAfter(e.$boxB),e.$tfoot=t("<thead></thead>"),t.each(n,function(e,a){var i=t("<th><div></div></th>");if(a.calc){var n='<div><div class="datagrid-calcbox">#tit#</div>#number#</div>';"avg"===a.calc?i.html(n.replace("#tit#",a.calcTit||"AVG").replace("#number#",(a.calc_sum/a.calc_count).toFixed(a.calcDecimal||2))):"count"===a.calc?i.html(n.replace("#tit#",a.calcTit||"COUNT").replace("#number#",a.calc_count)):"sum"===a.calc?i.html(n.replace("#tit#",a.calcTit||"SUM").replace("#number#",a.calc_sum)):"max"===a.calc?i.html(n.replace("#tit#",a.calcTit||"MAX").replace("#number#",a.calc_max)):"min"===a.calc&&i.html(n.replace("#tit#",a.calcTit||"MIN").replace("#number#",a.calc_min))}a.hidden&&i.css("display","none"),i.appendTo(o)}),e.$tfoot.append(o).appendTo(e.$tableF),e.$tfoot.on("resizeH.bjui.datagrid.tfoot",function(){i.setBoxbH(a.height)})},a.prototype.selectedRows=function(e,a){var i=this,n=i.$lockTbody&&i.$lockTbody.find("> tr"),o=i.$tbody.find("> tr"),s=function(t){"undefined"==typeof a&&(a=!0),o.eq(t).hasClass(i.classnames.tr_child)||(o.eq(t).toggleClass(i.classnames.tr_selected,a).find("> td."+i.classnames.td_checkbox+" input").iCheck(a?"check":"uncheck"),n&&n.eq(t).toggleClass(i.classnames.tr_selected,a).find("> td."+i.classnames.td_checkbox+" input").iCheck(a?"check":"uncheck"))};null===e?(o.removeClass(i.classnames.tr_selected).find("> td."+i.classnames.td_checkbox+" input").iCheck("uncheck"),n&&n.removeClass(i.classnames.tr_selected).find("> td."+i.classnames.td_checkbox+" input").iCheck("uncheck")):"object"==typeof e?e.each(function(){var e=t(this),o=e.index();return e.hasClass(i.classnames.tr_child)?!0:void("undefined"!=typeof a?s(o):(e.toggleClass(i.classnames.tr_selected).trigger("bjui.datagrid.tr.selected").find("> td."+i.classnames.td_checkbox+" input").iCheck(e.hasClass(i.classnames.tr_selected)?"check":"uncheck"),n&&n.eq(o).toggleClass(i.classnames.tr_selected).trigger("bjui.datagrid.tr.selected").find("> td."+i.classnames.td_checkbox+" input").iCheck(e.hasClass(i.classnames.tr_selected)?"check":"uncheck")))}):isNaN(e)?t.each(e.split(","),function(t,e){s(parseInt(e.trim(),10))}):isNaN(e)||s(parseInt(e,10)),i.$lastSelect&&!i.$lastSelect.hasClass(i.classnames.tr_selected)&&(i.$lastSelect=null);var r=i.$tbody.find("> tr."+i.classnames.tr_selected),l=[];r.each(function(){var e,a=t(this),n=a.index();n=i.tools.getNoChildDataIndex(n),e=i.isDom?a.data("initData")||i.tools.setDomData(a):i.data[n],l.push(e)}),i.$element.data("selectedTrs",r).data("selectedDatas",l)},a.prototype.initLock=function(){var e=this;e.columnModel;e.col_lock_count=0,t.each(e.columnModel,function(t,a){a.initLock&&e.col_lock_count++}),e.col_lock_count&&e.doLock()},a.prototype.colLock=function(e,a){var i,n,o,s=this;if(!s.isTemplate){if("number"===t.type(e)){if(n=parseInt(e,10),0>n||n>s.columnModel.length-1)return;o=s.columnModel[n],i=o.th}else i=e,n=i.data("index"),o=s.columnModel[n];o!==s.editBtnsColumn&&o.index!==s.columnModel.length-1&&("undefined"==typeof o.locked&&(o.locked=!1),o.locked!==a&&(o.initLock=a,a?s.col_lock_count++:s.col_lock_count--,s.col_lock_count<0&&(s.col_lock_count=0),s.doLock()))}},a.prototype.fixedLockItem=function(e){var a=this,i=a.columnModel,n=a.$thead.find("> tr.datagrid-filter > th"),o=a.$lockTbody&&a.$lockTbody.find("> tr");if(e){var s=function(t,e){t.clone().html("").insertAfter(t),t.show().insertAfter(e),e.remove()};if(n&&n.length&&a.$lockThead.find("> tr.datagrid-filter > th:visible").each(function(){var e=t(this),a=e.index(),i=n.eq(a);s(i,e)}),a.$lockThead&&-1!=t.inArray(a.checkboxColumn,i)&&a.checkboxColumn.locked){var r=a.$lockThead.find("> tr:first > th."+a.classnames.td_checkbox),l=a.checkboxColumn.index,d=a.$thead.find("> tr:first > th:eq("+l+")");s(d,r)}o&&o.length&&o.each(function(){var e,n,o=t(this),s=o.index(),r=function(t,i,o){e=a.$tbody.find("> tr:eq("+i+")"),n=e.find("> td:eq("+o+")"),n.clone().insertAfter(n),n.show().insertAfter(t),t.remove()};o.hasClass(a.classnames.tr_edit)&&o.find("> td."+a.classnames.td_edit+":visible").each(function(){var e=t(this),a=e.index(),n=i[a];n.locked&&r(e,s,a)}),-1!=t.inArray(a.checkboxColumn,i)&&a.checkboxColumn.locked&&o.find("> td."+a.classnames.td_checkbox).each(function(){var e=t(this),i=a.checkboxColumn.index;r(e,s,i)})})}else{var s=function(t,e){e.clone().insertAfter(e),e.hide().insertAfter(t),t.remove()};if(n&&n.length&&a.$lockThead&&a.$lockThead.find("> tr.datagrid-filter > th:visible").each(function(){var e=t(this),a=e.index(),i=n.eq(a);s(i,e)}),a.$lockThead&&-1!=t.inArray(a.checkboxColumn,i)&&a.checkboxColumn.locked){var r=a.$lockThead.find("> tr:first > th."+a.classnames.td_checkbox),l=a.checkboxColumn.index,d=a.$thead.find("> tr:first > th:eq("+l+")");s(d,r)}o&&o.length&&o.each(function(){var e,n,o=t(this),s=o.index(),r=function(t,i,o){e=a.$tbody.find("> tr:eq("+i+")"),n=e.find("> td:eq("+o+")"),t.clone().insertAfter(t),t.hide().insertAfter(n),n.remove()};if(o.hasClass(a.classnames.tr_edit)){var l=o.find("> td:eq("+i.lockIndex+")"),d=l.index();l.hasClass(a.classnames.td_edit)&&r(l,s,d)}-1!=t.inArray(a.checkboxColumn,i)&&a.checkboxColumn.locked&&o.find("> td."+a.classnames.td_checkbox).each(function(){var e=t(this),i=a.checkboxColumn.index;r(e,s,i)})})}},a.prototype.doLock=function(){var e,a,i=this,n=(i.options,i.tools),o=i.columnModel,s=(i.$tableH.width(),0),r=0,l=i.$boxF&&!0,d=0;i.$lockBox&&i.$lockBox.length?(i.fixedLockItem(),i.$lockTableH.empty(),i.$lockTableB.empty(),i.$lockTableF&&i.$lockTableF.empty()):(i.$lockBox=t('<div class="datagrid-box-l"></div>'),i.$lockH=t('<div class="datagrid-box-h"></div>'),i.$lockB=t('<div class="datagrid-box-b"></div>'),i.$lockF=t('<div class="datagrid-box-f"></div>'),i.$lockTableH=t('<table class="table table-bordered"></table>'),i.$lockTableB=t("<table></table>").addClass(i.$tableB.attr("class")),i.$lockTableF=t('<table class="table table-bordered"></table>'),i.$lockH.append(i.$lockTableH),i.$lockB.append(i.$lockTableB),i.$lockF.append(i.$lockTableF),i.$lockBox.append(i.$lockH).append(i.$lockB).prependTo(i.$grid),l&&(i.$lockBox.append(i.$lockF),i.$lockF.css("margin-top",i.$boxB.outerHeight()-i.$boxB[0].clientHeight).height(i.$boxF.outerHeight()))),i.$boxT&&(d+=i.$boxT.outerHeight()),i.$toolbar&&(d+=i.$toolbar.outerHeight()),d&&i.$lockBox.css({top:d}),t.each(o,function(t,e){e.lockShow=!1,e.lockHide=!1,e.initLock?(e.hidden&&n.showhide(e,!0),e.lockHide=!0,e.locked=!0,e.lockIndex=r++,s+=e.width):(e.lockShow=!0,e.hidden?e.lockShow=!1:n.showhide(e,!1),e.locked&&(e.lockShow=!0),e.locked=!1)}),i.$lockThead=i.$thead.clone(!0),i.$lockTbody=i.$tbody.clone(),i.$lockColgroupH=i.$colgroupH.clone(),i.$lockColgroupB=i.$colgroupB.clone(),i.$lockTableH.append(i.$lockColgroupH).append(i.$lockThead).css("width",s),i.$lockTableB.append(i.$lockColgroupB).append(i.$lockTbody).css("width",s),l&&(i.$lockTfoot=i.$tableF.find("> thead").clone(),i.$lockColgroupF=i.$colgroupF.clone(),i.$lockTableF.append(i.$lockColgroupF).append(i.$lockTfoot).css("width",s)),t.each(i.columnModel,function(t,e){e.lockShow&&n.showhide(e,!0),e.lockHide&&n.showhide(e,!1)}),i.$boxH.find("> div").css("width",""),i.$boxB.find("> div").css("width",""),i.$boxF&&i.$boxF.find("> div").css("width",""),setTimeout(function(){var t=i.$boxB.find("> div").width();i.$boxB.find("> div").width(t),i.$boxH.find("> div").width(t),i.$boxF&&i.$boxF.find("> div").width(t)},50),i.col_lock_count?i.$lockBox.show():i.$lockBox.hide(),i.$tbody.find("> ."+i.classnames.tr_child+", .datagrid-nodata").each(function(){t(this).find("> td").attr("colspan",i.columnModel.length-i.col_lock_count)}),s>1&&(s-=1),i.$boxH.css("margin-left",s),i.$boxB.css("margin-left",s),l&&i.$boxF.css("margin-left",s),i.$lockB.height(i.$boxB[0].clientHeight),i.$lockB.prop("scrollTop",i.$boxB[0].scrollTop);var c=i.$lockTableH.height(),u=i.$thead.height(),p=i.$lockTableF&&i.$lockTableF.height(),h=i.$tableF&&i.$tableF.height();c!=u&&(u>c?i.$lockTableH.height(u):i.$tableH.height(c)),p&&h&&p!=h&&(h>p?i.$lockTableF.find("> thead > tr:first-child > th:visible:first").height(h):i.$tableF.find("> thead > tr:first-child > th:visible:first").height(p)),a=i.$lockTbody.find("> tr"),e=i.$tbody.find("> tr"),setTimeout(function(){var n=i.$lockTableB.height(),o=i.$tableB.height();n!=o&&(n>o?a.each(function(a){var i=t(this),n=i.find("> td:visible:first"),o=n.outerHeight();o>30&&(i.height(o),e.eq(a).height(o))}):e.each(function(e){var i=t(this),n=i.find("> td:visible:first"),o=n.outerHeight();o>30&&(i.height(o),a.eq(e).height(o))}))},20),i.fixedLockItem(1),a.find("> td:hidden").remove(),i.initLockEvents(a)},a.prototype.initLockEvents=function(e){if(this.$lockTbody){var a=this,i=a.options;e||(e=a.$lockTbody.find("> tr")),e.on("click.bjui.datagrid.tr",function(e){var i=t(this).index();t(e.target).closest("td");a.$tbody.find("> tr:eq("+i+")").trigger("click.bjui.datagrid.tr")}).on("delete.bjui.datagrid.tr",function(e,i){var n=t(this);a.linenumberColumn&&a.linenumberColumn.locked&&n.nextAll(":not(."+a.classnames.tr_child+")").each(function(){var e=t(this).find("> td."+a.classnames.td_linenumber),i=parseInt(e.text(),10);e.text(i-1)})}).on("mouseenter.bjui.datagrid",function(e){var i=t(this),n=i.index();i.addClass("datagrid-hover"),a.$tbody.find("> tr:eq("+n+")").addClass("datagrid-hover")}).on("mouseleave.bjui.datagrid",function(e){var i=t(this),n=i.index();i.removeClass("datagrid-hover"),a.$tbody.find("> tr:eq("+n+")").removeClass("datagrid-hover")}),i.contextMenuB&&e.each(function(){a.tools.contextmenuB(t(this),!0)})}},a.prototype.filterInThead=function(e){var a=this,i=a.options,n=a.tools,o=a.regional,s=a.columnModel,r=t(e?'<ul class="datagrid-thead-dialog-view-ul"></ul>':'<tr class="datagrid-filter"></tr>'),l=function(t,e,i){var n,o=e.type;i.isTag("th")?n=a.$headFilterUl&&a.$headFilterUl.find("> li.li-"+e.index):i.isTag("li")&&(n=a.$thead.find("> tr.datagrid-filter > th:eq("+e.index+")")),n&&(t.val(n.find("input").val()),t.isTag("select")&&t.val(n.find("select").val()).selectpicker("refresh")),"date"===o?t.change(function(){d(e,t.val())}):"findgrid"===o?t.change(function(){d(e,t.val())}):"tags"===o?(i.on("aftercreated.bjui.tags",'[data-toggle="tags"]',function(t,a){d(e,a.value)}),t.change(function(){d(e,t.val())})):t.change(function(){d(e,t.val())}),t.change(function(){i.isTag("th")&&!n&&(n=a.$headFilterUl&&a.$headFilterUl.find("> li.li-"+e.index)),n&&n.find("input").val(t.val()),t.isTag("select")&&n&&n.find("select").val(t.val()).selectpicker("refresh")})},d=function(t,e){n.quickFilter(t,e?{operatorA:"like",valA:e}:null)},c="object"==typeof i.initFilter&&i.initFilter;a.inputs&&a.inputs.length||n.initEditInputs(),t.each(s,function(i,n){if(e&&(n===a.linenumberColumn||n===a.checkboxColumn||n===a.editBtnsColumn||n===a.childColumn))return!0;var s=t(a.inputs[i]),d=t(e?"<li></li>":"<th></th>"),u="";return n.quickfilter?("findgrid"===n.type?s.data("context",r):"spinner"===n.type?s=t('<input type="text" name="'+n.name+'">'):"boolean"===n.type?s=t(BJUI.doRegional('<select name="'+n.name+'" data-toggle="selectpicker"><option value="">#all#</option><option value="true">#true#</option><option value="false">#false#</option></select>',o)):"select"===n.type&&(n.attrs&&"object"==typeof n.attrs&&t.each(n.attrs,function(t,e){u+=" "+t+"="+e}),!s.find("> option:first-child").val()||n.attrs&&n.attrs.multiple||(s=t('<select name="'+n.name+'" data-toggle="selectpicker"'+u+"></select>").append(BJUI.doRegional('<option value="">#all#</option>',o)).append(s.html()),s.val(""))),e&&d.data("index",i).addClass("li-"+i).append('<a href="javascript:;" class="datagrid-thead-dialog-sort" title="'+BJUI.getRegional("datagrid.asc")+"/"+BJUI.getRegional("datagrid.desc")+'">'+n.label+"</a>"),d.append(s),n.hidden&&d.hide(),"boolean"!==n.type||e||d.attr("align","center"),d.appendTo(r),s.data("clearFilter",!1),l(s,n,d),s.on("clearfilter.bjui.datagrid.thead",function(){s.val(""),("boolean"===n.type||"select"===n.type)&&s.selectpicker("refresh")}),n.$quickfilter=s,void(c&&"undefined"!=typeof c[n.name]&&a.tools.initFilter(s,n))):(d.appendTo(r),!0)}),e?(r.prepend("<li><label>"+BJUI.getRegional("datagrid.asc")+"/"+BJUI.getRegional("datagrid.desc")+'</label><span class="quicksort-title">'+BJUI.getRegional("datagrid.filter")+"</span></li>"),r.hide().appendTo(a.$grid).initui(),a.$headFilterUl=r,a.sortModels=a.sortModels?a.sortModels:[],r.off("click.datagrid.thead.quicksort").on("click.datagrid.thead.quicksort","a.datagrid-thead-dialog-sort",function(e){var i=t(this),n=a.columnModel[i.closest("li").data("index")],o=[];i.find("> i").remove(),a.tools.quickSort(n),n.sortDesc?(i.append('<i class="fa fa-long-arrow-down"></i>'),a.sortModels[n.index]=n):n.sortAsc?(i.append('<i class="fa fa-long-arrow-up"></i>'),a.sortModels[n.index]=n):delete a.sortModels[n.index],(!a.sortData||t.isEmptyObject(a.sortData))&&(a.sortModels=[]),t.each(a.sortModels,function(t,e){e&&o.push('<i class="datagrid-sort-i fa fa-long-arrow-'+(e.sortAsc?"up":"down")+'"></i> '+e.label)}),a.$boxH.find(".datagrid-thead-dialog-filter-msg > .msg-sort").html(o.length>0?o.join("<em>&nbsp;&gt;&nbsp;</em>"):"")})):r.appendTo(a.$thead).initui()},a.prototype.showLinenumber=function(e){var a,i=this,n=i.options,o=i.columnModel,s=-1,r=(i.data,t.inArray(i.linenumberColumn,o));if(-1!=r&&(a=o[r]),a)"string"!=typeof e||"lock"!==e&&"unlock"!==e?i.showhideColumn(a.th,e?!0:!1):i.colLock(a.th,"lock"===e?!0:!1);else if(e){s=t.inArray(i.childColumn,o),s++,a=i.linenumberColumn,a.index=s,o.splice(s,0,a),i.inputs&&i.inputs.length&&(i.inputs=i.inputs.splice(s,0,""));var l,d=i.$thead.find("> tr"),c='<col style="width:30px;">',u=d.filter(".datagrid-filter"),p=d.length-u.length;l=t('<th align="center"'+(p>1?' rowspan="'+p+' "':"")+'class="'+i.classnames.td_linenumber+(1==p?" single-row":"")+'"><div><div class="datagrid-space"></div><div class="datagrid-label">'+i.linenumberColumn.label+"</div></div></th>"),i.$colgroupH.find("> col:eq("+s+")").before(c),i.$colgroupB.find("> col:eq("+s+")").before(c),i.$colgroupF&&i.$colgroupF.find("> col:eq("+s+")").before(c),u.length&&u.find("> th:eq("+s+")").before("<th></th>"),d.first().find("> th:eq("+s+")").before(l),i.$tableF&&i.$tableF.find("> thead > tr > th:eq("+s+")").before("<th></th>"),a.th=l,a.width=30,i.$tbody.find("> tr").each(function(e){var a=t(this),o=i.columnModel.length,r=e,l=i.paging;a.hasClass(i.classnames.tr_child)||a.hasClass("datagrid-nodata")?a.find("> td").attr("colspan",o):(r=i.tools.getNoChildDataIndex(r),n.linenumberAll&&(r=(l.pageCurrent-1)*l.pageSize+r),a.find("> td:eq("+s+")").before('<td align="center" class="'+i.classnames.td_linenumber+'">'+(r+1)+"</td>"))}),i.$tableF&&i.$tableF.find("> thead > tr > th:eq("+s+")").before("<th></th>"),t.each(o,function(t,e){e.index=t,e.th&&e.th.data("index",t)}),l.find("> div").height(l.outerHeight()),"lock"===e&&i.colLock(l,!0),i.$showhide&&(i.$showhide.remove(),i.colShowhide(n.columnShowhide))}},a.prototype.showCheckboxcol=function(e){var a,i=this,n=i.options,o=i.columnModel,s=(o[0],-1),r=t.inArray(i.checkboxColumn,o);if(-1!=r&&(a=i.columnModel[r]),a)"string"!=typeof e||"lock"!==e&&"unlock"!==e?i.showhideColumn(a.th,e):i.colLock(a.th,"lock"===e?!0:!1);else if(e){s=t.inArray(i.linenumberColumn,o),-1==s&&(s=t.inArray(i.childColumn,o)),s++,a=i.checkboxColumn,a.index=s,o.splice(s,0,a),i.inputs&&i.inputs.length&&(i.inputs=i.inputs.splice(s,0,""));var l,d,c=i.$thead.find("> tr"),u='<col style="width:30px;">',p=c.filter(".datagrid-filter"),h=c.length-p.length;l=t('<th align="center"'+(h>1?' rowspan="'+h+' "':"")+'class="'+i.classnames.td_checkbox+(1==h?" single-row":"")+'"><div><div class="datagrid-space"></div><div class="datagrid-label"><input type="checkbox" data-toggle="icheck"></div></th>'),i.$colgroupH.find("> col:eq("+s+")").before(u),i.$colgroupB.find("> col:eq("+s+")").before(u),i.$colgroupF&&i.$colgroupF.find("> col:eq("+s+")").before(u),p.length&&p.find("> th:eq("+s+")").before("<th></th>"),c.first().find("> th:eq("+s+")").before(l),i.$tableF&&i.$tableF.find("> thead > tr > th:eq("+s+")").before("<th></th>"),l.initui(),a.th=l,a.width=30,i.$tbody.find("> tr").each(function(e){var a=t(this),n=i.columnModel.length;a.hasClass(i.classnames.tr_child)||a.hasClass("datagrid-nodata")?a.find("> td").attr("colspan",n):(d=t('<td align="center" class="'+i.classnames.td_checkbox+'"><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox"></td>'),a.find("> td:eq("+s+")").before(d),d.initui())}),t.each(o,function(t,e){e.index=t,e.th&&e.th.data("index",t)}),l.find("> div").height(l.outerHeight()),"lock"===e&&i.colLock(l,!0),i.$showhide&&(i.$showhide.remove(),i.colShowhide(n.columnShowhide))}},a.prototype.showEditCol=function(e){var a=this,i=a.options,n=a.columnModel,o=n[n.length-1];a.data;if(o===a.editBtnsColumn)a.showhideColumn(o.th,e?!0:!1);else if(e){var s,r,l=a.$thead.find("> tr"),d='<col style="width:110px;">',c=l.filter(".datagrid-filter"),u=l.length-c.length;o=a.editBtnsColumn,n.push(o),a.$colgroupH.append(d),a.$colgroupB.append(d),a.$colgroupF&&a.$colgroupF.append(d),s=t('<th align="center" rowspan="'+u+'">'+a.editBtnsColumn.label+"</th>"),l.first().append(s),c.length&&c.append("<th></th>"),s.initui().data("index",n.length-1),o.th=s,o.width=110,o.index=n.length-1,a.$tbody.find("> tr").each(function(e){var i=t(this),n=a.columnModel.length;i.hasClass(a.classnames.tr_child)||i.hasClass("datagrid-nodata")?i.find("> td").attr("colspan",n):(r=t('<td align="center" class="'+a.classnames.s_edit+'">'+BJUI.doRegional(FRAG.gridEditBtn,a.regional)+"</td>"),i.append(r),r.initui())}),a.edit(a.$tbody.find("> tr")),a.$tableF&&a.$tableF.find("> thead > tr").append("<th></th>"),a.$showhide&&(a.$showhide.remove(),a.colShowhide(i.columnShowhide))}},a.prototype.colResize=function(){var e=this,a=e.tools,i=e.columnModel,n=e.$thead,o=e.$grid.find("> .resizeProxy");o.length||(o=t('<div class="resizeProxy" style="left:0; display:none;"></div>'),o.appendTo(e.$grid)),n.find("> tr > th").each(function(n){var s=t(this),r=s.find("> div > ."+e.classnames.th_cell+"> ."+e.classnames.th_resizemark);r.on("mousedown.bjui.datagrid.resize",function(n){var r,l,d,c=e.$boxH.scrollLeft(),u=parseInt(e.$boxH.css("marginLeft")||0,10),p=s.data("index"),h=i[p],g=h.th.width(),f=e.$tbody.find("> tr"),m=e.$lockTbody&&e.$lockTbody.find("> tr"),b=e.$lockTableB&&e.$lockTableB.height(),v=e.$tableB.height();isNaN(u)&&(u=0),r=a.getRight(s)-c+u,e.isResize=!0,h.locked&&(r=a.getRight4Lock(h.lockIndex),h.lockWidth&&(g=h.lockWidth)),o.show().css({left:r,bottom:e.$boxP?e.$boxP.outerHeight():0,cursor:"col-resize"}).basedrag({scop:!0,cellMinW:20,relObj:o,move:"horizontal",event:n,stop:function(){var a=o.position().left,i=a-r,n=i+g,s=e.$tableH.width()+i,c=e.$lockTableH&&e.$lockTableH.width()+i;if(5>n&&(n=20),h.minWidth&&n<h.minWidth&&(n=h.minWidth),n!=g+i&&(s=s-i+(n-g),c=c-i+(n-g)),h.width=n,h.locked){if(c<.75*e.$grid.width()){h.lockWidth=n,e.$lockColgroupH.find("> col:eq("+p+")").width(n),e.$lockColgroupB.find("> col:eq("+p+")").width(n),e.$lockColgroupF&&e.$lockColgroupF.find("> col:eq("+p+")").width(n),e.$lockTableH.width(c),e.$lockTableB.width(c),e.$lockTableF&&e.$lockTableF.width(c);var u=e.$lockBox.width();e.$boxH.css("margin-left",u-1),e.$boxB.css("margin-left",u-1),e.$boxH.find("> div").width(e.$boxH.width()),e.$boxB.find("> div").width(e.$boxH.width()),e.$boxF&&e.$boxF.css("margin-left",u-1),e.$colgroupH.find("> col:eq("+p+")").width(n),e.$colgroupB.find("> col:eq("+p+")").width(n),e.$colgroupF&&e.$colgroupF.find("> col:eq("+p+")").width(n)}}else setTimeout(function(){e.$colgroupH.find("> col:eq("+p+")").width(n),e.$colgroupB.find("> col:eq("+p+")").width(n),e.$colgroupF&&e.$colgroupF.find("> col:eq("+p+")").width(n)},1);setTimeout(function(){f.css("height",""),d=e.$tableB.height(),e.$lockTbody&&(m.css("height",""),l=e.$lockTableB.height(),(l!=b||d!=v)&&(l>d?m.each(function(e){var a=t(this),i=a.find("> td:eq("+h.lockIndex+")"),n=i.outerHeight();n>30&&(a.height(n),f.eq(e).height(n))}):f.each(function(e){var a=t(this),i=a.find("> td:eq("+p+")"),n=i.outerHeight();n>30&&(a.height(n),m.eq(e).height(n))})),e.$lockB.height(e.$boxB[0].clientHeight)),h.calc&&e.$tfoot&&e.$tfoot.trigger("resizeH.bjui.datagrid.tfoot"),e.isResize=!1},10),o.hide(),e.resizeFlag=!0}})})})},a.prototype.colMenu=function(){var e=this,a=e.options,i=e.tools,n=e.regional,o=e.$trsH.find("> th."+e.classnames.th_menu),s=e.$grid.find("> ."+e.classnames.s_menu);s.legnth||(s=t(BJUI.doRegional(FRAG.gridMenu,n)),s.hide().appendTo(e.$grid),e.$menu=s),e.colShowhide(a.columnShowhide),o.each(function(){var n,o=t(this),r=o.data("index"),l=e.columnModel[r],d=o.find("> div > ."+e.classnames.th_cell),c=d.find("> ."+e.classnames.btn_menu);c.length||(n=t('<button type="button" class="btn btn-default"><i class="fa fa-bars"></button>'),c=t('<div class="'+e.classnames.btn_menu+'"></div>').append(n),c.appendTo(d),n.click(function(){var r,d,c=(o.closest("tr"),parseInt(o.attr("rowspan")||1,10)),u=t(this).offset().left-e.$grid.offset().left-1,p=25*(e.$trsH.length-c)+13*c+11,h=s.find("> ul > li.datagrid-li-showhide"),g=s.data("bjui.datagrid.menu.btn");
g&&g.length&&g.removeClass("active"),t(this).addClass("active"),h.length&&e.$showhide&&(e.$showhide.appendTo(h),d=e.$showhide.data("width")),s.css({position:"absolute",top:p,left:u}).show().data("bjui.datagrid.menu.btn",n).siblings("."+e.classnames.s_menu).hide(),r=s.outerWidth();var f=function(t){e.$boxH.width()-t<r?s.css({left:t-r+18}).addClass("position-right"):s.css({left:t}).removeClass("position-right")},m=function(t){e.$boxB.scroll(function(){var a=t.offset().left-e.$grid.offset().left-1;f(a)})};f(u),m(n),a.columnFilter?e.colFilter(o):s.find("> ul > li."+e.classnames.li_filter).hide(),i.locking(o);var b=s.find("> ul > li."+e.classnames.li_asc),v=b.next();b.off("click.bjui.datagrid.sort").on("click.bjui.datagrid.sort",function(){l.sortDesc?l.sortDesc=!1:l.sortAsc=!1,i.quickSort(l)}),v.off("click.bjui.datagrid.sort").on("click.bjui.datagrid.sort",function(){l.sortAsc?l.sortDesc=!1:l.sortAsc=!0,i.quickSort(l)}),s.on("sort.bjui.datagrid.th",function(t,e){b.toggleClass("sort-active",e),v.toggleClass("sort-active",!e)})}))}),e.$grid.on("click.bjui.datagrid.filter",function(a){var i=t(a.target),n=e.$grid.find("."+e.classnames.s_menu+":visible");n.length&&!i.closest("."+e.classnames.btn_menu).length&&(i.closest("."+e.classnames.s_menu).length||n.hide().data("bjui.datagrid.menu.btn").removeClass("active"))})},a.prototype.colShowhide=function(t){var e=this,a=(e.options,e.tools),i=e.$menu,n=i.find("> ul"),o=n.find("> li."+e.classnames.li_showhide);t?e.$showhide||(a.createShowhide(),a.showSubMenu(o,i,e.$showhide)):o.hide()},a.prototype.showhideColumn=function(e,a){var i,n,o=this,s=o.tools;if("number"===t.type(e)){if(i=parseInt(e,10),0>i)return}else i=e.data("index");if(n=o.columnModel[i]){if(n.locked){if(a)return;o.colLock(n.th,a)}s.showhide(n,a)}},a.prototype.colFilter=function(e,a){var i=this,n=(i.options,i.tools),o=i.regional,s=e.data("bjui.datagrid.filter"),r=i.$menu,l=r.find("> ul > li."+i.classnames.li_filter),d=i.columnModel[e.data("index")];if(i.inputs&&i.inputs.length||n.initEditInputs(),d.quickfilter){if(l.show().find("."+i.classnames.s_filter).addClass("hide"),!s||!s.length){s=t(BJUI.doRegional(FRAG.gridFilter.replaceAll("#label#",e.text()),o)).hide().appendTo(i.$grid);var c,u,p=e.data("index"),d=i.columnModel[p],h=d.type||"string",g=d.operator||[],f=s.find("span.filter-a"),m=s.find("span.filter-b"),b=t('<select data-toggle="selectpicker" data-container="true"></select>'),v=t(i.inputs[p]);v.removeAttr("data-rule").attr("size",10).addClass("filter-input"),"string"===h||"findgrid"===h||"tags"===h?(g.length||(g=["=","!=","like"]),"findgrid"===h&&v.data("context",s)):"number"===h||"int"===h||"spinner"===h?("spinner"===h&&v.removeAttr("data-toggle"),g.length||(g=["=","!=",">","<",">=","<="])):"date"===h?g.length||(g=["=","!="]):"boolean"===h?(g.length||(g=["=","!="]),v=t(BJUI.doRegional('<select name="'+d.name+'" data-toggle="selectpicker"><option value="">#all#</option><option value="true">#true#</option><option value="false">#false#</option></select>',o))):"select"===h&&(g.length||(g=["=","!="]),v.attr("data-width","80"),v.find("> option:first-child").val()&&(v=t('<select name="'+d.name+'" data-toggle="selectpicker" data-width="80"></select>').append(BJUI.doRegional('<option value="">#all#</option>',o)).append(v.html())));for(var y=0,x=g.length;x>y;y++)b.append('<option value="'+g[y]+'">'+g[y]+"</option>");c=v,u=c.clone(),f.append(b).append(v),m.append(b.clone()).append(u),e.data("bjui.datagrid.filter",s),s.appendTo(l),s.data("width",s.outerWidth()).hide().initui();var k=s.find("button.ok"),C=s.find("button.clear"),j=s.find("select"),$=j.first(),w=j.last(),T=j.eq(1);k.click(function(){var a=$.val(),o=c.val().trim(),d=w.val(),p=u.val().trim(),h=T.val(),g={};o.length&&t.extend(g,{operatorA:a,valA:o}),p.length&&(o.length&&t.extend(g,{andor:h}),t.extend(g,{operatorB:d,valB:p})),t.isEmptyObject(g)?C.trigger("click"):(n.quickFilter(i.columnModel[e.data("index")],g),i.$grid.trigger("click"),l.trigger("hidesubmenu.bjui.datagrid.th",[r,s]))}),C.click(function(){var t=i.columnModel[e.data("index")];j.find("> option:first").prop("selected",!0),j.selectpicker("refresh"),c.val(""),u.val(""),t.isFiltered&&(n.quickFilter(t,null),i.$grid.trigger("click"),l.trigger("hidesubmenu.bjui.datagrid.th",[r,s]))})}n.showSubMenu(l,r,s.removeClass("hide")),r.find('> ul > li:not(".'+i.classnames.li_filter+'")').on("mouseover",function(){l.hasClass("active")&&l.trigger("hidesubmenu.bjui.datagrid.th",[r,s])})}else l.hide()},a.prototype.initPaging=function(){var e,a=this,i=a.tools,n=(a.options,a.paging),o=BJUI.regional.pagination,s=FRAG.gridPaging,r=[],l=n.pageCount,d=[],c=BJUI.StrBuilder();e=i.getPageInterval(l,n.pageCurrent,n.showPagenum);for(var u=e.start;u<e.end;u++)r.push(FRAG.gridPageNum.replace("#num#",u).replace("#active#",n.pageCurrent==u?" active":""));s=BJUI.doRegional(s.replaceAll("#pageCurrent#",n.pageCurrent).replaceAll("#count#",n.total+"/"+parseInt(l||0,10)),o),c.add('<div class="paging-content" style="width:'+a.$boxB.width()+'px;">').add('<span></span><div class="paging-pagesize"><button type="button" class="btn-default btn-refresh" title="'+o.refresh+'" data-icon="refresh"></button>').add('<select data-toggle="selectpicker"></select>').add("</div>").add('<div class="paging-box">').add(s.replace("#pageNumFrag#",r.join(""))).add("</div>").add("</div>"),a.$boxP.html(c.toString()),a.$boxP.initui();var p=a.$boxP.find("div.paging-pagesize > select"),h=a.$boxP.find("ul.pagination"),g=h.find("> li.page-total"),f=g.next(),m=f.next(),b=m.next(),v=b.nextAll(".page-next"),y=v.next(),x=function(){m.addClass("disabled"),b.addClass("disabled")},k=function(){m.removeClass("disabled"),b.removeClass("disabled")},C=function(){v.addClass("disabled"),y.addClass("disabled")},j=function(){v.removeClass("disabled"),y.removeClass("disabled")},$=function(){x(),j()},w=function(){k(),C()},T=function(e){p.empty(),e||(e=a.paging.pageSize),d=n.selectPageSize.split(","),d.push(String(e)),t.unique(d).sort(function(t,e){return t-e});var i=[];t.each(d,function(t,e){i.push('<option value="'+e+'"'+(e==n.pageSize&&"selected")+">"+e+"/"+o.page+"</option>")}),p.html(i.join("")).selectpicker("refresh")};1==n.pageCurrent&&$(),n.pageCurrent==n.pageCount&&(w(),1==n.pageCurrent&&x()),n.total||C(),T(),a.$boxP.on("click.datagrid.pagenum","li.page-num",function(e){var i=t(this);i.hasClass("active")||a.jumpPage(i.text()),e.preventDefault()}).on("click.datagrid.refresh","button.btn-refresh",function(){a.refresh()}).on("bjui.datagrid.paging.jump",function(t){for(var e=a.paging.pageCurrent,o=i.getPageInterval(a.paging.pageCount,e,n.showPagenum),s=[],r=o.start;r<o.end;r++)s.push(FRAG.gridPageNum.replace("#num#",r).replace("#active#",e==r?" active":""));h.find("> li.page-num").remove(),b.after(s.join("")),1==e?($(),e==a.paging.pageCount&&C(),a.paging.total||C()):e==a.paging.pageCount?w():(k(),j()),f.find("input").val(e),g.find("> span").html(a.paging.total+"/"+a.paging.pageCount)}).on("bjui.datagrid.paging.pageSize",function(t,e){T(e)}).on("change","div.paging-pagesize > select",function(){var e=t(this).val();a.jumpPage(null,e)}),f.find("input").on("keyup",function(e){if(e.which===BJUI.keyCode.ENTER){var i=t(this).val();i&&a.jumpPage(i)}}),m.on("click",function(){a.paging.pageCurrent>1&&a.jumpPage(1)}),b.on("click",function(){a.paging.pageCurrent>1&&a.jumpPage(a.paging.pageCurrent-1)}),v.on("click",function(){a.paging.pageCurrent<a.paging.pageCount&&a.jumpPage(a.paging.pageCurrent+1)}),y.on("click",function(){a.paging.pageCurrent<a.paging.pageCount&&a.jumpPage(a.paging.pageCount)})},a.prototype.jumpPage=function(t,e){var a=this,i=a.paging,n=i.pageCount;t&&isNaN(t)||e&&isNaN(e)||t&&(t=parseInt(t,10),1>t&&(t=1),t>n&&(t=n),t==i.pageCurrent)||e&&(e=parseInt(e,10),"remote"!=a.options.local&&i.pageSize>i.total)||a.tools.jumpPage(t,e)},a.prototype.add=function(e,a,i){if(this.tools.beforeEdit()||i){if(!this.options.editUrl&&!i)return void BJUI.debug("BJUI.Datagrid: Edit url is not set!");if(this.options.editMode||i){if(this.options.inlineEditMult){if(!i&&"inline"!=this.options.editMode&&this.$tbody.find("> tr."+this.classnames.tr_add).length)return}else this.doCancelEditRow(this.$tbody.find("> tr."+this.classnames.tr_edit));a?("string"==typeof a&&(a=a.toObj()),"object"!=typeof a&&(a={})):a={};var n,o,s=this,r=s.options,l=r.keys,d=(s.tools,s.paging),c={},u=(d.pageCurrent-1)*d.pageSize,p=function(){var e=t("<tr></tr>").addClass(s.classnames.tr_add),a=e.clone();if(s.isTemplate){var i=r.tdTemplate,n=s.columnModel.length;"function"==typeof i&&(i=i.apply(s,[{}])),s.options.hasChild&&s.options.childOptions&&(e.append('<td data-title="..." align="center" class="datagrid-child-td"><div>'+BJUI.doRegional(FRAG.gridExpandBtn,s.regional)+"</div></td>"),n--),s.options.showLinenumber&&(e.append('<td data-title="No." align="center" class="datagrid-linenumber-td">0</td>'),n--),s.options.showCheckboxcol&&(e.append('<td data-title="Checkbox" align="center" class="datagrid-checkbox-td"><div><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox" value="true"></div></td>'),n--),e.append('<td class="datagrid-template-td" colspan="'+n+'">'+i+"</td>")}else t.each(s.columnModel,function(i,n){var o=t("<td></td>");n[l.gridChild]?o.addClass(s.classnames.td_child).html("<div>"+BJUI.doRegional(FRAG.gridExpandBtn,s.regional)+"</div>"):n[l.gridNumber]?o.addClass(s.classnames.td_linenumber).text(0):n[l.gridCheckbox]?o.addClass(s.classnames.td_checkbox).html('<div><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox" value="true"></div>'):n[l.gridEdit]?o.addClass(s.classnames.s_edit).data("isAdd",!0).html(BJUI.doRegional(FRAG.gridEditBtn,s.regional)):o.text(""),n.hidden&&o.css("display","none"),n.align&&o.attr("align",n.align),n.name&&(c[n.name]=""),n.locked?n[l.gridCheckbox]?(o.clone().hide().appendTo(e),o.show().appendTo(a)):(o.clone().show().appendTo(a),o.hide().appendTo(e)):o.appendTo(e)});return c=t.extend({},s.attach,c),s.emptyData||(s.emptyData=c),{tr:e,lockTr:a.find("> td").length?a:null}};if(e||(e=r.addLocation||"first"),s.$lastSelect||("prev"===e?e="first":"next"===e&&(e="last")),-1===t.inArray(e,["first","last","prev","next"])&&(e="first"),r.isTree&&s.$lastSelect){"first"!==e&&"last"!==e&&(e="first");var h=s.data[s.tools.getNoChildDataIndex(s.$lastSelect.index())];h?(a[r.treeOptions.keys.level]=h[r.treeOptions.keys.level]+1,a[r.treeOptions.keys.parentKey]=h[r.treeOptions.keys.key],a[r.keys.treePTr]=s.$lastSelect,a[r.keys.treePData]=h):a.level=0}if("first"===e)o=0,n=p(),r.isTree&&s.$lastSelect?(o=s.tools.getNoChildDataIndex(s.$lastSelect.index())+1,s.$lastSelect.next().hasClass(s.classnames.tr_child)?(n.tr.insertAfter(s.$lastSelect.next()),n.lockTr&&n.lockTr.insertAfter(s.$lockTbody.find("> tr:eq("+s.$lastSelect.next().index()+")"))):(n.tr.insertAfter(s.$lastSelect),n.lockTr&&n.lockTr.insertAfter(s.$lockTbody.find("> tr:eq("+s.$lastSelect.index()+")")))):(n.tr.prependTo(s.$tbody),n.lockTr&&n.lockTr.prependTo(s.$lockTbody));else if("last"===e)if(o=s.$tbody.find("> tr").length,n=p(),r.isTree&&s.$lastSelect){var g,f=s.$lastSelect.data("child")||0,m=(s.$lastSelect.data("level"),s.$lastSelect.next().hasClass(s.classnames.tr_child));g=s.getChildrens(s.$lastSelect,s.$lastSelect).last(),m?(n.tr.insertAfter(g.next()),n.lockTr&&n.lockTr.insertAfter(s.$lockTbody.find("> tr:eq("+g.next().index()+")"))):(n.tr.insertAfter(g),n.lockTr&&n.lockTr.insertAfter(s.$lockTbody.find("> tr:eq("+g.index()+")"))),o=s.tools.getNoChildDataIndex(g.index())+1,a[r.treeOptions.keys.order]=f}else n.tr.appendTo(s.$tbody),n.lockTr&&n.lockTr.appendTo(s.$lockTbody);else"prev"===e?(o=s.tools.getNoChildDataIndex(s.$lastSelect.index()),n=p(),n.tr.insertBefore(s.$lastSelect),n.lockTr&&n.lockTr.insertBefore(s.$lockTbody.find("> tr:eq("+s.$lastSelect.index()+")"))):"next"===e&&(o=s.tools.getNoChildDataIndex(s.$lastSelect.index())+1,n=p(),s.$lastSelect.next().hasClass(s.classnames.tr_child)?(n.tr.insertAfter(s.$lastSelect.next()),n.lockTr&&n.lockTr.insertAfter(s.$lockTbody.find("> tr:eq("+s.$lastSelect.next().index()+")"))):(n.tr.insertAfter(s.$lastSelect),n.lockTr&&n.lockTr.insertAfter(s.$lockTbody.find("> tr:eq("+s.$lastSelect.index()+")"))));a=t.extend({},s.emptyData,a,{addFlag:!0}),s.data||(s.data=[]),s.allData||(s.allData=[]),s.allData.length?s.allData.splice(o+u,0,a):s.allData.push(a),s.data.length?s.data.splice(o,0,a):s.data.push(a),s.tools.updateGridIndex(),n.tr.initui(),n.lockTr&&n.lockTr.initui(),a[r.keys.treePTr]&&n.tr.data(r.keys.treePTr,a[r.keys.treePTr]),r.showNoDataTip&&s.$tbody.find("> tr.datagrid-nodata").remove(),"auto"===r.height&&s.fixedHeight(),setTimeout(function(){s.initEvents(n.tr)},20),n.lockTr&&s.initLockEvents(n.lockTr),s.edit(n.tr),r.hasChild&&r.childOptions&&n.tr.after('<tr class="'+s.classnames.tr_child+'"></tr>'),i?(s.inlineEditComplete(n.tr,a),1==s.data.length&&(s.needfixedWidth=!0),s.tools.afterSave(n.tr,a)):"dialog"!=r.editMode?s.doEditRow(n.tr,"inline",!0):s.dialogEdit(n.tr,!0)}}},a.prototype.edit=function(e){var a,i=this,n=i.options,o=i.tools,s=n.editMode;i.columnModel;if(i.editInit=!1,s){if("object"==typeof s){var r={},l=["dialog","navtab","div"],d=!1;i.editOptions=null;for(var c in s)if(-1!=t.inArray(c,l)){r.type=c,r.options=s[c],d=!0;break}if(!d)return void BJUI.debug("Dialog Plugn: The options 'editModel' set error!");t.isEmptyObject(r)||(i.editOptions=r)}else i.options.editUrl&&(i.options.editUrl=i.options.editUrl.replace(/{\/?[^}]*}/g,"")),"dialog"!=s&&(s="inline");e||(e=i.$tbody.find("> tr")),a=e.find("> td."+i.classnames.s_edit),i.editInit=!0,a.each(function(){var e=t(this),a=e.find("button.bjui-datagrid-btn"),n=a.first(),r=n.next(),l=r.next(),d=l.next(),c=d.next();n.on("click",function(n,c){var u=t(this),p=u.closest("tr"),h=p.index(),g=e.data("isAdd");return h=i.tools.getNoChildDataIndex(h),c||(c=i.isDom?p.data("initData")||o.setDomData(p):i.data[h]),o.beforeEdit(p,c)?i.editOptions?(i.externalEdit(p,null,c),!1):("dialog"!=s?(i.inlineEdit(p,g),a.hide(),r.show(),d.show(),g&&(r.hide(),l.show())):i.dialogEdit(p,g),void n.stopPropagation()):!1}),l.on("click",function(e){var a=t(this),n=a.closest("tr");i.updateEdit(n,a),e.stopPropagation()}).on("bjui.datagrid.update.tr",function(){a.hide(),n.show(),c.show()}),r.on("click",function(e){var a=t(this),n=a.closest("tr");i.updateEdit(n,a),e.stopPropagation()}).on("bjui.datagrid.update.tr",function(){a.hide(),n.show(),c.show()}),d.on("click",function(e){var o=t(this),s=o.closest("tr");i.cancelEdit(s),a.hide(),n.show(),c.show(),e.stopPropagation()}),c.on("click",function(e){var a=t(this),n=a.closest("tr");i.delRows(n),e.stopPropagation()})})}},a.prototype.externalEdit=function(e,a,i){var n,o,s,r,l=this,d=l.options,c={},u=["dialog","navtab","div"];if(a&&"object"==typeof a){for(var p in a)if(-1!=t.inArray(p,u)){c.type=p,c.options=a[p];break}}else c=t.extend({},l.editOptions);if(e instanceof jQuery)n=e;else{if(isNaN(e))return void BJUI.debug("BJUI.Datagrid: Func 'externalEdit', Parameter 'row' is incorrect!");n=l.$tbody.find("> tr:not(."+l.classnames.tr_child+")").eq(parseInt(e,10))}if("undefined"==typeof c)return void BJUI.debug("BJUI.Datagrid: Func 'externalEdit', Parameter 'editOptions' is incorrect!");if(!t.isEmptyObject(c)&&(i||(l.isDom?i=n.data("initData")||l.tools.setDomData(n):(o=l.tools.getNoChildDataIndex(n.index()),i=l.data[o])),(!c.options.url||c.options["datagrid.nourl"])&&(c.options["datagrid.nourl"]=!0,c.options.url=d.editUrl),s=c.options.url,s&&!s.isFinishedTm()&&(s=!i||i.addFlag?s.replace(/{\/?[^}]*}/g,""):l.tools.replacePlh(s,i),s.isFinishedTm()?s=s:BJUI.debug("BJUI.Datagrid: Func 'externalEdit', the property 'url' of options 'editOptions' is incorrect: "+s)),s)){c.options.url=s,r=c.type,"object"==typeof i&&i&&(c.options.data?t.extend(c.options.data,i):c.options.data=t.extend({},i));for(var p in d.keys)delete c.options.data[p];c.options.id||(c.options.id="datagrid-external-edit"+(new Date).getTime()),c.options.type||(c.options.type=d.editType),"undefined"==typeof d.extOnClose&&(d.extOnClose=c.options.onClose&&c.options.onClose.toFunc()||!1),c.options.onClose=function(){n.hasClass(l.classnames.tr_add)&&l.cancelEdit(n),"undefined"!=typeof d.extOnClose&&d.extOnClose&&d.extOnClose.apply(l)};var h=function(e){var a,o=!1;if(c.options.data.addFlag&&1==l.data.length&&(l.needfixedWidth=!0),"array"===t.type(e)?(o=!0,a=e[0]):"object"==typeof e&&(o=!0,a=e),o&&(t.extend(i,"object"==typeof a&&a),l.allData&&l.allData[i.gridIndex]&&t.extend(l.allData[i.gridIndex],i),l.oldAllData&&(l.oldAllData=l.allData.concat()),i.addFlag&&(i.addFlag=!1),l.dialogEditComplete(n,i),"dialog"===r?(c.options.message&&BJUI.alertmsg("ok",c.options.message),("undefined"==typeof c.options.closeCurrent||c.options.closeCurrent)&&BJUI.dialog("close",c.options.id)):"navtab"===r&&BJUI.navtab("closeTab",c.options.id),l.tools.afterSave(n,i),i["refresh.datagrid.child"])){var s=n.data("bjui.datagrid.child");s&&s.length?s.datagrid("refresh"):l.showChild(n)}};c.options.onLoad=function(e){var a=e.find("form.datagrid-edit-form");a&&a.length&&(a=a.first(),a.removeAttr("okCallback").data("okCallback",t.proxy(h,l)))},"dialog"===r?BJUI.dialog(c.options):"navtab"===r?BJUI.navtab(c.options):"div"===r&&BJUI.ajax("doload",c.options)}},a.prototype.doEditRow=function(e,a,i){if(this.editInit){var n,o,s=this,r=[];if(a=a||s.options.editMode,"object"==typeof e)n=e;else if(isNaN(e)){var l,d=s.$tbody.find("> tr:not(."+s.classnames.tr_child+")"),e=e.split(",");e=e.unique(),e.sort(function(t,e){return t.trim()-e.trim()}),t.each(e,function(t,e){var a,i=parseInt(e.trim(),10);a=d.eq(i),a&&a.length&&(l=l?l.add(a):a)}),n=l}else isNaN(e)||(n=s.$tbody.find("> tr:not(."+s.classnames.tr_child+")").eq(e));if(n.length&&(n.each(function(){var e,a=t(this),i=a.index();i=s.tools.getNoChildDataIndex(i),e=s.isDom?a.data("initData")||tools.setDomData(a):s.data[i],r.push(e)}),s.tools.beforeEdit(n,r)))return s.options.editUrl?void(s.editOptions?s.externalEdit(n.last(),null,r[n.length-1]):n.each(function(e){var n=t(this);return o=n.find("> td."+s.classnames.s_edit+" button.bjui-datagrid-btn.edit"),"dialog"==a?(s.dialogEdit(n,i,r[e]),!1):void(o.length?o.trigger("click",[r[e]]):s.inlineEdit(n,i,r[e]))})):void BJUI.debug("BJUI.Datagrid: Edit url is not set!")}},a.prototype.doCancelEditRow=function(e){var a,i=this;a="number"===t.type(e)?this.$tbody.find("> tr").eq(e):e,a.each(function(){var e=t(this),a=e.find("> td."+i.classnames.s_edit+" > button.bjui-datagrid-btn.cancel");a.length?a.trigger("click"):i.cancelEdit(e)})},a.prototype.doSaveEditRow=function(e){var a,i=this,n=i.options;return a="number"===t.type(e)?this.$tbody.find("> tr").eq(e):e?e:i.$tbody.find("> tr."+i.classnames.tr_edit),a.length?void(1==a.length?a.hasClass(i.classnames.tr_edit)&&this.updateEdit(a):n.saveAll?i.saveAll(a):a.each(function(){i.updateEdit(t(this))})):void i.$grid.alertmsg("info",BJUI.getRegional("datagrid.saveMsg"))},a.prototype.delRows=function(e){var a,i=this,n=i.options,o=n.keys,s=n.beforeDelete,r=n.delConfirm;if(!s||("string"==typeof s&&(s=s.toFunc()),"function"!=typeof s||s.call(this))){if("object"==typeof e)a=e;else if(isNaN(e)){var l,d=i.$tbody.find("> tr:not(."+i.classnames.tr_child+")"),e=e.split(",");e=e.unique(),e.sort(function(t,e){return t.trim()-e.trim()}),t.each(e,function(t,e){var a=d.eq(parseInt(e.trim(),10));a&&a.length&&(l=l?l.add(a):a)}),a=l}else isNaN(e)||(a=this.$tbody.find("> tr:not(."+i.classnames.tr_child+")").eq(e));if(a&&a.length){var c=function(){a.each(function(){var e=t(this),a=i.options.childUpdate,n=i.$element.data("bjui.datagrid.parent"),o=function(t){t.closest("table").datagrid("updateRow",t)};n&&a&&("string"==typeof a?(-1!==a.indexOf("all")||-1!==a.indexOf("del"))&&o(n):o(n)),e.trigger("delete.bjui.datagrid.tr")}),i.tools.afterDelete(),"auto"===n.height&&i.fixedHeight()},u=function(){var e=a.filter("."+i.classnames.tr_add);if(!e.length||(i.cancelEdit(e),a.not(e).length))if(n.delUrl){var s=[],r=n.delCallback;a.not(e).each(function(){var e,a,r=t(this),l=r.index();if(e=i.isDom?r.data("initData")||i.tools.setDomData(r):i.data[i.tools.getNoChildDataIndex(l)],n.delPK)s.push(e[n.delPK]);else{if(n.jsonPrefix)a={},t.each(e,function(t,e){i.tools.isGridData(t)||(a[n.jsonPrefix+"."+t]=e)});else{a=t.extend({},e);for(var d in o)delete a[o[d]]}s.push(a)}}),"string"==typeof r&&(r=r.toFunc());var l=n.delType,d={url:n.delUrl,data:n.delPK?[{name:n.delPK,value:s.join(",")}]:JSON.stringify(s),type:"POST",okCallback:r||function(t){c()}};l&&"raw"===l&&!n.delPK?d.contentType="application/json":(!n.delPK&&(d.data={json:d.data}),l&&"raw"!==l&&(d.type=l)),BJUI.ajax("doajax",d)}else c()};r?("string"!=typeof r&&(r=1==a.length?BJUI.getRegional("datagrid.delMsg"):BJUI.getRegional("datagrid.delMsgM")),i.$grid.alertmsg("confirm",r,{okCall:function(){u()}})):u()}}},a.prototype.inlineEdit=function(e,a,i){if(!this.tools.beforeEdit(e,i))return!1;var n=this,o=n.options,s=n.tools,r=n.columnModel,l=e.find("> td"),d=l.length,c=e.index(),u=c;return u=s.getNoChildDataIndex(u),i||(i=n.isDom?e.data("initData")||s.setDomData(e):n.data[u]),e.hasClass(n.classnames.tr_edit)?!1:(n.inputs&&n.inputs.length||s.initEditInputs(),e.addClass(n.classnames.tr_edit).data(n.datanames.changeData,{}),e.data("validator")&&e.validator("destroy"),o.inlineEditMult||n.doCancelEditRow(e.siblings("."+n.classnames.tr_edit)),n.$lastEditTr=e,void l.each(function(o){var s,l=t(this),u=r[o],p=u&&u.name&&i[u.name],h=l.html(),g=n.inputs[o],f=function(i,o,s){var r=e.data(n.datanames.changeData),l=u.jsontype,d="undefined"==typeof u.defaultVal?null:u.defaultVal;switch(u.type){case"date":i.change(function(){o.addClass(n.classnames.td_changed),i.val()==s&&o.removeClass(n.classnames.td_changed),r[u.name]=i.val()});break;case"select":i.change(function(){var e=t(this).val();o.addClass(n.classnames.td_changed),e==String(s)&&o.removeClass(n.classnames.td_changed),i.prop("multiple")?t.isArray(e)&&(e=e.join(",")):l&&("boolean"===l?e=Boolean(e):"number"===l&&(e.length?!isNaN(Number(e))&&(e=Number(e)):e=null)),r[u.name]=e});break;case"boolean":i.on("ifChanged",function(){o.toggleClass(n.classnames.td_changed);var e=t(this).is(":checked");e==s&&o.removeClass(n.classnames.td_changed),r[u.name]=e});break;case"findgrid":r[u.name]=i.val(),i.change(function(){var e=t(this).val();o.addClass(n.classnames.td_changed),e==s&&o.removeClass(n.classnames.td_changed),l&&"number"===l&&(e.length?!isNaN(Number(e))&&(e=Number(e)):e=null),r[u.name]=e}),o.off("afterchange.bjui.findgrid").on("afterchange.bjui.findgrid",'[data-toggle="findgrid"]',function(e,a){var i=u.attrs&&u.attrs["data-options"]&&u.attrs["data-options"].include;i&&t.each(i.split(","),function(t,e){var i=e.trim().split(":"),n=i[0],o=i.length>1?i[1]:i[0];a.data&&(r[n]=a.data[o])})});break;case"spinner":i.change(function(){o.addClass(n.classnames.td_changed),i.val()==s&&o.removeClass(n.classnames.td_changed),r[u.name]=Number(i.val())});break;default:i.change(function(){var e=t(this).val();o.addClass(n.classnames.td_changed),e==s&&o.removeClass(n.classnames.td_changed),l&&"number"===l&&(e.length?!isNaN(Number(e))&&(e=Number(e)):e=null),r[u.name]=e})}if(a){if("boolean"===u.type)d=Boolean(d),r[u.name]=d,i.prop("checked",d);else if(null!=d)i.isTag("select")&&i.prop("multiple")?i.val(t.isArray(d)?d:d.split(",")):i.val(String(d)),l&&("number"===l?d.length?!isNaN(Number(d))&&(d=Number(d)):d=null:"boolean"===l&&(d=Boolean(d))),r[u.name]=d;else if(i.isTag("select")&&!i.prop("multiple")){var c=i.clone().appendTo("body"),s=c.val();r[u.name]=s,c.remove()}}else l&&i.trigger("change")};if(l.data(n.datanames.td_html,h),a?u.add||(g=""):(i.addFlag&&(i.addFlag=!1),u.edit||(g="")),g){if(s=t(g),("undefined"==typeof p||"null"===p||null===p)&&(p=""),"boolean"===u.type?s.prop("checked",p):"findgrid"===u.type?s.data("context",e).val(String(p)):(s.val(String(p)),s.isTag("select")&&s.prop("multiple")&&p&&!t.isArray(p)&&s.val(p.split(","))),a?u.addAttrs&&"object"==typeof u.addAttrs&&t.each(u.addAttrs,function(t,e){s.attr(t,e)}):u.editAttrs&&"object"==typeof u.editAttrs&&t.each(u.editAttrs,function(t,e){s.attr(t,e)}),l.empty().append(s).addClass(n.classnames.td_edit),n.treeColumn&&n.treeColumn===u){var m=n.tools.createTreePlaceholder(i,"");l.attr("align","left").html(m),s.appendTo(l.find(".datagrid-tree-title"))}if(f(s,l,p),u.locked){var b=n.$lockTbody.find("tr:eq("+c+")"),v=b.find("> td:eq("+u.lockIndex+")");l.clone().html(h).insertAfter(l),l.show().insertAfter(v).initui(),v.remove()}}--d||e.initui().validator({msgClass:"n-bottom",theme:"red_bottom_effect_grid"})}))},a.prototype.saveAll=function(e){var a,i,n,o,s,r=this,l=r.options,d=l.keys,c=l.editCallback,u=[],p=[],h=[],g=e&&e.length;if((!e||e.length)&&(e=r.$tbody.find("> tr."+r.classnames.tr_edit),g=e.length),g&&(e.each(function(){a=t(this),n=r.tools.getNoChildDataIndex(a.index()),i=r.isDom?a.data("initData"):r.data[n],u.push(i),a.isValid(function(e){if(!e)return p=[],!1;if(o=a.data(r.datanames.changeData),t.extend(i,o),l.jsonPrefix)s={},t.each(i,function(t,e){r.tools.isGridData(t)||(s[l.jsonPrefix+"."+t]=e)});else{s=t.extend({},i);for(var n in d)delete s[d[n]]}g--,p.push(s)})}),!g))if(c=c?c.toFunc():function(o){"array"===t.type(o)?h=o:"object"==typeof o&&h.push(o),e.each(function(e){a=t(this),n=a.index(),r.columnModel[0]===r.childColumn&&(n/=2),i=r.isDom?a.data("initData"):r.data[n],t.extend(i,"object"==typeof h[e]&&h[e]),r.allData&&r.allData[i.gridIndex]&&t.extend(r.allData[i.gridIndex],i),r.oldAllData&&(r.oldAllData=r.allData.concat()),r.inlineEditComplete(a,i)}),r.tools.afterSave(e,p)},r.options.saveLocal)c(p);else if(r.tools.beforeSave(e,u)){var f=l.editType,m={url:l.editUrl,data:JSON.stringify(p),type:"POST",okCallback:c};f&&"raw"===f?m.contentType="application/json":(m.data={json:m.data},f&&(m.type=f)),BJUI.ajax("doajax",m)}},a.prototype.updateEdit=function(e,a){var i,n,o,s,r=this,l=r.options,d=l.keys,c=l.editCallback,u=[],p=[],h=e.index();h=r.tools.getNoChildDataIndex(h),i=r.isDom?e.data("initData"):r.data[h],e.hasClass(r.classnames.tr_edit)&&e.isValid(function(h){if(h){if(n=e.data(r.datanames.changeData),t.extend(i,n),l.jsonPrefix)o={},t.each(i,function(t,e){r.tools.isGridData(t)||(o[l.jsonPrefix+"."+t]=e)});else{o=t.extend({},i);for(var g in d)delete o[d[g]]}if(c=c?c.toFunc():function(n){"array"===t.type(n)?s=n[0]:"object"==typeof n&&(s=n),t.extend(i,"object"==typeof s&&s),r.allData&&r.allData[i.gridIndex]&&t.extend(r.allData[i.gridIndex],i),r.oldAllData&&(r.oldAllData=r.allData.concat()),r.inlineEditComplete(e,i,a),r.tools.afterSave(e,i)},u.push(i),r.tools.beforeSave(e,u)){p.push(o);var f=l.editType,m={url:l.editUrl,data:JSON.stringify(p),type:"POST",okCallback:c};f&&"raw"===f?m.contentType="application/json":(m.data={json:m.data},f&&(m.type=f)),BJUI.ajax("doajax",m)}}})},a.prototype.cancelEdit=function(e){var a=this,i=a.columnModel;e.each(function(){var e=t(this),n=e.index(),o=n;e.hasClass(a.classnames.tr_edit)&&e.removeClass(a.classnames.tr_edit).find("> td."+a.classnames.td_edit).each(function(){var e=t(this),o=e.index(),s=i[o],r=e.data(a.datanames.td_html);if(e.removeClass(a.classnames.td_edit).removeClass(a.classnames.td_changed).html(r),s.locked){var l=a.$lockTbody.find("tr:eq("+n+")"),d=l.find("> td:eq("+s.lockIndex+")");r=d.data(a.datanames.td_html),l.removeClass(a.classnames.tr_edit),d.removeClass(a.classnames.td_edit).removeClass(a.classnames.td_changed).html(r)}}),e.hasClass(a.classnames.tr_add)&&(o=a.tools.getNoChildDataIndex(o),a.isDom||(a.allData=a.allData.remove(a.data[o].gridIndex),a.data=a.data.remove(o),a.tools.updateGridIndex(),a.$element.data("allData",a.allData)),e.next().hasClass(a.classnames.tr_child)&&(e.next().remove(),a.$lockTbody&&a.$lockTbody.find("> tr:eq("+n+")").next().remove()),a.$lockTbody&&a.$lockTbody.find("> tr:eq("+n+")").remove(),e.remove(),a.tools.createNoDataTr(),"auto"===a.options.height&&a.fixedHeight())})},a.prototype.inlineEditComplete=function(e,i,n){var o=this,s=o.columnModel,r=e.index(),l=e.find("> td"),d=!1,c=o.$lockTbody&&o.$lockTbody.find("> tr:eq("+r+")"),u=o.options.tdTemplate,p=t.extend({},i);if(t.each(s,function(t,e){if(e===o.linenumberColumn&&(d=!0),o.tools.isGridModel(e))return!0;var n,s=e.name?i[e.name]:"",r=l.eq(e.index);if(o.isTemplate&&(r=null),("undefined"==typeof s||"null"===s||null===s)&&(s=""),r&&r.text(s).removeClass(o.classnames.td_edit).removeClass(o.classnames.td_changed),e.render&&"function"==typeof e.render?e.items?(n=e.render.call(o,s,i,e.items,e.itemattr),p[e.name]=n,r&&r.html(n)):(n=e.render.call(o,s,i),p[e.name]=n,r&&r.html(n)):e.items&&(n=a.renderItem.call(o,s,i,e.items,e.itemattr),p[e.name]=n,r&&r.html(n)),o.options.isTree&&e.hasTree&&r&&r.attr("align","left").addClass("datagrid-tree-td").html(o.tools.createTreePlaceholder(i,n||s)),e.locked&&c){var u=c.find("> td:eq("+e.lockIndex+")");u.removeClass(o.classnames.td_changed).html(r.html())}}),o.isTemplate&&("function"==typeof u&&(u=u.apply(o,[i])),u=o.tools.replacePlh4Template(u,p),e.find("> td.datagrid-template-td").html(u)),e.removeClass(o.classnames.tr_edit).initui(),c&&c.removeClass(o.classnames.tr_edit).initui(),n||(n=l.filter("."+o.classnames.s_edit).find("button.update")),n&&n.length&&n.trigger("bjui.datagrid.update.tr"),e.hasClass(o.classnames.tr_add)){if(e.removeClass(o.classnames.tr_add),e.find("> td."+o.classnames.s_edit).removeData("isAdd"),d&&o.tools.updateLinenumber(),o.options.isTree){var h,g=i[o.options.keys.treePTr],f=i[o.options.keys.treePData],m=o.options.treeOptions.keys;g&&f&&(f[m.isParent]||(f[m.isParent]=!0,h=g.find("> td.datagrid-tree-td"),h.html(o.tools.createTreePlaceholder(f,h.find("span.datagrid-tree-title").html()))),f[m.childLen]?f[m.childLen]++:f[m.childLen]=1,e.data(o.options.keys.treePTr).data("child",f[m.childLen]).attr("data-child",f[m.childLen])),e.addClass("datagrid-tree-tr datagrid-tree-level-"+i[m.level]).attr("data-child",0).attr("data-level",i[m.level])}e.next("."+o.classnames.tr_child).remove(),o.tools.createChildTr(e,i)}},a.prototype.dialogEdit=function(e,a,i){if(!this.tools.beforeEdit(e,i))return!1;var n,o,s,r=this,l=r.options,d=r.tools,c=r.columnModel,u=e.index(),p=u;i||(p=d.getNoChildDataIndex(p),i=r.isDom?e.data("initData")||d.setDomData(e):r.data[p]),r.inputs&&r.inputs.length||d.initEditInputs(),s=l.gridTitle||"datagrid",a?s+=" - "+BJUI.getRegional("datagrid.add"):(i.addFlag&&(i.addFlag=!1),s+=" - "+BJUI.getRegional("datagrid.edit")),n=t('<div><div class="bjui-pageContent"></div><div class="bjui-pageFooter"></div></div>'),o=t('<form class="datagrid-dialog-edit-form"></form>');var h=function(e,n,o,s){var l=e.data(r.datanames.changeData),d=s.jsontype,c="undefined"==typeof s.defaultVal?null:s.defaultVal;switch(s.type){case"date":o.change(function(){l[s.name]=t(this).val()});break;case"select":o.change(function(){var e=t(this),a=e.val(),i=e.prop("multiple");i&&t.isArray(a)&&(a=a.join(",")),!i&&d&&("boolean"===d?a=Boolean(a):"number"===d&&(a.length?!isNaN(Number(a))&&(a=Number(a)):a=null)),l[s.name]=a});break;case"boolean":o.on("ifChanged",function(){l[s.name]=t(this).is(":checked")});break;case"findgrid":o.change(function(){var e=i.value;d&&"number"===d&&(e.length?!isNaN(Number(e))&&(e=Number(e)):e=null),l[s.name]=t(this).val()}),n.off("afterchange.bjui.findgrid").on("afterchange.bjui.findgrid",'[data-toggle="findgrid"]',function(e,a){var i=s.attrs&&s.attrs["data-options"]&&s.attrs["data-options"].include;i&&t.each(i.split(","),function(t,e){var i=e.trim().split(":"),n=i[0],o=i.length>1?i[1]:i[0];a.data&&(l[n]=a.data[o])})});break;case"spinner":o.change(function(){l[s.name]=Number(t(this).val())});break;default:o.change(function(){var e=t(this).val();d&&"number"===d&&(e.length?!isNaN(Number(e))&&(e=Number(e)):e=null),l[s.name]=e})}if(a){if("boolean"===s.type)c=Boolean(c),l[s.name]=c,o.prop("checked",c);else if(null!=c)o.isTag("select")&&o.prop("multiple")?o.val(t.isArray(c)?c:c.split(",")):o.val(String(c)),d&&("number"===d?!isNaN(Number(c))&&(c=Number(c)):"boolean"===d&&(c=Boolean(c))),l[s.name]=c;else if(o.isTag("select")&&!o.prop("multiple")){var u=o.clone().appendTo("body"),p=u.val();l[s.name]=p,u.remove()}}else d&&o.trigger("change");
},g=function(n){var o,s,u=n.find("form.datagrid-dialog-edit-form"),p=n.find("div.bjui-pageFooter button"),g=p.first(),f=p.eq(1),m=p.eq(2),b=p.last(),v=function(e,i,n){i.empty(),n.data(r.datanames.changeData)||n.data(r.datanames.changeData,{}),i.data("validator")&&i.validator("destroy"),t.each(c,function(o,s){if(!s.name||r.tools.isGridModel(s))return!0;var l,d=r.inputs[o],c=t("<p></p>"),u="datagrid-dialog-edit-column-"+o,p=e[s.name];s.hide&&c.addClass("hide"),a?s.add||(d=""):s.edit||(d=""),("undefined"==typeof p||"null"===p||null===p)&&(p=""),d?(l=t(d).attr("id",u),l.isTag("select")?l.attr("data-width","auto"):l.isTag("checkbox")||l.attr("size",30),"boolean"===s.type?l.prop("checked",p):"findgrid"===s.type?l.val(String(p)).data("context",i):l.val(String(p)),l.isTag("select")&&l.prop("multiple")&&p&&!t.isArray(p)&&l.val(p.split(",")),a?s.addAttrs&&"object"==typeof s.addAttrs&&t.each(s.addAttrs,function(t,e){l.attr(t,e)}):s.editAttrs&&"object"==typeof s.editAttrs&&t.each(s.editAttrs,function(t,e){l.attr(t,e)})):a||s.edit||(d=p),c.append('<label class="control-label x120" for="'+u+'">'+s.label+"：</label>").append(t('<span class="datagrid-dialog-column-span"></span>').append(l||d)).appendTo(i),l&&h(n,i,l,s)}),i.initui().validator({msgClass:"n-bottom",theme:"red_bottom_effect_grid"})};u.is(":empty")&&v(i,u,e),o=e.index(),r.columnModel[0]===r.childColumn&&(o=2*o),o||g.addClass("disabled"),o==r.data.length-1&&f.addClass("disabled"),g.click(function(){var t,a=e.prev();r.options.hasChild&&r.options.childOptions&&(a=a.prev()),a.length?(s=r.tools.getNoChildDataIndex(a.index()),t=r.isDom?a.data("initData")||d.setDomData(a):r.data[s],e=a,v(t,u,e),f.removeClass("disabled"),a.prev().length||g.addClass("disabled")):g.addClass("disabled")}),f.click(function(){var t,a,i=e.next();r.options.hasChild&&r.options.childOptions&&(i=i.next()),i.length?(a=i.next(),s=r.tools.getNoChildDataIndex(i.index()),r.options.hasChild&&r.options.childOptions&&(a=a.length&&a.next()),t=r.isDom?i.data("initData")||d.setDomData(i):r.data[s],e=i,v(t,u,e),u.initui(),g.removeClass("disabled"),a&&a.length||f.addClass("disabled")):f.addClass("disabled")}),b.click(function(){var a,i,n,o,d=[],c=l.editCallback;s=r.tools.getNoChildDataIndex(e.index()),i=r.isDom?e.data("initData"):r.data[s],u.isValid(function(s){if(s){if(a=e.data(r.datanames.changeData),t.extend(i,a),l.jsonPrefix)n={},t.each(i,function(t,e){r.tools.isGridData(t)||(n[l.jsonPrefix+"."+t]=e)});else{n=t.extend({},i);for(var u in r.options.keys)delete n[r.options.keys[u]]}if(c=c?c.toFunc():function(a){"array"===t.type(a)?o=a[0]:"object"==typeof a&&(o=a),t.extend(i,"object"==typeof o&&o),r.dialogEditComplete(e,i),r.$grid.dialog("close","datagrid-dialog-edit"),r.tools.afterSave(e,i)},d.push(i),r.tools.beforeSave(e,d)){var p=l.editType,h={url:l.editUrl,data:JSON.stringify(n),type:"POST",okCallback:c};p&&"raw"===p?h.contentType="application/json":(h.data={json:h.data},p&&(h.type=p)),BJUI.ajax("doajax",h)}}})}),m.click(function(){r.$grid.dialog("close","datagrid-dialog-edit")})},f=function(){var e=!1;r.$tbody.find("> tr."+r.classnames.tr_add).each(function(){var a=t(this),i=a.index(),n=i;n=r.tools.getNoChildDataIndex(n),r.data=r.data.remove(n),a.next().hasClass(r.classnames.tr_child)&&(a.next().remove(),r.$lockTbody&&r.$lockTbody.find("> tr:eq("+i+")").next().remove()),r.$lockTbody&&r.$lockTbody.find("> tr:eq("+i+")").remove(),a.remove(),e=!0}),e&&"auto"===r.options.height&&r.fixedHeight()};n.find("> div:first").append(o).next().append(BJUI.doRegional(FRAG.gridDialogEditBtns,r.regional));var m=t.extend({},{id:"datagrid-dialog-edit",fresh:!0,target:n[0],width:520,height:400,mask:!0,title:s,onLoad:g,onClose:f},"object"==typeof l.editDialogOp&&l.editDialogOp);r.$grid.dialog(m)},a.prototype.dialogEditComplete=function(e,i){var n=this,o=n.columnModel,s=e.index(),r=e.find("> td"),l=!1,d=(n.$tbody.find("> tr"),n.$lockTbody&&n.$lockTbody.find("> tr:eq("+s+")")),c=n.options.tdTemplate,u=t.extend({},i);n.options.treeOptions;if(t.each(o,function(t,e){if(e===n.linenumberColumn&&(l=!0),n.tools.isGridModel(e))return!0;var o,s=e.name?i[e.name]:"",c=r.eq(e.index);if(n.isTemplate&&(c=null),("undefined"==typeof s||"null"===s||null===s)&&(s=""),c&&c.text(s).removeClass(n.classnames.td_edit).removeClass(n.classnames.td_changed),e.render&&"function"==typeof e.render?e.items?(o=e.render.call(n,s,i,e.items,e.itemattr),u[e.name]=o,c&&c.html(o)):(o=e.render.call(n,s,i),u[e.name]=o,c&&c.html(o)):e.items&&(o=a.renderItem.call(n,s,i,e.items,e.itemattr),u[e.name]=o,c&&c.html(o)),n.options.isTree&&e.hasTree&&c&&c.attr("align","left").addClass("datagrid-tree-td").html(n.tools.createTreePlaceholder(i,o||s)),e.locked&&d&&c){var p=d.find("> td:eq("+e.lockIndex+")");p.removeClass(n.classnames.td_edit).removeClass(n.classnames.td_changed).html(c.html())}}),n.isTemplate&&("function"==typeof c&&(c=c.apply(n,[i])),c=n.tools.replacePlh4Template(c,u),e.find("> td.datagrid-template-td").html(c)),e.initui(),d&&d.initui(),e.hasClass(n.classnames.tr_add)){if(e.removeClass(n.classnames.tr_add),l&&n.tools.updateLinenumber(),n.options.isTree){var p,h=i[n.options.keys.treePTr],g=i[n.options.keys.treePData],f=n.options.treeOptions.keys;h&&g&&(g[f.isParent]||(g[f.isParent]=!0,p=h.find("> td.datagrid-tree-td"),p.html(n.tools.createTreePlaceholder(g,p.find("span.datagrid-tree-title").html()))),g[f.childLen]?g[f.childLen]++:g[f.childLen]=1,e.data(n.options.keys.treePTr).data("child",g[f.childLen]).attr("data-child",g[f.childLen])),e.addClass("datagrid-tree-tr datagrid-tree-level-"+i[f.level]).attr("data-child",0).attr("data-level",i[f.level])}e.next("."+n.classnames.tr_child).remove(),n.tools.createChildTr(e,i)}},a.prototype.resizeGrid=function(){var e,a=this,i=(a.$grid.getPageTarget(),function(){var i=a.$grid.width(),n=a.$tableH.next(".datagrid-thead-dialog-div"),o=a.options.tdTemplate&&a.options.templateWidth&&a.options.templateWidth>i||0===a.options.templateWidth;return o!==a.isTemplate?(a.isTemplate=o,void a.tools.coverTemplate()):(a.options.dialogFilterW&&i<a.options.dialogFilterW||0===a.options.dialogFilterW?(a.$tableH.hide(),n.length?n.show():a.$tableH.after('<div class="datagrid-thead-dialog-div" style="padding:5px;"><button type="button" class="btn btn-orange datagrid-thead-dialog-view">'+BJUI.getRegional("datagrid.fAndS")+'</button><span class="datagrid-thead-dialog-filter-msg"><span class="msg-sort"></span><span class="msg-filter"></span></span></div>'),a.$headFilterUl||a.filterInThead(!0),a.$grid.off("click.datagrid.thead.view").on("click.datagrid.thead.view",".datagrid-thead-dialog-view",function(t){BJUI.dialog({id:"datagrid-thead-view",html:'<div class="bjui-pageContent"></div><div class="bjui-pageFooter"><ul><li><button type="button" class="btn btn-close">关闭</button></li></ul></div>',width:360,height:300,title:"datagrid - thead - columns",onLoad:function(t){a.$headFilterUl.show().appendTo(t.find(".bjui-pageContent"))},beforeClose:function(t){return a.$headFilterUl.hide().appendTo(a.$grid),!0}})})):(a.$grid.removeClass("datagrid-flowlayout"),a.$tableH.show(),n.hide(),a.$colgroupB.is(":hidden")&&a.$colgroupB.show()),a.initFixedW&&String(a.options.width).endsWith("%")&&(e=a.$grid.parent().width(),a.fixedWidth(),a.options.hasChild&&a.options.childOptions&&a.$tbody.find("> tr."+a.classnames.tr_child+":visible").each(function(){var e=t(this),a=e.prev(),i=a.data("bjui.datagrid.child");i&&i.length&&i.datagrid("fixedWidth")})),void(String(a.options.height).endsWith("%")&&a.tools.setBoxbH()))});t('a[data-toggle="tab"]').on("shown.bs.tab",t.proxy(function(e){if(!a.$element.data("bjui.datagrid.init.tab")){var i=t(e.target),n=i.data("target"),o=i.attr("href");n||(n=t(o)),n&&n.length&&n.find(a.$element).length&&(a.$element.data("bjui.datagrid.init.tab",!0),a.$element.datagrid("fixedHeight"))}},a)),t(window).on(BJUI.eventType.resizeGrid,t.proxy(i,a))};var i=t.fn.datagrid;t.fn.datagrid=e,t.datagrid=a,t.fn.datagrid.noConflict=function(){return t.fn.datagrid=i,this},t(document).on(BJUI.eventType.initUI,function(a){t(a.target).find('table[data-toggle="datagrid"]').each(function(){var a=t(this),i=a.data();a.length&&(i.options&&"string"==typeof i.options&&(i.options=i.options.toObj()),t.extend(i,"object"==typeof i.options&&i.options),e.call(a,i))})})}(jQuery),+function(t){"use strict";function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),s=t.extend({},a.DEFAULTS,o.data(),"object"==typeof e&&e),r=o.data("bjui.spinner");r||o.data("bjui.spinner",r=new a(this,s)),"string"==typeof n&&t.isFunction(r[n])?([].shift.apply(i),i?r[n].apply(r,i):r[n]()):r.init()})}var a=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS(),this.$spinner=null,this.height=this.$element.addClass("form-control").innerHeight(),this.ivalue=Number(this.$element.val())||0};a.DEFAULTS={min:0,max:100,step:1,decimalPlace:0},a.EVENTS={afterChange:"afterchange.bjui.spinner"},a.prototype.TOOLS=function(){var t=this,e={changeVal:function(e){var i=t.$element,n=Number(i.val())||Number(t.ivalue),o=e.data("add")||-1,s=t.options.min,r=t.options.max,l=t.options.step;1==o?r-l>=n&&(n+=l):-1==o?n>=s+l&&(n-=l):n>r?n=r:s>n&&(n=s),t.options.decimalPlace&&(n=new String(n.toFixed(t.options.decimalPlace))),t.ivalue=n,i.val(n).trigger(a.EVENTS.afterChange,{value:n}).trigger("change")}};return e},a.prototype.init=function(){this.$element,this.options;return isNaN(this.options.min)||isNaN(this.options.max)||isNaN(this.options.step)?void BJUI.debug("BJUI.Spinner: Parameter is non-numeric type!"):void this.addBtn()},a.prototype.addBtn=function(){var e=this,a=e.$element,i=a.attr("size")?"":" fluid";if(!this.$lookBtn&&!a.parent().hasClass("wrap_bjui_btn_box")){this.$spinner=t(FRAG.spinnerBtn),a.css({paddingRight:"13px"}).wrap('<span class="wrap_bjui_btn_box'+i+'"></span>');var n=a.parent();n.css("position","relative"),this.$spinner.css({height:this.height}).appendTo(n),this.$spinner.on("selectstart",function(){return!1});var o=null;e.$spinner.find("li").on("click",function(a){e.tools.changeVal(t(this))}).on("mousedown",function(){var a=t(this);o=setInterval(function(){e.tools.changeVal(a)},150)}).on("mouseup",function(){clearTimeout(o)})}},a.prototype.destroy=function(){this.$element.parent().hasClass("wrap_bjui_btn_box")&&(this.$element.parent().find(".bjui-spinner").remove(),this.$element.unwrap())};var i=t.fn.spinner;t.fn.spinner=e,t.fn.spinner.Constructor=a,t.fn.spinner.noConflict=function(){return t.fn.spinner=i,this},t(document).on(BJUI.eventType.initUI,function(a){var i=t(a.target).find('input[data-toggle="spinner"]');i.length&&e.call(i)})}(jQuery),+function(t){"use strict";function e(e){var a=arguments,i=e;return this.each(function(){var n,o=(t(this),{});t.extend(!0,o,g.DEFAULTS,"object"==typeof e&&e),n=new g(this,o),"string"==typeof i&&t.isFunction(n[i])?([].shift.apply(a),a?n[i].apply(n,a):n[i]()):n.init()})}var a,i,n,o,s,r,l,d,c,u,p,h,g=function(e,a){this.$element=t(e),this.options=a,this.$findBtn=null};g.DEFAULTS={pk:null,oldData:null,group:null,suffix:null,include:null,exclude:null,multiple:!1,append:!1,empty:!0,dialogOptions:{id:null,mask:!0,width:600,height:400,title:"FindGrid",maxable:!0,resizable:!0},gridOptions:{width:"100%",height:"100%",tableWidth:"100%",columnMenu:!1},context:null,beforeSelect:null,onSelect:null,afterSelect:null},g.EVENTS={afterChange:"afterchange.bjui.findgrid"},g.getField=function(t){return(a?a+".":"")+t+(i?i:"")},g.empty=function(){if(!o)return void BJUI.debug("BJUI.FindGrid: No set options 'include' !");for(var t=this,e=o.split(","),a=p.find(":text, :input:hidden, textarea, select"),i={},n=0;n<e.length;n++){var s,r,l=e[n].split(":");2==l.length?(r=l[0].trim(),s=l[1].trim()):(r=e[n].trim(),s=r),i[t.getField(r)]=!0}for(s in i)a.filter('[name="'+s+'"]').val("").trigger(g.EVENTS.afterChange,{value:"",data:""}).trigger("focus").trigger("change")},g.setSingle=function(e){if("function"==typeof c)return void c.call(this,e);var a=this,i=function(t,i,n){var o=a.getField(i);o==t.attr("name")&&(t.val(n).trigger(g.EVENTS.afterChange,{value:n,data:e}).trigger("focus").trigger("change"),t.isTag("select")&&t.data("toggle")&&"selectpicker"===t.data("toggle")&&t.selectpicker("refresh"))};return p.find("input:text, input:hidden, textarea, select").each(function(){var a,n=t(this),r=[];if(o)for(var l=o.split(","),d=0;d<l.length;d++){var c,u=l[d].split(":");2==u.length?(a=u[0].trim(),c=u[1].trim()):(a=l[d].trim(),c=a),e&&"undefined"!=typeof e[c]&&i(n,a,e[c])}else for(var c in e)s&&(t.each(s.split(","),function(t,e){r.push(e.trim())}),-1!=t.inArray(c,r))||i(n,c,e[c])}),"function"==typeof u?void u.call(a,e):void 0},g.setMult=function(e){var a=t("#"+e).data("selectedDatas");if("function"==typeof d&&!d.apply(m,[a]))return!1;if("function"==typeof c)return void c.call(m,a);var i,f,m=this,b=function(t){t.isTag("select")&&t.data("toggle")&&"selectpicker"===t.data("toggle")&&t.selectpicker("refresh")};if(a&&a.length){var v,y,x=p.find("input:text, input:hidden, textarea, select"),k={},C={},j=[];if(!r&&l&&(l=[]),o)for(var $=o.split(","),w=0;w<$.length;w++){var T,I=$[w].split(":");2==I.length?(v=I[0].trim(),T=I[1].trim()):(v=$[w].trim(),T=v),k[m.getField(v)]=T}else for(var T in a[0])s?(t.each(s.split(","),function(t,e){j.push(e.trim())}),-1===t.inArray(T,j)&&(k[m.getField(T)]=T)):k[m.getField(T)]=T;x=t(t.map(x,function(e){var a=t(e),i=a.attr("name");return i&&k[i]?(C[i]=k[i],e):null}));for(var B=0;B<a.length;B++)i=a[B],(!l||-1==t.inArray(i[n],l)||r)&&x.each(function(e){var a=t(this),o=a.attr("name"),s=a.val();f||(f=new Array),f[e]||(f[e]=[]),r?s&&(f[e].push(s),a.isTag("select")&&a.prop("multiple")&&(f[e]="array"===t.type(s)?s:[])):(a.val(""),b(a)),f[e].push(i[C[o]]),l&&-1===t.inArray(i[n],l)&&l.push(i[n])});if(f&&x.each(function(e){var i=t(this);y=f[e].join(","),i.isTag("select")&&i.prop("multiple")&&(y=f[e]),i.val(y).trigger(g.EVENTS.afterChange,{value:y,data:a}).trigger("change"),h.data("oldData",l),b(i)}),"function"==typeof u)return void u.call(m,i.data);BJUI.dialog("closeCurrent")}},g.prototype.init=function(){var e=this,r=this.options,d=r.gridOptions;this.tools;if(a=r.group||null,i=r.suffix||null,h=e.$element,l=r.oldData,n=r.pk||null,o=r.include||null,s=r.exclude||null,p=null,r.context&&(p=r.context instanceof jQuery?r.context:t(r.context)),p&&p.length||(p=e.$element[0]===t("body")[0]?t.CurrentDialog||t.CurrentNavtab:e.$element.closest(".unitBox")),i&&(i=i.trim()),n?h.data("oldData")?l=h.data("oldData"):"undefined"!=typeof l?"string"==typeof l?l=l.split(","):t.isArray(l)||(l=[]):l=[]:l=null,d.dataUrl){if(d.dataUrl=decodeURI(d.dataUrl).replacePlh(p),!d.dataUrl.isFinishedTm())return BJUI.alertmsg("error",r.warn||BJUI.regional.plhmsg),void BJUI.debug("Findgrid Plugin: gridOptions -> dataUrl is incorrect: "+d.dataUrl);d.dataUrl=encodeURI(d.dataUrl)}this.open(e.$element)},g.prototype.addBtn=function(){var e=this,a=e.$element,i=a.data("bjui.findgrid.options"),n=a.attr("size")?"":" fluid";if(!this.$findBtn&&!a.parent().hasClass("wrap_bjui_btn_box")){this.$findBtn=t(FRAG.findgridBtn),this.$element.css({paddingRight:"15px"}).wrap('<span class="wrap_bjui_btn_box'+n+'"></span>');var o=this.$element.parent(),s=this.$element.addClass("form-control").innerHeight();o.css({position:"relative",display:"inline-block"}),delete i.toggle,e.$findBtn.data("bjui.findgrid.options",i),this.$findBtn.css({height:s,lineHeight:s+"px"}).appendTo(o),this.$findBtn.on("selectstart",function(){return!1})}},g.prototype.open=function(e){var a=this,i=this.options,o=i.dialogOptions,s=i.gridOptions,p=(new Date).getTime();o.id||(o.id="dialog_findgrid_"+p),i.gridId||(i.gridId="datagrid_findgrid_"+p),s.showToolbar=!1,i.empty&&(s.toolbarCustom||(s.toolbarCustom=""),s.showToolbar=!0),i.multiple&&(s.showToolbar=!0,"undefined"==typeof s.showCheckboxcol&&(s.showCheckboxcol=!0),s.toolbarCustom||(s.toolbarCustom=""),s.selectMult=!0,s.toolbarCustom+='　<button type="button" class="btn-blue" onclick="$.fn.findgrid.Constructor.setMult(\''+i.gridId+"')\">"+BJUI.getRegional("findgrid.choose")+"</button>",s.toolbarCustom+='　<label class="ilabel"><input type="checkbox" data-toggle="icheck" id="checkbox_findgrid_'+p+'" '+(i.append?"checked":"")+">&nbsp;"+BJUI.getRegional("findgrid.append")+"</label>",r=i.append),i.empty&&(s.toolbarCustom+='　<button type="button" class="btn-orange" onclick="$.fn.findgrid.Constructor.empty(\''+i.gridId+"')\">"+BJUI.getRegional("findgrid.empty")+"</button>"),delete o.url,delete o.target,i.onSelect?(c=i.onSelect,"string"==typeof c&&(c=c.toFunc())):c=null,i.beforeSelect?(d=i.beforeSelect,"string"==typeof d&&(d=d.toFunc())):d=null,i.afterSelect?(u=i.afterSelect,"string"==typeof u&&(u=u.toFunc())):u=null,o.html='<div class="bjui-pageContent tableContent"><table id="'+i.gridId+'"></table></div>',o.onLoad=function(e){var o="#"+i.gridId,u=t(o);u.datagrid(s),t.isArray(l)&&l.length&&n&&t(document).on("afterLoad.bjui.datagrid",o,function(e,a){a.datas&&t.each(a.datas,function(e,a){a[n]&&"-1"!=t.inArray(a[n],l)&&u.datagrid("selectedRows",e,!0)})}),i.multiple||t(document).on("clicked.bjui.datagrid.tr",o,function(t,e){return"function"!=typeof d||d.apply(a,[e.data])?void("function"==typeof c?c.call(a,e.data):(g.setSingle(e.data),BJUI.dialog("closeCurrent"))):!1}),t(document).on("ifChanged","#checkbox_findgrid_"+p,function(e){r=t(this).is(":checked")})},BJUI.dialog(o)};var f=t.fn.findgrid;t.fn.findgrid=e,t.fn.findgrid.Constructor=g,t.fn.findgrid.noConflict=function(){return t.fn.findgrid=f,this},BJUI.findgrid=function(a){e.apply(t("body"),[a])},t(document).on(BJUI.eventType.initUI,function(a){t(a.target).find('input[data-toggle="findgrid"]').each(function(){var a=t(this),i=a.data(),n=i.options;n&&("string"==typeof n&&(n=n.trim().startsWith("{")?n.toObj():n.toFunc()),"function"==typeof n&&(n=n.apply()),"object"==typeof n&&(delete i.options,t.extend(i,n))),a.data("bjui.findgrid.options",i),e.call(a,"addBtn")})}),t(document).on("click.bjui.findgrid.data-api",'[data-toggle="findgridbtn"]',function(a){var i=t(this),n=i.data("bjui.findgrid.options");if(!n){var o=i.data(),s=o.options;s&&("string"==typeof s&&(s=s.trim().startsWith("{")?s.toObj():s.toFunc()),"function"==typeof s&&(s=s.apply()),"object"==typeof s&&(delete o.options,t.extend(o,s))),n=o}delete n["bjui.findgrid.options"],e.call(i,n),a.preventDefault()})}(jQuery),+function(t){"use strict";function e(e){var a=arguments,i=e;return this.each(function(){var n,o=(t(this),{});t.extend(!0,o,l.DEFAULTS,"object"==typeof e&&e),n=new l(this,o),"string"==typeof i&&t.isFunction(n[i])?([].shift.apply(a),a?n[i].apply(n,a):n[i]()):n.init()})}var a,i,n,o,s,r,l=function(e,a){this.$element=t(e),this.options=a,this.$findBtn=null};l.DEFAULTS={keys:null,group:null,suffix:null,include:null,context:null,eventType:"change",autofill:!1},l.EVENTS={afterChange:"afterchange.bjui.suggest"},l.getField=function(t){return(a?a+".":"")+t+(i?i:"")},l.setSingle=function(e){var a,i,l=this,d=[],c=[],u=function(t,e){return t.replace(/#\/?[^#]*#/g,function(t){var a=t.replace(/[##]+/g,""),i=e[a];return"undefined"==typeof i?t:(("undefined"==typeof i||"null"===i||null===i)&&(i=""),i)})},p=function(i,n,o){a=[];var s,r,l=i.data("suggest.menu");l&&l.length||(l=t('<ul class="bjui-suggest-menu"></ul>')),t.each(e,function(t,e){s=n,r=o,s=u(s,e),r=u(r,e),(s||r)&&a.push('<li data-value="'+s+'">'+r+"</li>")}),a.length&&(l.html(a.join("")).appendTo("body").css({position:"absolute",top:i.offset().top+i.outerHeight(),left:i.offset().left}).on("click.bjui.suggest","li",function(){i.val(t(this).attr("data-value"))}).on("mouseover.bjui.suggest","li",function(){t(this).addClass("menu-highlight")}).on("mouseout.bjui.suggest","li",function(){t(this).removeClass("menu-highlight")}),i.addClass("bjui-suggest-input").attr("autocomplete",!1).data("suggest.menu",l).off("focus.bjui.suggest").on("focus.bjui.suggest",function(){l.css({top:i.offset().top+i.outerHeight(),left:i.offset().left}).show()}).off("destroy.bjui.suggest").on("destroy.bjui.suggest",function(){l.remove()}),d.push(l))};t.each(n,function(t,a){var n,r,d=l.getField(t),u=s.find('input[name="'+d+'"], select[name="'+d+'"], textarea[name="'+d+'"]'),h=a?a.split("/"):["#"+t+"#"];u&&u.length&&(h.length>1?(n=h[0],r=h[1]):n=r=h[0],(u.isTag("select")||u.isTag("textarea"))&&o?(u.val(e[0]?e[0][t]:""),u.isTag("select")&&u.selectpicker("refresh")):(p(u,n,r),o&&u.val(e[0]?e[0][t]:"")),c.push(u),i||(i=u.parents()))}),t(document).on("click.bjui.suggest",function(e){var a=t(e.target).data("suggest.menu");a&&a.length?a.siblings(".bjui-suggest-menu").hide():t("body").find("> .bjui-suggest-menu").hide()}),i.on("scroll.bjui.suggest",function(){t.each(c,function(t,e){var a=e.data("suggest.menu");a&&a.is(":visible")&&a.css({top:e.offset().top+e.outerHeight(),left:e.offset().left})})}),r.data("menus",d)},l.prototype.init=function(){var e=this,l=this.options;this.tools;return n=l.keys||null,a=l.group||null,i=l.suffix||null,o=l.autofill||!1,r=e.$element,s=null,l.context&&(s=l.context instanceof jQuery?l.context:t(l.context)),s&&s.length||(s=e.$element.closest(".unitBox")),i&&(i=i.trim()),l.keys?l.url?(l.url=decodeURI(l.url).replacePlh(s),l.url.isFinishedTm()?(l.url=encodeURI(l.url),void e.$element.on(l.eventType||"change",function(){var a=t(this).val();a&&e.load(a)})):(BJUI.alertmsg("error",l.warn||BJUI.regional.plhmsg),void BJUI.debug("BJUI.Suggest: options -> url is incorrect: "+l.url))):void BJUI.debug("BJUI.Suggest: options -> url is not defined!"):void BJUI.debug("BJUI.Suggest: options -> keys is not defined!")},l.prototype.load=function(t){var e=this.options,a=e.url;-1!=a.indexOf("#val#")&&(a=a.replaceAll("#val#",t)),BJUI.ajax("doajax",{url:a,data:{value:t},type:e.type,cache:e.cache,okCallback:function(t){l.setSingle(t)}})},l.prototype.destroyMenu=function(){var e=r.data("menus")||[];e.length&&t.each(e,function(t,e){e.remove()})};var d=t.fn.suggest;t.fn.suggest=e,t.fn.suggest.Constructor=l,t.fn.suggest.noConflict=function(){return t.fn.suggest=d,this},t(document).on(BJUI.eventType.initUI,function(a){t(a.target).find('input[data-toggle="suggest"]').each(function(){var a=t(this),i=a.data(),n=i.options;n&&("string"==typeof n&&(n=n.trim().startsWith("{")?n.toObj():n.toFunc()),"function"==typeof n&&(n=n.apply()),"object"==typeof n&&(delete i.options,t.extend(i,n))),e.call(a,i)})}),t(document).on("click.bjui.suggest.data-api",'[data-toggle="suggestbtn"]',function(a){var i=t(this),n=i.data("bjui.suggest.options");if(!n){var o=i.data(),s=o.options;s&&("string"==typeof s&&(s=s.trim().startsWith("{")?s.toObj():s.toFunc()),"function"==typeof s&&(s=s.apply()),"object"==typeof s&&(delete o.options,t.extend(o,s))),n=o}delete n["bjui.suggest.options"],e.call(i,n),a.preventDefault()})}(jQuery),+function(t){"use strict";function e(e){var i=arguments,n=e;return this.each(function(){var o,s=(t(this),{});t.extend(!0,s,a.DEFAULTS,"object"==typeof e&&e),o=new a(this,s),"string"==typeof n&&t.isFunction(o[n])?([].shift.apply(i),i?o[n].apply(o,i):o[n]()):o.init()})}var a=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS(),this.$box=t("<div></div>"),this.timeout=null,this.$tagsArr={},this.tags=[],a.istag?(this.$element.addClass("tag-input"),this.$box.addClass("bjui-tags")):(this.$box.addClass("bjui-autocomplete"),this.$element.attr("size")||this.$box.addClass("fluid")),this.$element.after(this.$box),this.$element.appendTo(this.$box)};a.DEFAULTS={width:300,url:"",global:!1,type:"GET",term:"term",tagname:"tag",max:0,clear:!1,lightCls:"tags-highlight",istag:!0,data:{},container:"",keys:{value:"value",label:"label"}},a.EVENTS={afterCreated:"aftercreated.bjui.tags"},a.prototype.TOOLS=function(){var e=this,i=this.options,n={keyDown:function(t){return 13==t.which?!1:void 0},keyUp:function(a){switch(a.which){case BJUI.keyCode.BACKSPACE:if(!t.trim(e.$element.val()).length)return e.tools.removeMenu(),!1;break;case BJUI.keyCode.ESC:e.tools.removeMenu();break;case BJUI.keyCode.DOWN:if(!e.$menu||!e.$menu.length)return;var n=e.$menu.find("> ."+i.lightCls),o=e.$menu.find("> li:first-child");if(n.length){var s=n.removeClass(i.lightCls).next();s.length?s.addClass(i.lightCls):o.addClass(i.lightCls)}else o.addClass(i.lightCls);return!1;case BJUI.keyCode.UP:if(!e.$menu||!e.$menu.length)return;var n=e.$menu.find("> ."+i.lightCls),r=e.$menu.find("> li:last-child");if(n.length){var l=n.removeClass(i.lightCls).prev();l.length?l.addClass(i.lightCls):r.addClass(i.lightCls)}else r.addClass(i.lightCls);return!1;case BJUI.keyCode.ENTER:if(i.max>0&&e.$tagsArr.length>=i.max)return!1;var d=!1,c=!1,u=null,p=e.$menu&&e.$menu.find("> ."+i.lightCls);if(p&&p.length)d=p.text(),u=p.data("item"),c=u[i.keys.value];else{if(d=t.trim(e.$element.val()),!d.length)return!1;if(i.clear&&-1==t.inArray(d,e.tags))return i.istag&&e.$element.val(""),!1;c=d}if(!d)return;var h=!1;return e.$tagsArr.length&&e.$tagsArr.each(function(){return t(this).val()==c?void(h=!0):void 0}),h?(i.istag&&e.$element.val(""),!1):(e.tools.createTag(d,c),e.tools.removeMenu(),i.istag&&e.$element.val(""),t.proxy(e.tools.onAfterCreated(u,c),e),!1)}},query:function(){e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout(e.tools.doQuery,300)},doQuery:function(){var a=e.options;if(!(a.max>0&&e.$tagsArr.length>=a.max)){var i=e.$element.val(),n=e.$menu,o=[],s=null,r=e.$element.closest(".navtab-panel").length?t.CurrentNavtab:t.CurrentDialog,l={};if(e.$element.closest(".bjui-layout").length&&(r=e.$element.closest(".bjui-layout")),i.length){if(e.$element.one("ajaxStart",function(){r.trigger("bjui.ajaxStart")}).one("ajaxStop",function(){r.trigger("bjui.ajaxStop")}),l[a.term]=i,t.extend(l,"object"==typeof a.data&&a.data),a.url=decodeURI(a.url).replacePlh(e.$element.closest(".unitBox")),!a.url.isFinishedTm())return BJUI.alertmsg("error",a.warn||BJUI.regional.plhmsg),void BJUI.debug("BJUI.Tags: The query tags url is incorrect, url: "+a.url);a.url=encodeURI(a.url),t.ajax({url:a.url,global:a.global,type:a.type,data:l,dataType:"json",success:function(i){if(0!=i.length){n&&n.length||(n=t('<ul class="bjui-tags-menu"></ul>')),n.empty().hide(),a.container?n.css("position","absolute").appendTo(a.container):n.appendTo(e.$box);for(var r=0;r<i.length;r++){var l=i[r];"string"==typeof l&&(l={},l[a.keys.label]=i[r],l[a.keys.value]=i[r]),s=t('<li class="tags-item">'+l[a.keys.label]+"</li>").data("item",l),s.appendTo(n),o.push(l[a.keys.label])}e.tags=o;var d=t(window).height()-e.$element.offset().top-50,c=0,u=0;a.container?(c=e.$element.offset().top+e.$element.outerHeight(),u=e.$element.offset().left):(c=e.$element.position().top+e.$element.outerHeight(),u=e.$element.position().left),n.css({top:c,left:u}).fadeIn().find("> li").hover(function(){t(this).addClass(a.lightCls).siblings().removeClass(a.lightCls)},function(){t(this).removeClass(a.lightCls)}).click(function(){var i=t(this).text(),o=t(this).data("item"),s=o[a.keys.value],r=!1;return e.$box.find("input:hidden").each(function(){return t(this).val()==s?void(r=!0):void 0}),r?(a.istag&&e.$element.val(""),void n.remove()):(t.proxy(e.tools.createTag(i,s),e),n.remove(),a.istag&&e.$element.val(""),void t.proxy(e.tools.onAfterCreated(o,s),e))}),n.height()>d&&n.height(d-10).css("overflow-y","scroll"),e.$menu=n}}})}}},createTag:function(a,i){if(!e.options.istag)return void e.$element.val(a);var n=t('<span class="label label-tag" data-value="'+i+'" style="margin-left: 1px; margin-top: 1px;"><i class="fa fa-tag"></i> '+a+'&nbsp;&nbsp;<a href="#" class="close">&times;</a></span>');n.insertBefore(e.$element).find("a.close").click(function(){var a=n.data("value");e.$box.find("input:hidden").each(function(){t(this).val()==a&&t(this).remove()}),n.remove(),e.$tagsArr=e.$box.find('input[name="'+e.options.tagname+'"]')});var o=t('<input type="hidden" name="'+e.options.tagname+'">').val(i);o.appendTo(e.$box),e.$tagsArr=e.$box.find('input[name="'+e.options.tagname+'"]')},removeMenu:function(){e.$menu&&e.$menu.remove()},onAfterCreated:function(i,n){var o=[];e.$tagsArr.length&&e.$tagsArr.each(function(){o.push(t(this).val())}),e.$element.trigger(a.EVENTS.afterCreated,{item:i,value:n,tags:o.join(",")})}};return n},a.prototype.init=function(){var e=this,a=this.$element,i=this.options;return i.url?isNaN(this.options.max)?void BJUI.debug("BJUI.Tags: Parameter 'max' is non-numeric type!"):(e.$box.on("click",function(){a.focus()}),i.istag&&e.$box.css("width",i.width),a.on("keydown",t.proxy(this.tools.keyDown,this)).on("keyup",t.proxy(this.tools.keyUp,this)),t.support.leadingWhitespace?a.on("input",t.proxy(this.tools.query,this)):a.on("propertychange",t.proxy(this.tools.query,this)),void t(document).on("click.bjui.tags",t.proxy(function(e){t(e.target).closest(this.$box).length||this.tools.removeMenu()},this))):void BJUI.debug("BJUI.Tags: Do query tags, url is undefined!")},a.prototype.destroy=function(){this.$tags&&(this.$element.upwrap(),$tags.remove())};var i=t.fn.tags;t.fn.tags=e,t.fn.tags.Constructor=a,t.fn.tags.noConflict=function(){return t.fn.tags=i,this},t(document).on(BJUI.eventType.initUI,function(a){t(a.target).find('input[data-toggle="tags"]').each(function(){var a=t(this),i=a.data(),n=i.options;n?("string"==typeof n&&(n=n.trim().startsWith("{")?n.toObj():n.toFunc()),"function"==typeof n&&(n=n.apply()),"object"==typeof n&&(delete i.options,t.extend(i,n))):(i.keys&&(i.keys=i.keys.toObj()),i.data&&(i.data=i.data.toObj())),e.call(a,i)})})}(jQuery),+function(t){"use strict";function e(e){var a=arguments,i=e;return this.each(function(){var n=t(this),s=t.extend({},o.DEFAULTS,n.data(),"object"==typeof e&&e),r=n.data("bjui.theme");r||n.data("bjui.theme",r=new o(this,s)),"string"==typeof i&&t.isFunction(r[i])?([].shift.apply(a),a?r[i].apply(r,a):r[i]()):r.init()})}var a,i,n;t(function(){var e=function(){if(a=t("#bjui-link-theme"),i=t("#bjui-themes"),n=t("#bjui-fonts"),t.cookie){var e=t.cookie("bjui_theme")||"blue",o=i.find("a.theme_"+e);o.theme({});var s=t.cookie("bjui_font")||"bjui-font-c",r=n.find("a."+s);r.theme("setFont",s)}};e()});var o=function(e,a){this.$element=t(e),this.options=a};o.DEFAULTS={theme:"purple"},o.prototype.init=function(){if(a.length){var t=a.attr("href");t=t.substring(0,t.lastIndexOf("/")),t=t.substring(0,t.lastIndexOf("/")),t+="/"+this.options.theme+"/core.css",a.attr("href",t);var e=this.$element.closest("li").filter(".active"),n=e.data("theme")||"default";n=n.replace(/(theme[\s][a-z]*)/g,""),e.removeClass().addClass(n).addClass("theme").addClass(this.options.theme),i.find("li").removeClass("active"),this.$element.parent().addClass("active"),this.cookie()}},o.prototype.setTheme=function(t){i.find("a.theme_"+t).trigger("click")},o.prototype.setFont=function(e){t("html").removeClass().addClass(e),this.$element.closest("ul").prev().html(this.$element.html()).removeClass().addClass("dropdown-toggle bjui-fonts-tit "+e),t("body").find("table").each(function(){var e=t(this),a=e.data("bjui.datagrid");a&&(a.needfixedWidth=!0,e.datagrid("fixedWidth"),a.needfixedWidth=!1)}),t(window).trigger(BJUI.eventType.resizeGrid),t.cookie&&t.cookie("bjui_font",e,{path:"/",expires:30})},o.prototype.cookie=function(){var e=this.options.theme;t.cookie&&t.cookie("bjui_theme",e,{path:"/",expires:30})};var s=t.fn.theme;t.fn.theme=e,t.fn.theme.Constructor=o,t.fn.theme.noConflict=function(){return t.fn.theme=s,this},t(document).on("click.bjui.theme.data-api",'[data-toggle="theme"]',function(a){e.call(t(this)),a.preventDefault()}),t(document).on("click.bjui.fonts.data-api",'[data-toggle="fonts"]',function(a){e.call(t(this),"setFont",t(this).attr("class")),a.preventDefault()})}(jQuery),+function(t){"use strict";function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),s=t.extend({},a.DEFAULTS,o.data(),"object"==typeof e&&e),r=o.data("bjui.initui");r||o.data("bjui.initui",r=new a(this,s)),"string"==typeof n&&t.isFunction(r[n])?([].shift.apply(i),i?r[n].apply(r,i):r[n]()):r.init()})}var a=function(e,a){this.$element=t(e),this.options=a};a.DEFAULTS={},a.prototype.init=function(){var e=this,a=e.$element;t.when(e.initUI()).done(function(){a.trigger(BJUI.eventType.afterInitUI)})},a.prototype.initUI=function(){var e=this.$element;t.when(e.trigger(BJUI.eventType.beforeInitUI)).done(function(){
e.trigger(BJUI.eventType.initUI)})};var i=t.fn.initui;t.fn.initui=e,t.fn.initui.Constructor=a,t.fn.initui.noConflict=function(){return t.fn.initui=i,this},t(document).on("click.bjui.initui.data-api",'[data-toggle="initui"]',function(t){e.call($this,$this.data()),t.preventDefault()}),t(document).on(BJUI.eventType.beforeInitUI,function(e){var a=t(e.target),i=[],n=a.find("[data-noinit], pre");a.find("> .bjui-maskProgress").find(".progress").stop().animate({width:"85%"},"fast"),n.each(function(e){var a=t(this),n={};n.$target=a,n.$next=a.next(),n.$prev=a.prev(),n.$parent=a.parent(),n.visible=a.is(":visible")?!0:!1,i.push(n),a.remove()}),a.data("bjui.noinit",i)}),t(document).on(BJUI.eventType.initUI,function(e){var a=t(e.target);a.find("> .bjui-maskProgress").find(".progress").stop().animate({width:"95%"},"fast")}),t(document).on(BJUI.eventType.afterInitUI,function(e){var a=t(e.target),i=a.data("bjui.noinit"),n=a.find("> .bjui-pageContent").find("form");i&&t.each(i,function(t,e){e.$next.length?e.$next.before(e.$target):e.$prev.length?e.$prev.after(e.$target):e.$parent.length&&e.$parent.append(e.$target),e.visible&&e.$target.show(),a.removeData("bjui.noinit")}),a.resizePageH(),n.length&&a.find("> .bjui-pageFooter").find(":submit").on("click.bjui.submit",function(t){t.preventDefault(),n.submit()}),a.find("> .bjui-pageFooter").find(":submit.btn-submit-header").on("click.bjui.submit",function(t){t.preventDefault();var e=a.find("> .bjui-pageHeader").find("form");e.length&&e.submit()}),a.find("> .bjui-maskProgress").find(".progress").stop().animate({width:"100%"},"fast",function(){a.find("> .bjui-ajax-mask").fadeOut("normal",function(){t(this).remove()})})}),t(document).one(BJUI.eventType.afterInitUI,function(e){var a=t("#bjui-hnav-navbar"),i=a.find("> li.active"),n=i.find("> a");if(i.length)if(i.find("> .items").length)n.trigger("click");else{var o=n.attr("href");!o||o.startsWith("#")||o.startsWith("javascript")||n.trigger("click")}});var n=function(e){var a=e,i=a,n=a.css("position"),o=a.scrollTop()||0,s=a[0].clientHeight/2;"static"==n&&(a.css("position","relative").data("bjui.ajax.static",!0),i=a.offsetParent());var r=parseInt(i.css("zIndex"))||0,l=a.find("> .bjui-maskBackground"),d=a.find("> .bjui-maskProgress");l.length||(l=t(FRAG.maskBackground),d=t(BJUI.doRegional(FRAG.maskProgress,BJUI.regional)),a.prepend(l).prepend(d));parseInt(l.css("zIndex"))||0,parseInt(d.css("zIndex"))||0;return l.css("zIndex",r+1).css("top",o),d.css("zIndex",r+2),o&&d.css("top",o+s),0==s&&setTimeout(function(){d.css("top",t(this).scrollTop()+a[0].clientHeight/2)},50),a.off("scroll.ajaxmask").on("scroll.ajaxmask",function(){var e=t(this).scrollTop();l.css("top",a.scrollTop()),d.css("top",e+this.clientHeight/2)}),{$bg:l,$pr:d}};t(document).on("bjui.ajaxStart",function(e,a,i){var o=n(t(e.target));o.$bg.fadeIn(),o.$pr.fadeIn(),o.$pr.find(".progress").animate({width:"80%"},a||500),i&&setTimeout(function(){i.toFunc().call(this)},25)}).on("bjui.ajaxStop",function(e){var a=t(e.target),i=n(a);i.$pr.find(".progress").animate({width:"100%"},"fast",function(){i.$bg.remove(),i.$pr.remove(),a.data("bjui.ajax.static")&&a.css("position","static")})}).on("bjui.ajaxError",function(e){var a=t(e.target),i=n(a);i.$bg.remove(),i.$pr.remove(),a.data("bjui.ajax.static")&&a.css("position","static")}),t(document).on(BJUI.eventType.ajaxStatus,function(e){var a=t(e.target),i=n(a);a.one("ajaxStart",function(){i.$bg.fadeIn(),i.$pr.fadeIn(),i.$pr.find(".progress").animate({width:"10%"},"fast")}).one("ajaxStop",function(){}).one("ajaxError",function(){i.$bg.remove(),i.$pr.remove(),a.data("bjui.ajax.static")&&a.css("position","static")})});var o=function(t){t.find('select[data-toggle="selectpicker"]').selectpicker("destroyMenu"),t.find('[data-toggle="selectztree"]').trigger("destroy.bjui.selectztree"),t.find(".bjui-suggest-input").trigger("destroy.bjui.suggest")};t(document).on(BJUI.eventType.beforeLoadDialog,function(t){}).on(BJUI.eventType.beforeAjaxLoad,function(e){o(t(e.target))}).on(BJUI.eventType.beforeCloseNavtab,function(e){o(t(e.target))}).on(BJUI.eventType.beforeCloseDialog,function(e){o(t(e.target))}),t(function(){t(document).on("keydown keyup",function(t){t.which===BJUI.keyCode.CTRL&&(BJUI.KeyPressed.ctrl="keydown"==t.type?!0:!1),t.which===BJUI.keyCode.SHIFT&&(BJUI.KeyPressed.shift="keydown"==t.type?!0:!1)})})}(jQuery),+function(t){"use strict";t(document).on(BJUI.eventType.initUI,function(e){var a=t(e.target);if(t.fn.iCheck){var i=a.find('input[data-toggle="icheck"]');i.each(function(e){var a=t(this),i=a.attr("id"),n=a.attr("name"),o=a.data("label");o&&a.after('<label for="'+i+'" class="ilabel">'+o+"</label>"),a.on("ifCreated",function(e){var a=t(this).closest("div"),o=a.next('[for="'+i+'"]');a.attr("data-icheck",n),o.attr("data-icheck",n)}).iCheck({checkboxClass:"icheckbox_minimal-purple",radioClass:"iradio_minimal-purple",increaseArea:"20%"}).on("ifChanged",function(){t.fn.validator&&t(this).trigger("validate")}),a.prop("disabled")&&a.iCheck("disable")}),i.filter(".checkboxCtrl").on("ifChanged",function(e){var i=1==e.target.checked?"check":"uncheck",n=t(this).data("group");a.find(':checkbox[name="'+n+'"]').iCheck(i)})}if(a.find("button").each(function(){var e=t(this),a=e.data("icon");e.addClass("btn"),a&&!e.find("> i").length&&(a="fa-"+a.replace("fa-",""),e.data("bjui.icon")||e.html('<i class="fa '+a+'"></i> '+e.html()).data("bjui.icon",!0))}),a.find("input:text, input:password").each(function(){var e=t(this).addClass("form-control"),a=e.attr("size")||0,i=10*a;i&&e.css("width",i)}),a.find("textarea").each(function(){var e=t(this).addClass("form-control"),a=e.attr("cols")||0,i=10*a,n=e.attr("data-toggle");i&&e.css("width",i),n&&"autoheight"==n&&t.fn.autosize&&e.addClass("autosize").autosize()}),a.find("a.btn").each(function(){var e=t(this),a=e.data("icon");a&&!e.find("> i").length&&(a="fa-"+a.replace("fa-",""),e.data("bjui.icon")||e.html('<i class="fa '+a+'"></i> '+e.html()).data("bjui.icon",!0))}),t.fn.validator&&a.find('form[data-toggle="validate"]').each(function(){t(this);t(this).validator({valid:function(e){t(e).bjuiajax("_ajaxform",t(e),t(e).data())},validClass:"ok",msgClass:"n-bottom",theme:"red_bottom_effect_grid"}).on("invalid.form",function(e,a,i){t(a).data("alertmsg")&&t(a).alertmsg("error",BJUI.regional.validatemsg.replaceMsg(i.length))})}),a.find('[data-toggle="moresearch"]').each(function(){var e=t(this),a=e.closest(".bjui-pageHeader"),i=a&&a.find(".bjui-moreSearch"),n=e.data("name");e.attr("title")||e.attr("title","更多查询条件"),e.click(function(o){return i.length?(i.css("top",a.outerHeight()-1),i.is(":visible")?(e.html('<i class="fa fa-angle-double-down"></i>'),n&&t("body").data("moresearch."+n,!1)):(e.html('<i class="fa fa-angle-double-up"></i>'),n&&t("body").data("moresearch."+n,!0)),i.fadeToggle("slow","linear"),void o.preventDefault()):void BJUI.debug("Not created 'moresearch' box[class=\"bjui-moreSearch\"]!")}),n&&t("body").data("moresearch."+n)&&(i.css("top",a.outerHeight()-1).fadeIn(),e.html('<i class="fa fa-angle-double-up"></i>'))}),t.fn.selectpicker){var n=a.find('select[data-toggle="selectpicker"]'),o=function(e,a){if(a&&a.length){var i=e.data("refurl"),n=function(e){var a=t(e.data("nextselect"));if(a&&a.length){var i=a.data("emptytxt")||"&nbsp;";a.html("<option>"+i+"</option>").selectpicker("refresh"),n(a)}};if(a&&a.length&&i){var o=e.data("val"),s=a.data("val"),r=e.data("keys");r&&"string"==typeof r&&(r=r.toObj()),r||(r={}),"undefined"==typeof o&&(o=e.val()),t.ajax({type:"POST",dataType:"json",url:i.replace("{value}",encodeURIComponent(o)),cache:!1,data:{},success:function(i){if(i){var o="",l="";t.each(i,function(t){var e,a;i[t]&&i[t].length?(e=i[t][0],a=i[t][1]):(e=i[t][r.value||"value"],a=i[t][r.label||"label"]),"undefined"!=typeof s&&(l=e==s?" selected":""),o+='<option value="'+e+'"'+l+">"+a+"</option>"}),e.removeAttr("data-val").removeData("val"),a.removeAttr("data-val").removeData("val"),o||(o=a.data("emptytxt")||"&nbsp;",o="<option>"+o+"</option>"),a.html(o).selectpicker("refresh"),n(a)}},error:BJUI.ajaxError})}}};n.each(function(){var e=t(this),a=e.data(),i=t(a.nextselect);e.addClass("show-tick"),a.style||e.data("style","btn-default"),a.width||e.data("width","auto"),a.container?1==a.container&&e.attr("data-container","false").data("container",!1):e.data("container","body"),e.selectpicker(),i&&i.length&&"undefined"!=typeof i.data("val")&&o(e,i)}),n.change(function(){var e=t(this),a=t(e.data("nextselect"));o(e,a),e.attr("aria-required")&&t.fn.validator&&e.trigger("validate")})}if(t.fn.zTree){a.find('[data-toggle="ztree"]').each(function(){function e(e,a,i){if(i.faicon){var n=t("#"+i.tId+"_a");n.data("faicon")||n.data("faicon",!0).addClass("faicon").find("> span.button").append('<i class="fa fa-'+i.faicon+'"></i>')}c.onNodeCreated&&c.onNodeCreated.toFunc().call(this,e,a,i)}function a(e,a,i){i.faiconClose&&t("#"+i.tId+"_ico").find("> i").attr("class","fa fa-"+i.faiconClose),c.onCollapse&&c.onCollapse.toFunc().call(this,e,a,i)}function i(e,a,i){i.faicon&&i.faiconClose&&t("#"+i.tId+"_ico").find("> i").attr("class","fa fa-"+i.faicon),c.onExpand&&c.onExpand.toFunc().call(this,e,a,i)}function n(e,a){var i=a.level,n=t("#"+a.tId+h),o=t("#diyBtn_add_"+a.id),s=t("#diyBtn_del_"+a.id);if(o.length||i<c.maxAddLevel&&(o=t('<span class="tree_add" id="diyBtn_add_'+a.id+'" title="添加"></span>'),o.appendTo(n),o.on("click",function(){g.addNodes(a,{name:"新增Item"})})),!s.length){var s=t('<span class="tree_del" id="diyBtn_del_'+a.id+'" title="删除"></span>');s.appendTo(n).on("click",function(t){var i=function(){s.alertmsg("confirm","确认要删除 "+a.name+" 吗？",{okCall:function(){if(g.removeNode(a),c.onRemove){var i=c.onRemove.toFunc();i&&i.call(this,t,e,a)}},cancelCall:function(){}})};if(c.beforeRemove){var n=c.beforeRemove.toFunc();if(n){var o=n.call(n,e,a);o&&1==o&&i()}}else i()})}}function o(e,a){var i=t("#diyBtn_add_"+a.id),n=t("#diyBtn_del_"+a.id);i&&i.length&&i.off("click").remove(),n&&n.length&&n.off("click").remove()}function s(t,e){for(var a=0;a<e.length;a++)if(e[a].drag===!1)return!1;return!0}function r(t,e,a,i){return a?a.drop!==!1:!0}var l,d=t(this),c=d.data(),u=c.options;u&&"string"==typeof u&&(u=u.toObj()),u&&t.extend(c,"object"==typeof u&&u),l=c.setting,c.nodes?("string"==typeof c.nodes&&(c.nodes.trim().startsWith("[")||c.nodes.trim().startsWith("{")?c.nodes=c.nodes.toObj():c.nodes=c.nodes.toFunc()),"function"==typeof c.nodes&&(c.nodes=c.nodes.call(this)),d.removeAttr("data-nodes")):(c.nodes=[],d.find("> li").each(function(){var e=t(this),a=e.data();a.pid&&(a.pId=a.pid),a.name=e.html(),c.nodes.push(a)}),d.empty()),c.showRemoveBtn||(c.showRemoveBtn=!1),c.showRenameBtn||(c.showRenameBtn=!1),c.addHoverDom&&"function"!=typeof c.addHoverDom&&(c.addHoverDom="edit"===c.addHoverDom?n:c.addHoverDom.toFunc()),c.removeHoverDom&&"function"!=typeof c.removeHoverDom&&(c.removeHoverDom="edit"===c.removeHoverDom?o:c.removeHoverDom.toFunc()),c.maxAddLevel||(c.maxAddLevel=2);var p={view:{addHoverDom:c.addHoverDom||null,removeHoverDom:c.removeHoverDom||null,addDiyDom:c.addDiyDom?c.addDiyDom.toFunc():null},edit:{enable:c.editEnable,showRemoveBtn:c.showRemoveBtn,showRenameBtn:c.showRenameBtn},check:{enable:c.checkEnable,chkStyle:c.chkStyle,radioType:c.radioType},callback:{onClick:c.onClick?c.onClick.toFunc():null,beforeDrag:c.beforeDrag?c.beforeDrag.toFunc():s,beforeDrop:c.beforeDrop?c.beforeDrop.toFunc():r,onDrop:c.onDrop?c.onDrop.toFunc():null,onCheck:c.onCheck?c.onCheck.toFunc():null,beforeRemove:c.beforeRemove?c.beforeRemove.toFunc():null,onRemove:c.onRemove?c.onRemove.toFunc():null,onNodeCreated:e,onCollapse:a,onExpand:i},data:{simpleData:{enable:c.simpleData||!0},key:{title:c.title||""}}};l&&"string"==typeof l&&(l=l.toObj()),l&&t.extend(!0,p,"object"==typeof l&&l),t.fn.zTree.init(d,p,c.nodes);var h="_a",g=t.fn.zTree.getZTreeObj(d.attr("id"));c.expandAll&&g.expandAll(!0)});var s=a.find('[data-toggle="selectztree"]');s.each(function(){var e=t(this),a=e.data(),i=t(a.tree),n=(parseFloat(e.css("width")),e.outerHeight());if(a.width=a.width||e.outerWidth(),a.height=a.height||"auto",i&&i.length){var o=i.attr("id"),s=t("#"+o+"_select_box"),r=function(o){var s=e.offset().top,r=e.offset().left,l=i.clone().appendTo(t("body")),d=l.outerHeight();l.remove();var c=t(window).height()-d-s-n,u=t(window).height()-s-n;"auto"==a.height&&0>c&&(u+=c),o.css({top:s+n,left:r,"max-height":u})};e.click(function(){if(s&&s.length)return r(s),void s.show();var n=2,l=t.CurrentDialog;l&&l.length&&(n=l.css("zIndex")+1),s=t('<div id="'+o+'_select_box" class="tree-box"></div>').css({position:"absolute",zIndex:n,"min-width":a.width,height:a.height,overflow:"auto",background:"#FAFAFA",border:"1px #EEE solid"}).hide().appendTo(t("body")),i.appendTo(s).css("width","100%").data("fromObj",e).removeClass("hide").show(),r(s),s.show()}),t("body").on("mousedown",function(a){var i=t(a.target);e[0]==a.target||s&&s.length>0&&i.closest(".tree-box").length>0||s.hide()});var l=e.closest(".bjui-pageContent");l&&l.length&&l.scroll(function(){s&&s.length&&r(s)}),e.on("destroy.bjui.selectztree",function(){s.remove()})}})}if(KindEditor&&a.find('textarea[data-toggle="kindeditor"]').each(function(){var e=t(this).removeClass("form-control"),a=e.data(),i=a.options;i&&"string"==typeof i&&(i=i.toObj()),i&&"object"==typeof i&&(t.extend(a,i),delete a.options),a.items&&"string"==typeof a.items&&(a.items=a.items.replaceAll("'","").replaceAll(" ","").split(",")),a.afterUpload&&(a.afterUpload=a.afterUpload.toFunc()),a.afterSelectFile&&(a.afterSelectFile=a.afterSelectFile.toFunc()),a.confirmSelect&&(a.confirmSelect=a.confirmSelect.toFunc());KindEditor.create(e,{pasteType:a.pasteType,minHeight:a.minHeight||260,autoHeightMode:a.autoHeight||!1,items:a.items||KindEditor.options.items,uploadJson:a.uploadJson,fileManagerJson:a.fileManagerJson,allowFileManager:a.allowFileManager||!0,afterUpload:a.afterUpload,afterSelectFile:a.afterSelectFile,afterBlur:function(){this.sync()}})}),t.fn.colorpicker&&(a.find('[data-toggle="colorpicker"]').each(function(){var e=t(this),a=e.data("bgcolor");e.colorpicker(),a&&e.on("changeColor",function(t){e.css("background-color",t.color.toHex())})}),a.find('[data-toggle="clearcolor"]').each(function(){var e=t(this),a=e.data("target")?t(e.data("target")):null;a&&a.length&&e.click(function(){a.val(""),a.data("bgcolor")&&a.css("background-color","")})})),a.find('[data-toggle="tooltip"]').each(function(){t(this).tooltip()}),a.find('[data-toggle="popover"]').each(function(){var e=t(this),a=e.data("target");a&&t(a).length&&e.attr("data-content",t(a).html()),e.popover()}),WebUploader){var r=function(e,a){var i=e.data("webuploader"),n=e.data("options");if(i&&(i.destroy(),e.data("webuploader.wrap").remove()),n&&("string"==typeof n&&(n=n.trim().toObj()),"object"==typeof n)){e.hide();var o,s=t('<div id="uploader" class="wu-example"><div class="queueList"><div id="dndArea" class="placeholder"><div id="filePicker"></div><p>或将文件拖到这里</p></div></div><div class="statusBar" style="display:none;"><div class="progress"><span class="text">0%</span><span class="percentage"></span></div><div class="info"></div><div class="btns"><div id="filePicker2"></div><div class="uploadBtn">开始上传</div></div></div>'),r=t('<ul class="filelist"></ul>').appendTo(s.find(".queueList")),l=s.find(".statusBar"),d=l.find(".info"),c=s.find(".uploadBtn"),u=s.find(".placeholder"),p=l.find(".progress").hide(),h=0,g=0,f=window.devicePixelRatio||1,m=110*f,b=110*f,v="pedding",y={},x=function(){var t=document.createElement("p").style,e="transition"in t||"WebkitTransition"in t||"MozTransition"in t||"msTransition"in t||"OTransition"in t;return t=null,e}(),k=n.basePath||"",C=n.upunit||"张图片",j=function(i,s,d){if(!i&&n.uploaded)return t.each(n.uploaded.split(","),function(t,e){var a={id:"WU_FILE_UP_"+t,name:e.trim(),src:k+e.trim()};j(a,!0,t),h++}),void(h&&(u.addClass("element-invisible"),l.show(),I("uploaded")));h>=n.fileNumLimit&&l.find("#filePicker2").hide();var c=s&&"张图片"===C?' style="cursor:pointer;" data-toggle="dialog" data-options="{id:\'bjui-dialog-view-upload-image\', image:\''+encodeURIComponent(i.src)+"', width:800, height:500, mask:true, title:'查看已上传图片'}\"":"",p=t('<li class="'+(s?"uploaded":"")+'" id="'+i.id+"_"+a+'"><p class="title">'+i.name+'</p><p class="imgWrap" '+c+'></p><p class="progress"><span></span></p></li>'),g=t('<div class="file-panel"><span class="cancel">删除</span><span class="rotateRight">向右旋转</span><span class="rotateLeft">向左旋转</span></div>').appendTo(p),f=p.find("p.progress span"),v=p.find("p.imgWrap"),T=t('<p class="error"></p>'),B="",D=function(t){switch(t){case"exceed_size":B="文件大小超出";break;case"interrupt":B="上传暂停";break;default:B="上传失败，请重试"}T.text(B).appendTo(p)};if(s){if(v.empty().append('<img src="'+i.src+'">'),n.initUploaded){var U=n.initUploaded.split(",");p.append('<input type="hidden" class="upload" name="'+(n.upname||e.data("name"))+'" value="'+U[d]+'">')}}else"invalid"===i.getStatus()?D(i.statusText):(v.text("预览中"),o.makeThumb(i,function(e,a){if(e)return void v.text("不能预览");var i=t('<img src="'+a+'">');v.empty().append(i)},m,b),y[i.id]=[i.size,0],i.rotation=0),i.on("statuschange",function(t,e){"progress"===e&&f.hide().width(0),"error"===t||"invalid"===t?(D(i.statusText),y[i.id][1]=1):"interrupt"===t?D("interrupt"):"queued"===t?y[i.id][1]=0:"progress"===t?(T.remove(),f.css("display","block")):"complete"===t&&p.append('<span class="success"></span>'),p.removeClass("state-"+e).addClass("state-"+t)});p.on("mouseenter",function(){g.stop().animate({height:30})}),p.on("mouseleave",function(){g.stop().animate({height:0})}),g.on("click","span",function(){var e,a=t(this).index();switch(a){case 0:return void(s?(h--,$(i),h||I("pedding"),o.refresh(),w()):o.removeFile(i));case 1:i.rotation+=90;break;case 2:i.rotation-=90}x?(e="rotate("+i.rotation+"deg)",v.css({"-webkit-transform":e,"-mos-transform":e,"-o-transform":e,transform:e})):v.css("filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+~~(i.rotation/90%4+4)%4+")")}),p.appendTo(r)},$=function(t){var e=s.find("#"+t.id+"_"+a);delete y[t.id],w(),e.off().find(".file-panel").off().end().remove(),h<n.fileNumLimit&&l.find("#filePicker2").show()},w=function(){var e,a=0,i=0,n=p.children();t.each(y,function(t,e){i+=e[0],a+=e[0]*e[1]}),e=i?a/i:0,n.eq(0).text(Math.round(100*e)+"%"),n.eq(1).css("width",Math.round(100*e)+"%"),T()},T=function(){var t,a="";"ready"===v?a="选中"+h+C+"，共"+WebUploader.formatSize(g)+"。":"confirm"===v?(t=o.getStats(),t.uploadFailNum&&(a="已成功上传"+t.successNum+C+"，"+t.uploadFailNum+C+'上传失败，<a class="retry" href="#">重新上传</a> 或 <a class="ignore" href="#">忽略</a>')):"uploaded"===v?a="已上传"+h+C:(t=o.getStats(),a="共"+h+C+"（"+WebUploader.formatSize(g)+"），已上传"+t.successNum,t.uploadFailNum&&(a+="，失败"+t.uploadFailNum)),d.html(a),e.data("fileCount",h)},I=function(t){var e;if(t!==v){switch(c.removeClass("state-"+v),c.addClass("state-"+t),v=t){case"pedding":u.removeClass("element-invisible"),r.parent().removeClass("filled"),r.hide(),l.addClass("element-invisible"),o.refresh();break;case"ready":u.addClass("element-invisible"),s.find("#filePicker2").removeClass("element-invisible"),r.parent().addClass("filled"),r.show(),l.removeClass("element-invisible"),o.refresh(),c.removeClass("disabled");break;case"uploading":s.find("#filePicker2").addClass("element-invisible"),p.show(),c.text("暂停上传");break;case"paused":p.show(),c.text("继续上传");break;case"confirm":if(p.hide(),c.text("开始上传").addClass("disabled"),e=o.getStats(),e.successNum&&!e.uploadFailNum)return void I("finish");break;case"finish":e=o.getStats(),e.successNum||(v="done",BJUI.alertmsg("info","上传失败！"));break;case"uploaded":c.text("开始上传").addClass("disabled")}"uploaded"!==v&&T()}};if(s.insertAfter(e),!WebUploader.Uploader.support())throw alert("Web Uploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器"),new Error("WebUploader does not support the browser you are using.");"undefined"==typeof n.reupload&&(n.reupload=!0),n=t.extend(!0,{},{pick:{id:s.find("#filePicker"),label:"点击选择图片"},dnd:s.find(".queueList"),paste:!1,accept:{title:"Images",extensions:"gif,jpg,jpeg,bmp,png",mimeTypes:"image/*"},swf:BJUI.PLUGINPATH+"webuploader/Uploader.swf",disableGlobalDnd:!1,chunked:!1,server:null,fileNumLimit:300,fileSizeLimit:209715200,fileSingleSizeLimit:52428800},n),o=WebUploader.create(n),"undefined"!=typeof e.data("uploaded")&&(n.uploaded=e.data("uploaded")),n.uploaded&&(j(),r.parent().addClass("filled")),o.on("uploadSuccess",function(t,i){if(i[BJUI.keys.statusCode]!=BJUI.statusCode.ok)BJUI.alertmsg("error",i.message);else{var o=s.find("#"+t.id+"_"+a);o.find("input.upload").remove().end().append('<input type="hidden" class="upload" name="'+(n.upname||e.data("name"))+'" value="'+i.filename+'">')}}),o.on("uploadError",function(t,e){BJUI.alertmsg("error",e.message)}),n.fileNumLimit>1&&(o.addButton({id:s.find("#filePicker2"),label:"继续添加"}),h>=n.fileNumLimit&&l.find("#filePicker2").hide()),o.onUploadProgress=function(t,e){var i=s.find("#"+t.id+"_"+a),n=i.find(".progress span");n.css("width",100*e+"%"),y[t.id][1]=e,w()},o.onFileQueued=function(t){h++,g+=t.size,1===h&&(u.addClass("element-invisible"),l.show()),j(t),I("ready"),w()},o.onFileDequeued=function(t){h--,g-=t.size,h||I("pedding"),$(t),w()},o.on("all",function(t){switch(t){case"uploadFinished":I("confirm");break;case"startUpload":I("uploading");break;case"stopUpload":I("paused")}}),o.onError=function(t){"Q_EXCEED_NUM_LIMIT"===t?BJUI.alertmsg("info","只允许上传"+n.fileNumLimit+C+"！"):"Q_TYPE_DENIED"===t?BJUI.alertmsg("info","不支持的文件类型！"):"F_EXCEED_SIZE"===t?BJUI.alertmsg("info","文件太大了！"):"F_DUPLICATE"===t?BJUI.alertmsg("info","已添加过该文件！"):BJUI.alertmsg("info",t)},c.on("click",function(){return t(this).hasClass("disabled")?!1:void("ready"===v?o.upload():"paused"===v?o.upload():"uploading"===v&&o.stop())}),d.on("click",".retry",function(){o.retry()}),d.on("click",".ignore",function(){alert("todo")}),c.addClass("state-"+v),w(),e.data("webuploader",o).data("webuploader.wrap",s)}};a.find('input[data-toggle="webuploader"]').each(function(e){r(t(this),e),t(this).on("reload.webuploader",function(){r(t(this),e)})})}a.find('[data-toggle="dropdown"]').parent().on("show.bs.dropdown",function(e){var a=t(this),i=a.outerWidth(),n=a.find("> .dropdown-menu"),o=n.outerWidth();i>o&&n.css("min-width",i)});var l=a.find('[data-toggle="highcharts"]');l.each(function(){var e=t(this),a=e.data();t.get(a.url,function(t){e.highcharts(t)},"json")});var d=a.find('[data-toggle="echarts"]');d.each(function(){var e=t(this),a=e.data(),i=a.theme?a.theme:"default",n=a.type.split(",");require.config({paths:{echarts:BJUI.PLUGINPATH+"echarts"}}),require(["echarts","echarts/theme/"+i,"echarts/chart/"+n[0],n[1]?"echarts/chart/"+n[1]:"echarts"],function(i,n){var o=i.init(e[0],n);t.get(a.url,function(t){o.setOption(t)},"json")})})})}(jQuery);
//# sourceMappingURL=bjui-all.min.js.map